// AUTO GENERATED FILE, DO NOT EDIT.
//
// Generated by `package:ffigen`.
// ignore_for_file: type=lint, unused_import
import 'dart:ffi' as ffi;

/// Auto-generated bindings for mlx-c.
class MlxCBindings {
  /// Holds the symbol lookup function.
  final ffi.Pointer<T> Function<T extends ffi.NativeType>(String symbolName)
      _lookup;

  /// The symbols are looked up in [dynamicLibrary].
  MlxCBindings(ffi.DynamicLibrary dynamicLibrary)
      : _lookup = dynamicLibrary.lookup;

  /// The symbols are looked up with [lookup].
  MlxCBindings.fromLookup(
      ffi.Pointer<T> Function<T extends ffi.NativeType>(String symbolName)
          lookup)
      : _lookup = lookup;

  /// Returns a new empty string.
  mlx_string mlx_string_new() {
    return _mlx_string_new();
  }

  late final _mlx_string_newPtr =
      _lookup<ffi.NativeFunction<mlx_string Function()>>('mlx_string_new');
  late final _mlx_string_new =
      _mlx_string_newPtr.asFunction<mlx_string Function()>();

  /// Returns a new string, copying contents from `str`, which must end with `\0`.
  mlx_string mlx_string_new_data(
    ffi.Pointer<ffi.Char> str,
  ) {
    return _mlx_string_new_data(
      str,
    );
  }

  late final _mlx_string_new_dataPtr =
      _lookup<ffi.NativeFunction<mlx_string Function(ffi.Pointer<ffi.Char>)>>(
          'mlx_string_new_data');
  late final _mlx_string_new_data = _mlx_string_new_dataPtr
      .asFunction<mlx_string Function(ffi.Pointer<ffi.Char>)>();

  /// Set string to src string.
  int mlx_string_set(
    ffi.Pointer<mlx_string> str,
    mlx_string src,
  ) {
    return _mlx_string_set(
      str,
      src,
    );
  }

  late final _mlx_string_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_string>, mlx_string)>>('mlx_string_set');
  late final _mlx_string_set = _mlx_string_setPtr
      .asFunction<int Function(ffi.Pointer<mlx_string>, mlx_string)>();

  /// Returns a pointer to the string contents.
  /// The pointer is valid for the life duration of the string.
  ffi.Pointer<ffi.Char> mlx_string_data(
    mlx_string str,
  ) {
    return _mlx_string_data(
      str,
    );
  }

  late final _mlx_string_dataPtr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Char> Function(mlx_string)>>(
          'mlx_string_data');
  late final _mlx_string_data = _mlx_string_dataPtr
      .asFunction<ffi.Pointer<ffi.Char> Function(mlx_string)>();

  /// Free string.
  int mlx_string_free(
    mlx_string str,
  ) {
    return _mlx_string_free(
      str,
    );
  }

  late final _mlx_string_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_string)>>(
          'mlx_string_free');
  late final _mlx_string_free =
      _mlx_string_freePtr.asFunction<int Function(mlx_string)>();

  late final ffi.Pointer<mlx_array> _mlx_array_empty =
      _lookup<mlx_array>('mlx_array_empty');

  mlx_array get mlx_array_empty => _mlx_array_empty.ref;

  /// Size of given mlx_dtype datatype in bytes.
  int mlx_dtype_size(
    mlx_dtype_ dtype,
  ) {
    return _mlx_dtype_size(
      dtype.value,
    );
  }

  late final _mlx_dtype_sizePtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(ffi.UnsignedInt)>>(
          'mlx_dtype_size');
  late final _mlx_dtype_size =
      _mlx_dtype_sizePtr.asFunction<int Function(int)>();

  /// Get array description.
  int mlx_array_tostring(
    ffi.Pointer<mlx_string> str,
    mlx_array arr,
  ) {
    return _mlx_array_tostring(
      str,
      arr,
    );
  }

  late final _mlx_array_tostringPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_string>, mlx_array)>>('mlx_array_tostring');
  late final _mlx_array_tostring = _mlx_array_tostringPtr
      .asFunction<int Function(ffi.Pointer<mlx_string>, mlx_array)>();

  /// New empty array.
  mlx_array mlx_array_new() {
    return _mlx_array_new();
  }

  late final _mlx_array_newPtr =
      _lookup<ffi.NativeFunction<mlx_array Function()>>('mlx_array_new');
  late final _mlx_array_new =
      _mlx_array_newPtr.asFunction<mlx_array Function()>();

  /// Free an array.
  int mlx_array_free(
    mlx_array arr,
  ) {
    return _mlx_array_free(
      arr,
    );
  }

  late final _mlx_array_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_array)>>(
          'mlx_array_free');
  late final _mlx_array_free =
      _mlx_array_freePtr.asFunction<int Function(mlx_array)>();

  /// New array from a bool scalar.
  mlx_array mlx_array_new_bool(
    bool val,
  ) {
    return _mlx_array_new_bool(
      val,
    );
  }

  late final _mlx_array_new_boolPtr =
      _lookup<ffi.NativeFunction<mlx_array Function(ffi.Bool)>>(
          'mlx_array_new_bool');
  late final _mlx_array_new_bool =
      _mlx_array_new_boolPtr.asFunction<mlx_array Function(bool)>();

  /// New array from a int scalar.
  mlx_array mlx_array_new_int(
    int val,
  ) {
    return _mlx_array_new_int(
      val,
    );
  }

  late final _mlx_array_new_intPtr =
      _lookup<ffi.NativeFunction<mlx_array Function(ffi.Int)>>(
          'mlx_array_new_int');
  late final _mlx_array_new_int =
      _mlx_array_new_intPtr.asFunction<mlx_array Function(int)>();

  /// New array from a float32 scalar.
  mlx_array mlx_array_new_float32(
    double val,
  ) {
    return _mlx_array_new_float32(
      val,
    );
  }

  late final _mlx_array_new_float32Ptr =
      _lookup<ffi.NativeFunction<mlx_array Function(ffi.Float)>>(
          'mlx_array_new_float32');
  late final _mlx_array_new_float32 =
      _mlx_array_new_float32Ptr.asFunction<mlx_array Function(double)>();

  /// New array from a float scalar.
  /// Same as float32.
  mlx_array mlx_array_new_float(
    double val,
  ) {
    return _mlx_array_new_float(
      val,
    );
  }

  late final _mlx_array_new_floatPtr =
      _lookup<ffi.NativeFunction<mlx_array Function(ffi.Float)>>(
          'mlx_array_new_float');
  late final _mlx_array_new_float =
      _mlx_array_new_floatPtr.asFunction<mlx_array Function(double)>();

  /// New array from a float64 scalar.
  mlx_array mlx_array_new_float64(
    double val,
  ) {
    return _mlx_array_new_float64(
      val,
    );
  }

  late final _mlx_array_new_float64Ptr =
      _lookup<ffi.NativeFunction<mlx_array Function(ffi.Double)>>(
          'mlx_array_new_float64');
  late final _mlx_array_new_float64 =
      _mlx_array_new_float64Ptr.asFunction<mlx_array Function(double)>();

  /// New array from a double scalar.
  /// Same as float64.
  mlx_array mlx_array_new_double(
    double val,
  ) {
    return _mlx_array_new_double(
      val,
    );
  }

  late final _mlx_array_new_doublePtr =
      _lookup<ffi.NativeFunction<mlx_array Function(ffi.Double)>>(
          'mlx_array_new_double');
  late final _mlx_array_new_double =
      _mlx_array_new_doublePtr.asFunction<mlx_array Function(double)>();

  /// New array from a complex scalar.
  mlx_array mlx_array_new_complex(
    double real_val,
    double imag_val,
  ) {
    return _mlx_array_new_complex(
      real_val,
      imag_val,
    );
  }

  late final _mlx_array_new_complexPtr =
      _lookup<ffi.NativeFunction<mlx_array Function(ffi.Float, ffi.Float)>>(
          'mlx_array_new_complex');
  late final _mlx_array_new_complex = _mlx_array_new_complexPtr
      .asFunction<mlx_array Function(double, double)>();

  /// New array from existing buffer.
  /// @param data A buffer which will be copied.
  /// @param shape Shape of the array.
  /// @param dim Number of dimensions (size of `shape`).
  /// @param dtype Type of array elements.
  mlx_array mlx_array_new_data(
    ffi.Pointer<ffi.Void> data,
    ffi.Pointer<ffi.Int> shape,
    int dim,
    mlx_dtype_ dtype,
  ) {
    return _mlx_array_new_data(
      data,
      shape,
      dim,
      dtype.value,
    );
  }

  late final _mlx_array_new_dataPtr = _lookup<
      ffi.NativeFunction<
          mlx_array Function(ffi.Pointer<ffi.Void>, ffi.Pointer<ffi.Int>,
              ffi.Int, ffi.UnsignedInt)>>('mlx_array_new_data');
  late final _mlx_array_new_data = _mlx_array_new_dataPtr.asFunction<
      mlx_array Function(
          ffi.Pointer<ffi.Void>, ffi.Pointer<ffi.Int>, int, int)>();

  /// New array from existing buffer.
  /// @param data A buffer which will be copied.
  /// @param shape Shape of the array.
  /// @param dim Number of dimensions (size of `shape`).
  /// @param dtype Type of array elements.
  /// @param dtor Callback for when the buffer is no longer needed.
  mlx_array mlx_array_new_data_managed(
    ffi.Pointer<ffi.Void> data,
    ffi.Pointer<ffi.Int> shape,
    int dim,
    mlx_dtype_ dtype,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_array_new_data_managed(
      data,
      shape,
      dim,
      dtype.value,
      dtor,
    );
  }

  late final _mlx_array_new_data_managedPtr = _lookup<
          ffi.NativeFunction<
              mlx_array Function(
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<ffi.Int>,
                  ffi.Int,
                  ffi.UnsignedInt,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_array_new_data_managed');
  late final _mlx_array_new_data_managed =
      _mlx_array_new_data_managedPtr.asFunction<
          mlx_array Function(
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<ffi.Int>,
              int,
              int,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  /// New array from existing buffer.
  /// @param data A buffer which will be copied.
  /// @param shape Shape of the array.
  /// @param dim Number of dimensions (size of `shape`).
  /// @param dtype Type of array elements.
  /// @param payload Payload pointer passed to the `dtor` callback instead of
  /// `data`.
  /// @param dtor Callback for when the buffer is no longer needed.
  mlx_array mlx_array_new_data_managed_payload(
    ffi.Pointer<ffi.Void> data,
    ffi.Pointer<ffi.Int> shape,
    int dim,
    mlx_dtype_ dtype,
    ffi.Pointer<ffi.Void> payload,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_array_new_data_managed_payload(
      data,
      shape,
      dim,
      dtype.value,
      payload,
      dtor,
    );
  }

  late final _mlx_array_new_data_managed_payloadPtr = _lookup<
          ffi.NativeFunction<
              mlx_array Function(
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<ffi.Int>,
                  ffi.Int,
                  ffi.UnsignedInt,
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_array_new_data_managed_payload');
  late final _mlx_array_new_data_managed_payload =
      _mlx_array_new_data_managed_payloadPtr.asFunction<
          mlx_array Function(
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<ffi.Int>,
              int,
              int,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  /// Set array to provided src array.
  int mlx_array_set(
    ffi.Pointer<mlx_array> arr,
    mlx_array src,
  ) {
    return _mlx_array_set(
      arr,
      src,
    );
  }

  late final _mlx_array_setPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array)>>(
      'mlx_array_set');
  late final _mlx_array_set = _mlx_array_setPtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, mlx_array)>();

  /// Set array to a bool scalar.
  int mlx_array_set_bool(
    ffi.Pointer<mlx_array> arr,
    bool val,
  ) {
    return _mlx_array_set_bool(
      arr,
      val,
    );
  }

  late final _mlx_array_set_boolPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Bool)>>(
      'mlx_array_set_bool');
  late final _mlx_array_set_bool = _mlx_array_set_boolPtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, bool)>();

  /// Set array to a int scalar.
  int mlx_array_set_int(
    ffi.Pointer<mlx_array> arr,
    int val,
  ) {
    return _mlx_array_set_int(
      arr,
      val,
    );
  }

  late final _mlx_array_set_intPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Int)>>(
      'mlx_array_set_int');
  late final _mlx_array_set_int = _mlx_array_set_intPtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, int)>();

  /// Set array to a float32 scalar.
  int mlx_array_set_float32(
    ffi.Pointer<mlx_array> arr,
    double val,
  ) {
    return _mlx_array_set_float32(
      arr,
      val,
    );
  }

  late final _mlx_array_set_float32Ptr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Float)>>(
      'mlx_array_set_float32');
  late final _mlx_array_set_float32 = _mlx_array_set_float32Ptr
      .asFunction<int Function(ffi.Pointer<mlx_array>, double)>();

  /// Set array to a float scalar.
  int mlx_array_set_float(
    ffi.Pointer<mlx_array> arr,
    double val,
  ) {
    return _mlx_array_set_float(
      arr,
      val,
    );
  }

  late final _mlx_array_set_floatPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Float)>>(
      'mlx_array_set_float');
  late final _mlx_array_set_float = _mlx_array_set_floatPtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, double)>();

  /// Set array to a float64 scalar.
  int mlx_array_set_float64(
    ffi.Pointer<mlx_array> arr,
    double val,
  ) {
    return _mlx_array_set_float64(
      arr,
      val,
    );
  }

  late final _mlx_array_set_float64Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, ffi.Double)>>('mlx_array_set_float64');
  late final _mlx_array_set_float64 = _mlx_array_set_float64Ptr
      .asFunction<int Function(ffi.Pointer<mlx_array>, double)>();

  /// Set array to a double scalar.
  int mlx_array_set_double(
    ffi.Pointer<mlx_array> arr,
    double val,
  ) {
    return _mlx_array_set_double(
      arr,
      val,
    );
  }

  late final _mlx_array_set_doublePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, ffi.Double)>>('mlx_array_set_double');
  late final _mlx_array_set_double = _mlx_array_set_doublePtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, double)>();

  /// Set array to a complex scalar.
  int mlx_array_set_complex(
    ffi.Pointer<mlx_array> arr,
    double real_val,
    double imag_val,
  ) {
    return _mlx_array_set_complex(
      arr,
      real_val,
      imag_val,
    );
  }

  late final _mlx_array_set_complexPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Float,
              ffi.Float)>>('mlx_array_set_complex');
  late final _mlx_array_set_complex = _mlx_array_set_complexPtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, double, double)>();

  /// Set array to specified data and shape.
  /// @param arr Destination array.
  /// @param data A buffer which will be copied.
  /// @param shape Shape of the array.
  /// @param dim Number of dimensions (size of `shape`).
  /// @param dtype Type of array elements.
  int mlx_array_set_data(
    ffi.Pointer<mlx_array> arr,
    ffi.Pointer<ffi.Void> data,
    ffi.Pointer<ffi.Int> shape,
    int dim,
    mlx_dtype_ dtype,
  ) {
    return _mlx_array_set_data(
      arr,
      data,
      shape,
      dim,
      dtype.value,
    );
  }

  late final _mlx_array_set_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<ffi.Int>,
              ffi.Int,
              ffi.UnsignedInt)>>('mlx_array_set_data');
  late final _mlx_array_set_data = _mlx_array_set_dataPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Int>, int, int)>();

  /// The size of the array's datatype in bytes.
  int mlx_array_itemsize(
    mlx_array arr,
  ) {
    return _mlx_array_itemsize(
      arr,
    );
  }

  late final _mlx_array_itemsizePtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_array)>>(
          'mlx_array_itemsize');
  late final _mlx_array_itemsize =
      _mlx_array_itemsizePtr.asFunction<int Function(mlx_array)>();

  /// Number of elements in the array.
  int mlx_array_size(
    mlx_array arr,
  ) {
    return _mlx_array_size(
      arr,
    );
  }

  late final _mlx_array_sizePtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_array)>>(
          'mlx_array_size');
  late final _mlx_array_size =
      _mlx_array_sizePtr.asFunction<int Function(mlx_array)>();

  /// The number of bytes in the array.
  int mlx_array_nbytes(
    mlx_array arr,
  ) {
    return _mlx_array_nbytes(
      arr,
    );
  }

  late final _mlx_array_nbytesPtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_array)>>(
          'mlx_array_nbytes');
  late final _mlx_array_nbytes =
      _mlx_array_nbytesPtr.asFunction<int Function(mlx_array)>();

  /// The array's dimension.
  int mlx_array_ndim(
    mlx_array arr,
  ) {
    return _mlx_array_ndim(
      arr,
    );
  }

  late final _mlx_array_ndimPtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_array)>>(
          'mlx_array_ndim');
  late final _mlx_array_ndim =
      _mlx_array_ndimPtr.asFunction<int Function(mlx_array)>();

  /// The shape of the array.
  /// Returns: a pointer to the sizes of each dimension.
  ffi.Pointer<ffi.Int> mlx_array_shape(
    mlx_array arr,
  ) {
    return _mlx_array_shape(
      arr,
    );
  }

  late final _mlx_array_shapePtr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Int> Function(mlx_array)>>(
          'mlx_array_shape');
  late final _mlx_array_shape = _mlx_array_shapePtr
      .asFunction<ffi.Pointer<ffi.Int> Function(mlx_array)>();

  /// The strides of the array.
  /// Returns: a pointer to the sizes of each dimension.
  ffi.Pointer<ffi.Size> mlx_array_strides(
    mlx_array arr,
  ) {
    return _mlx_array_strides(
      arr,
    );
  }

  late final _mlx_array_stridesPtr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Size> Function(mlx_array)>>(
          'mlx_array_strides');
  late final _mlx_array_strides = _mlx_array_stridesPtr
      .asFunction<ffi.Pointer<ffi.Size> Function(mlx_array)>();

  /// The shape of the array in a particular dimension.
  int mlx_array_dim(
    mlx_array arr,
    int dim,
  ) {
    return _mlx_array_dim(
      arr,
      dim,
    );
  }

  late final _mlx_array_dimPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_array, ffi.Int)>>(
          'mlx_array_dim');
  late final _mlx_array_dim =
      _mlx_array_dimPtr.asFunction<int Function(mlx_array, int)>();

  /// The array element type.
  mlx_dtype_ mlx_array_dtype(
    mlx_array arr,
  ) {
    return mlx_dtype_.fromValue(_mlx_array_dtype(
      arr,
    ));
  }

  late final _mlx_array_dtypePtr =
      _lookup<ffi.NativeFunction<ffi.UnsignedInt Function(mlx_array)>>(
          'mlx_array_dtype');
  late final _mlx_array_dtype =
      _mlx_array_dtypePtr.asFunction<int Function(mlx_array)>();

  /// Evaluate the array.
  int mlx_array_eval(
    mlx_array arr,
  ) {
    return _mlx_array_eval(
      arr,
    );
  }

  late final _mlx_array_evalPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_array)>>(
          'mlx_array_eval');
  late final _mlx_array_eval =
      _mlx_array_evalPtr.asFunction<int Function(mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_bool(
    ffi.Pointer<ffi.Bool> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_bool(
      res,
      arr,
    );
  }

  late final _mlx_array_item_boolPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Bool>, mlx_array)>>(
      'mlx_array_item_bool');
  late final _mlx_array_item_bool = _mlx_array_item_boolPtr
      .asFunction<int Function(ffi.Pointer<ffi.Bool>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_uint8(
    ffi.Pointer<ffi.Uint8> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_uint8(
      res,
      arr,
    );
  }

  late final _mlx_array_item_uint8Ptr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Uint8>, mlx_array)>>(
      'mlx_array_item_uint8');
  late final _mlx_array_item_uint8 = _mlx_array_item_uint8Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Uint8>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_uint16(
    ffi.Pointer<ffi.Uint16> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_uint16(
      res,
      arr,
    );
  }

  late final _mlx_array_item_uint16Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Uint16>, mlx_array)>>('mlx_array_item_uint16');
  late final _mlx_array_item_uint16 = _mlx_array_item_uint16Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Uint16>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_uint32(
    ffi.Pointer<ffi.Uint32> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_uint32(
      res,
      arr,
    );
  }

  late final _mlx_array_item_uint32Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Uint32>, mlx_array)>>('mlx_array_item_uint32');
  late final _mlx_array_item_uint32 = _mlx_array_item_uint32Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Uint32>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_uint64(
    ffi.Pointer<ffi.Uint64> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_uint64(
      res,
      arr,
    );
  }

  late final _mlx_array_item_uint64Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Uint64>, mlx_array)>>('mlx_array_item_uint64');
  late final _mlx_array_item_uint64 = _mlx_array_item_uint64Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Uint64>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_int8(
    ffi.Pointer<ffi.Int8> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_int8(
      res,
      arr,
    );
  }

  late final _mlx_array_item_int8Ptr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Int8>, mlx_array)>>(
      'mlx_array_item_int8');
  late final _mlx_array_item_int8 = _mlx_array_item_int8Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Int8>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_int16(
    ffi.Pointer<ffi.Int16> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_int16(
      res,
      arr,
    );
  }

  late final _mlx_array_item_int16Ptr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Int16>, mlx_array)>>(
      'mlx_array_item_int16');
  late final _mlx_array_item_int16 = _mlx_array_item_int16Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Int16>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_int32(
    ffi.Pointer<ffi.Int32> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_int32(
      res,
      arr,
    );
  }

  late final _mlx_array_item_int32Ptr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Int32>, mlx_array)>>(
      'mlx_array_item_int32');
  late final _mlx_array_item_int32 = _mlx_array_item_int32Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Int32>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_int64(
    ffi.Pointer<ffi.Int64> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_int64(
      res,
      arr,
    );
  }

  late final _mlx_array_item_int64Ptr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Int64>, mlx_array)>>(
      'mlx_array_item_int64');
  late final _mlx_array_item_int64 = _mlx_array_item_int64Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Int64>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_float32(
    ffi.Pointer<ffi.Float> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_float32(
      res,
      arr,
    );
  }

  late final _mlx_array_item_float32Ptr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Float>, mlx_array)>>(
      'mlx_array_item_float32');
  late final _mlx_array_item_float32 = _mlx_array_item_float32Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Float>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_float64(
    ffi.Pointer<ffi.Double> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_float64(
      res,
      arr,
    );
  }

  late final _mlx_array_item_float64Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Double>, mlx_array)>>('mlx_array_item_float64');
  late final _mlx_array_item_float64 = _mlx_array_item_float64Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Double>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_complex64(
    ffi.Pointer<mlx_complex64_t> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_complex64(
      res,
      arr,
    );
  }

  late final _mlx_array_item_complex64Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_complex64_t>,
              mlx_array)>>('mlx_array_item_complex64');
  late final _mlx_array_item_complex64 = _mlx_array_item_complex64Ptr
      .asFunction<int Function(ffi.Pointer<mlx_complex64_t>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_float16(
    ffi.Pointer<ffi.Uint16> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_float16(
      res,
      arr,
    );
  }

  late final _mlx_array_item_float16Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Uint16>, mlx_array)>>('mlx_array_item_float16');
  late final _mlx_array_item_float16 = _mlx_array_item_float16Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Uint16>, mlx_array)>();

  /// Access the value of a scalar array.
  int mlx_array_item_bfloat16(
    ffi.Pointer<ffi.Uint16> res,
    mlx_array arr,
  ) {
    return _mlx_array_item_bfloat16(
      res,
      arr,
    );
  }

  late final _mlx_array_item_bfloat16Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Uint16>, mlx_array)>>('mlx_array_item_bfloat16');
  late final _mlx_array_item_bfloat16 = _mlx_array_item_bfloat16Ptr
      .asFunction<int Function(ffi.Pointer<ffi.Uint16>, mlx_array)>();

  /// Returns a pointer to the array data, cast to `bool*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Bool> mlx_array_data_bool(
    mlx_array arr,
  ) {
    return _mlx_array_data_bool(
      arr,
    );
  }

  late final _mlx_array_data_boolPtr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Bool> Function(mlx_array)>>(
          'mlx_array_data_bool');
  late final _mlx_array_data_bool = _mlx_array_data_boolPtr
      .asFunction<ffi.Pointer<ffi.Bool> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `uint8_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Uint8> mlx_array_data_uint8(
    mlx_array arr,
  ) {
    return _mlx_array_data_uint8(
      arr,
    );
  }

  late final _mlx_array_data_uint8Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Uint8> Function(mlx_array)>>(
          'mlx_array_data_uint8');
  late final _mlx_array_data_uint8 = _mlx_array_data_uint8Ptr
      .asFunction<ffi.Pointer<ffi.Uint8> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `uint16_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Uint16> mlx_array_data_uint16(
    mlx_array arr,
  ) {
    return _mlx_array_data_uint16(
      arr,
    );
  }

  late final _mlx_array_data_uint16Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Uint16> Function(mlx_array)>>(
          'mlx_array_data_uint16');
  late final _mlx_array_data_uint16 = _mlx_array_data_uint16Ptr
      .asFunction<ffi.Pointer<ffi.Uint16> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `uint32_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Uint32> mlx_array_data_uint32(
    mlx_array arr,
  ) {
    return _mlx_array_data_uint32(
      arr,
    );
  }

  late final _mlx_array_data_uint32Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Uint32> Function(mlx_array)>>(
          'mlx_array_data_uint32');
  late final _mlx_array_data_uint32 = _mlx_array_data_uint32Ptr
      .asFunction<ffi.Pointer<ffi.Uint32> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `uint64_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Uint64> mlx_array_data_uint64(
    mlx_array arr,
  ) {
    return _mlx_array_data_uint64(
      arr,
    );
  }

  late final _mlx_array_data_uint64Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Uint64> Function(mlx_array)>>(
          'mlx_array_data_uint64');
  late final _mlx_array_data_uint64 = _mlx_array_data_uint64Ptr
      .asFunction<ffi.Pointer<ffi.Uint64> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `int8_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Int8> mlx_array_data_int8(
    mlx_array arr,
  ) {
    return _mlx_array_data_int8(
      arr,
    );
  }

  late final _mlx_array_data_int8Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Int8> Function(mlx_array)>>(
          'mlx_array_data_int8');
  late final _mlx_array_data_int8 = _mlx_array_data_int8Ptr
      .asFunction<ffi.Pointer<ffi.Int8> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `int16_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Int16> mlx_array_data_int16(
    mlx_array arr,
  ) {
    return _mlx_array_data_int16(
      arr,
    );
  }

  late final _mlx_array_data_int16Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Int16> Function(mlx_array)>>(
          'mlx_array_data_int16');
  late final _mlx_array_data_int16 = _mlx_array_data_int16Ptr
      .asFunction<ffi.Pointer<ffi.Int16> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `int32_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Int32> mlx_array_data_int32(
    mlx_array arr,
  ) {
    return _mlx_array_data_int32(
      arr,
    );
  }

  late final _mlx_array_data_int32Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Int32> Function(mlx_array)>>(
          'mlx_array_data_int32');
  late final _mlx_array_data_int32 = _mlx_array_data_int32Ptr
      .asFunction<ffi.Pointer<ffi.Int32> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `int64_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Int64> mlx_array_data_int64(
    mlx_array arr,
  ) {
    return _mlx_array_data_int64(
      arr,
    );
  }

  late final _mlx_array_data_int64Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Int64> Function(mlx_array)>>(
          'mlx_array_data_int64');
  late final _mlx_array_data_int64 = _mlx_array_data_int64Ptr
      .asFunction<ffi.Pointer<ffi.Int64> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `float32*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Float> mlx_array_data_float32(
    mlx_array arr,
  ) {
    return _mlx_array_data_float32(
      arr,
    );
  }

  late final _mlx_array_data_float32Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Float> Function(mlx_array)>>(
          'mlx_array_data_float32');
  late final _mlx_array_data_float32 = _mlx_array_data_float32Ptr
      .asFunction<ffi.Pointer<ffi.Float> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `float64*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Double> mlx_array_data_float64(
    mlx_array arr,
  ) {
    return _mlx_array_data_float64(
      arr,
    );
  }

  late final _mlx_array_data_float64Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Double> Function(mlx_array)>>(
          'mlx_array_data_float64');
  late final _mlx_array_data_float64 = _mlx_array_data_float64Ptr
      .asFunction<ffi.Pointer<ffi.Double> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `_Complex*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<mlx_complex64_t> mlx_array_data_complex64(
    mlx_array arr,
  ) {
    return _mlx_array_data_complex64(
      arr,
    );
  }

  late final _mlx_array_data_complex64Ptr = _lookup<
          ffi.NativeFunction<ffi.Pointer<mlx_complex64_t> Function(mlx_array)>>(
      'mlx_array_data_complex64');
  late final _mlx_array_data_complex64 = _mlx_array_data_complex64Ptr
      .asFunction<ffi.Pointer<mlx_complex64_t> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `float16_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Uint16> mlx_array_data_float16(
    mlx_array arr,
  ) {
    return _mlx_array_data_float16(
      arr,
    );
  }

  late final _mlx_array_data_float16Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Uint16> Function(mlx_array)>>(
          'mlx_array_data_float16');
  late final _mlx_array_data_float16 = _mlx_array_data_float16Ptr
      .asFunction<ffi.Pointer<ffi.Uint16> Function(mlx_array)>();

  /// Returns a pointer to the array data, cast to `bfloat16_t*`.
  /// Array must be evaluated, otherwise returns NULL.
  ffi.Pointer<ffi.Uint16> mlx_array_data_bfloat16(
    mlx_array arr,
  ) {
    return _mlx_array_data_bfloat16(
      arr,
    );
  }

  late final _mlx_array_data_bfloat16Ptr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Uint16> Function(mlx_array)>>(
          'mlx_array_data_bfloat16');
  late final _mlx_array_data_bfloat16 = _mlx_array_data_bfloat16Ptr
      .asFunction<ffi.Pointer<ffi.Uint16> Function(mlx_array)>();

  /// Returns a new empty string-to-array map.
  mlx_map_string_to_array mlx_map_string_to_array_new() {
    return _mlx_map_string_to_array_new();
  }

  late final _mlx_map_string_to_array_newPtr =
      _lookup<ffi.NativeFunction<mlx_map_string_to_array Function()>>(
          'mlx_map_string_to_array_new');
  late final _mlx_map_string_to_array_new = _mlx_map_string_to_array_newPtr
      .asFunction<mlx_map_string_to_array Function()>();

  /// Set map to provided src map.
  int mlx_map_string_to_array_set(
    ffi.Pointer<mlx_map_string_to_array> map,
    mlx_map_string_to_array src,
  ) {
    return _mlx_map_string_to_array_set(
      map,
      src,
    );
  }

  late final _mlx_map_string_to_array_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_map_string_to_array>,
              mlx_map_string_to_array)>>('mlx_map_string_to_array_set');
  late final _mlx_map_string_to_array_set =
      _mlx_map_string_to_array_setPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_map_string_to_array>, mlx_map_string_to_array)>();

  /// Free a string-to-array map.
  int mlx_map_string_to_array_free(
    mlx_map_string_to_array map,
  ) {
    return _mlx_map_string_to_array_free(
      map,
    );
  }

  late final _mlx_map_string_to_array_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_map_string_to_array)>>(
          'mlx_map_string_to_array_free');
  late final _mlx_map_string_to_array_free = _mlx_map_string_to_array_freePtr
      .asFunction<int Function(mlx_map_string_to_array)>();

  /// Insert a new `value` at the specified `key` in the map.
  int mlx_map_string_to_array_insert(
    mlx_map_string_to_array map,
    ffi.Pointer<ffi.Char> key,
    mlx_array value,
  ) {
    return _mlx_map_string_to_array_insert(
      map,
      key,
      value,
    );
  }

  late final _mlx_map_string_to_array_insertPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_map_string_to_array, ffi.Pointer<ffi.Char>,
              mlx_array)>>('mlx_map_string_to_array_insert');
  late final _mlx_map_string_to_array_insert =
      _mlx_map_string_to_array_insertPtr.asFunction<
          int Function(
              mlx_map_string_to_array, ffi.Pointer<ffi.Char>, mlx_array)>();

  /// Returns the value indexed at the specified `key` in the map.
  int mlx_map_string_to_array_get(
    ffi.Pointer<mlx_array> value,
    mlx_map_string_to_array map,
    ffi.Pointer<ffi.Char> key,
  ) {
    return _mlx_map_string_to_array_get(
      value,
      map,
      key,
    );
  }

  late final _mlx_map_string_to_array_getPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_map_string_to_array,
              ffi.Pointer<ffi.Char>)>>('mlx_map_string_to_array_get');
  late final _mlx_map_string_to_array_get =
      _mlx_map_string_to_array_getPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_map_string_to_array,
              ffi.Pointer<ffi.Char>)>();

  /// Returns a new iterator over the given map.
  mlx_map_string_to_array_iterator mlx_map_string_to_array_iterator_new(
    mlx_map_string_to_array map,
  ) {
    return _mlx_map_string_to_array_iterator_new(
      map,
    );
  }

  late final _mlx_map_string_to_array_iterator_newPtr = _lookup<
          ffi.NativeFunction<
              mlx_map_string_to_array_iterator Function(
                  mlx_map_string_to_array)>>(
      'mlx_map_string_to_array_iterator_new');
  late final _mlx_map_string_to_array_iterator_new =
      _mlx_map_string_to_array_iterator_newPtr.asFunction<
          mlx_map_string_to_array_iterator Function(mlx_map_string_to_array)>();

  /// Free iterator.
  int mlx_map_string_to_array_iterator_free(
    mlx_map_string_to_array_iterator it,
  ) {
    return _mlx_map_string_to_array_iterator_free(
      it,
    );
  }

  late final _mlx_map_string_to_array_iterator_freePtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(mlx_map_string_to_array_iterator)>>(
      'mlx_map_string_to_array_iterator_free');
  late final _mlx_map_string_to_array_iterator_free =
      _mlx_map_string_to_array_iterator_freePtr
          .asFunction<int Function(mlx_map_string_to_array_iterator)>();

  /// Increment iterator.
  int mlx_map_string_to_array_iterator_next(
    ffi.Pointer<ffi.Pointer<ffi.Char>> key,
    ffi.Pointer<mlx_array> value,
    mlx_map_string_to_array_iterator it,
  ) {
    return _mlx_map_string_to_array_iterator_next(
      key,
      value,
      it,
    );
  }

  late final _mlx_map_string_to_array_iterator_nextPtr = _lookup<
          ffi.NativeFunction<
              ffi.Int Function(ffi.Pointer<ffi.Pointer<ffi.Char>>,
                  ffi.Pointer<mlx_array>, mlx_map_string_to_array_iterator)>>(
      'mlx_map_string_to_array_iterator_next');
  late final _mlx_map_string_to_array_iterator_next =
      _mlx_map_string_to_array_iterator_nextPtr.asFunction<
          int Function(ffi.Pointer<ffi.Pointer<ffi.Char>>,
              ffi.Pointer<mlx_array>, mlx_map_string_to_array_iterator)>();

  /// Returns a new empty string-to-string map.
  mlx_map_string_to_string mlx_map_string_to_string_new() {
    return _mlx_map_string_to_string_new();
  }

  late final _mlx_map_string_to_string_newPtr =
      _lookup<ffi.NativeFunction<mlx_map_string_to_string Function()>>(
          'mlx_map_string_to_string_new');
  late final _mlx_map_string_to_string_new = _mlx_map_string_to_string_newPtr
      .asFunction<mlx_map_string_to_string Function()>();

  /// Set map to provided src map.
  int mlx_map_string_to_string_set(
    ffi.Pointer<mlx_map_string_to_string> map,
    mlx_map_string_to_string src,
  ) {
    return _mlx_map_string_to_string_set(
      map,
      src,
    );
  }

  late final _mlx_map_string_to_string_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_map_string_to_string>,
              mlx_map_string_to_string)>>('mlx_map_string_to_string_set');
  late final _mlx_map_string_to_string_set =
      _mlx_map_string_to_string_setPtr.asFunction<
          int Function(ffi.Pointer<mlx_map_string_to_string>,
              mlx_map_string_to_string)>();

  /// Free a string-to-string map.
  int mlx_map_string_to_string_free(
    mlx_map_string_to_string map,
  ) {
    return _mlx_map_string_to_string_free(
      map,
    );
  }

  late final _mlx_map_string_to_string_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_map_string_to_string)>>(
          'mlx_map_string_to_string_free');
  late final _mlx_map_string_to_string_free = _mlx_map_string_to_string_freePtr
      .asFunction<int Function(mlx_map_string_to_string)>();

  /// Insert a new `value` at the specified `key` in the map.
  int mlx_map_string_to_string_insert(
    mlx_map_string_to_string map,
    ffi.Pointer<ffi.Char> key,
    ffi.Pointer<ffi.Char> value,
  ) {
    return _mlx_map_string_to_string_insert(
      map,
      key,
      value,
    );
  }

  late final _mlx_map_string_to_string_insertPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_map_string_to_string, ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>)>>('mlx_map_string_to_string_insert');
  late final _mlx_map_string_to_string_insert =
      _mlx_map_string_to_string_insertPtr.asFunction<
          int Function(mlx_map_string_to_string, ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>)>();

  /// Returns the value indexed at the specified `key` in the map.
  int mlx_map_string_to_string_get(
    ffi.Pointer<ffi.Pointer<ffi.Char>> value,
    mlx_map_string_to_string map,
    ffi.Pointer<ffi.Char> key,
  ) {
    return _mlx_map_string_to_string_get(
      value,
      map,
      key,
    );
  }

  late final _mlx_map_string_to_string_getPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Pointer<ffi.Char>>,
              mlx_map_string_to_string,
              ffi.Pointer<ffi.Char>)>>('mlx_map_string_to_string_get');
  late final _mlx_map_string_to_string_get =
      _mlx_map_string_to_string_getPtr.asFunction<
          int Function(ffi.Pointer<ffi.Pointer<ffi.Char>>,
              mlx_map_string_to_string, ffi.Pointer<ffi.Char>)>();

  /// Returns a new iterator over the given map.
  mlx_map_string_to_string_iterator mlx_map_string_to_string_iterator_new(
    mlx_map_string_to_string map,
  ) {
    return _mlx_map_string_to_string_iterator_new(
      map,
    );
  }

  late final _mlx_map_string_to_string_iterator_newPtr = _lookup<
          ffi.NativeFunction<
              mlx_map_string_to_string_iterator Function(
                  mlx_map_string_to_string)>>(
      'mlx_map_string_to_string_iterator_new');
  late final _mlx_map_string_to_string_iterator_new =
      _mlx_map_string_to_string_iterator_newPtr.asFunction<
          mlx_map_string_to_string_iterator Function(
              mlx_map_string_to_string)>();

  /// Free iterator.
  int mlx_map_string_to_string_iterator_free(
    mlx_map_string_to_string_iterator it,
  ) {
    return _mlx_map_string_to_string_iterator_free(
      it,
    );
  }

  late final _mlx_map_string_to_string_iterator_freePtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(mlx_map_string_to_string_iterator)>>(
      'mlx_map_string_to_string_iterator_free');
  late final _mlx_map_string_to_string_iterator_free =
      _mlx_map_string_to_string_iterator_freePtr
          .asFunction<int Function(mlx_map_string_to_string_iterator)>();

  /// Increment iterator.
  int mlx_map_string_to_string_iterator_next(
    ffi.Pointer<ffi.Pointer<ffi.Char>> key,
    ffi.Pointer<ffi.Pointer<ffi.Char>> value,
    mlx_map_string_to_string_iterator it,
  ) {
    return _mlx_map_string_to_string_iterator_next(
      key,
      value,
      it,
    );
  }

  late final _mlx_map_string_to_string_iterator_nextPtr = _lookup<
          ffi.NativeFunction<
              ffi.Int Function(
                  ffi.Pointer<ffi.Pointer<ffi.Char>>,
                  ffi.Pointer<ffi.Pointer<ffi.Char>>,
                  mlx_map_string_to_string_iterator)>>(
      'mlx_map_string_to_string_iterator_next');
  late final _mlx_map_string_to_string_iterator_next =
      _mlx_map_string_to_string_iterator_nextPtr.asFunction<
          int Function(
              ffi.Pointer<ffi.Pointer<ffi.Char>>,
              ffi.Pointer<ffi.Pointer<ffi.Char>>,
              mlx_map_string_to_string_iterator)>();

  mlx_vector_array mlx_vector_array_new() {
    return _mlx_vector_array_new();
  }

  late final _mlx_vector_array_newPtr =
      _lookup<ffi.NativeFunction<mlx_vector_array Function()>>(
          'mlx_vector_array_new');
  late final _mlx_vector_array_new =
      _mlx_vector_array_newPtr.asFunction<mlx_vector_array Function()>();

  int mlx_vector_array_set(
    ffi.Pointer<mlx_vector_array> vec,
    mlx_vector_array src,
  ) {
    return _mlx_vector_array_set(
      vec,
      src,
    );
  }

  late final _mlx_vector_array_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>,
              mlx_vector_array)>>('mlx_vector_array_set');
  late final _mlx_vector_array_set = _mlx_vector_array_setPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, mlx_vector_array)>();

  int mlx_vector_array_free(
    mlx_vector_array vec,
  ) {
    return _mlx_vector_array_free(
      vec,
    );
  }

  late final _mlx_vector_array_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_vector_array)>>(
          'mlx_vector_array_free');
  late final _mlx_vector_array_free =
      _mlx_vector_array_freePtr.asFunction<int Function(mlx_vector_array)>();

  mlx_vector_array mlx_vector_array_new_data(
    ffi.Pointer<mlx_array> data,
    int size,
  ) {
    return _mlx_vector_array_new_data(
      data,
      size,
    );
  }

  late final _mlx_vector_array_new_dataPtr = _lookup<
      ffi.NativeFunction<
          mlx_vector_array Function(
              ffi.Pointer<mlx_array>, ffi.Size)>>('mlx_vector_array_new_data');
  late final _mlx_vector_array_new_data = _mlx_vector_array_new_dataPtr
      .asFunction<mlx_vector_array Function(ffi.Pointer<mlx_array>, int)>();

  mlx_vector_array mlx_vector_array_new_value(
    mlx_array val,
  ) {
    return _mlx_vector_array_new_value(
      val,
    );
  }

  late final _mlx_vector_array_new_valuePtr =
      _lookup<ffi.NativeFunction<mlx_vector_array Function(mlx_array)>>(
          'mlx_vector_array_new_value');
  late final _mlx_vector_array_new_value = _mlx_vector_array_new_valuePtr
      .asFunction<mlx_vector_array Function(mlx_array)>();

  int mlx_vector_array_set_data(
    ffi.Pointer<mlx_vector_array> vec,
    ffi.Pointer<mlx_array> data,
    int size,
  ) {
    return _mlx_vector_array_set_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_array_set_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_array>, ffi.Size)>>('mlx_vector_array_set_data');
  late final _mlx_vector_array_set_data =
      _mlx_vector_array_set_dataPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_vector_array>, ffi.Pointer<mlx_array>, int)>();

  int mlx_vector_array_set_value(
    ffi.Pointer<mlx_vector_array> vec,
    mlx_array val,
  ) {
    return _mlx_vector_array_set_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_array_set_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>,
              mlx_array)>>('mlx_vector_array_set_value');
  late final _mlx_vector_array_set_value = _mlx_vector_array_set_valuePtr
      .asFunction<int Function(ffi.Pointer<mlx_vector_array>, mlx_array)>();

  int mlx_vector_array_append_data(
    mlx_vector_array vec,
    ffi.Pointer<mlx_array> data,
    int size,
  ) {
    return _mlx_vector_array_append_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_array_append_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_vector_array, ffi.Pointer<mlx_array>,
              ffi.Size)>>('mlx_vector_array_append_data');
  late final _mlx_vector_array_append_data =
      _mlx_vector_array_append_dataPtr.asFunction<
          int Function(mlx_vector_array, ffi.Pointer<mlx_array>, int)>();

  int mlx_vector_array_append_value(
    mlx_vector_array vec,
    mlx_array val,
  ) {
    return _mlx_vector_array_append_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_array_append_valuePtr = _lookup<
          ffi.NativeFunction<ffi.Int Function(mlx_vector_array, mlx_array)>>(
      'mlx_vector_array_append_value');
  late final _mlx_vector_array_append_value = _mlx_vector_array_append_valuePtr
      .asFunction<int Function(mlx_vector_array, mlx_array)>();

  int mlx_vector_array_size(
    mlx_vector_array vec,
  ) {
    return _mlx_vector_array_size(
      vec,
    );
  }

  late final _mlx_vector_array_sizePtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_vector_array)>>(
          'mlx_vector_array_size');
  late final _mlx_vector_array_size =
      _mlx_vector_array_sizePtr.asFunction<int Function(mlx_vector_array)>();

  int mlx_vector_array_get(
    ffi.Pointer<mlx_array> res,
    mlx_vector_array vec,
    int idx,
  ) {
    return _mlx_vector_array_get(
      res,
      vec,
      idx,
    );
  }

  late final _mlx_vector_array_getPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_vector_array,
              ffi.Size)>>('mlx_vector_array_get');
  late final _mlx_vector_array_get = _mlx_vector_array_getPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_vector_array, int)>();

  mlx_vector_vector_array mlx_vector_vector_array_new() {
    return _mlx_vector_vector_array_new();
  }

  late final _mlx_vector_vector_array_newPtr =
      _lookup<ffi.NativeFunction<mlx_vector_vector_array Function()>>(
          'mlx_vector_vector_array_new');
  late final _mlx_vector_vector_array_new = _mlx_vector_vector_array_newPtr
      .asFunction<mlx_vector_vector_array Function()>();

  int mlx_vector_vector_array_set(
    ffi.Pointer<mlx_vector_vector_array> vec,
    mlx_vector_vector_array src,
  ) {
    return _mlx_vector_vector_array_set(
      vec,
      src,
    );
  }

  late final _mlx_vector_vector_array_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_vector_array>,
              mlx_vector_vector_array)>>('mlx_vector_vector_array_set');
  late final _mlx_vector_vector_array_set =
      _mlx_vector_vector_array_setPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_vector_vector_array>, mlx_vector_vector_array)>();

  int mlx_vector_vector_array_free(
    mlx_vector_vector_array vec,
  ) {
    return _mlx_vector_vector_array_free(
      vec,
    );
  }

  late final _mlx_vector_vector_array_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_vector_vector_array)>>(
          'mlx_vector_vector_array_free');
  late final _mlx_vector_vector_array_free = _mlx_vector_vector_array_freePtr
      .asFunction<int Function(mlx_vector_vector_array)>();

  mlx_vector_vector_array mlx_vector_vector_array_new_data(
    ffi.Pointer<mlx_vector_array> data,
    int size,
  ) {
    return _mlx_vector_vector_array_new_data(
      data,
      size,
    );
  }

  late final _mlx_vector_vector_array_new_dataPtr = _lookup<
      ffi.NativeFunction<
          mlx_vector_vector_array Function(ffi.Pointer<mlx_vector_array>,
              ffi.Size)>>('mlx_vector_vector_array_new_data');
  late final _mlx_vector_vector_array_new_data =
      _mlx_vector_vector_array_new_dataPtr.asFunction<
          mlx_vector_vector_array Function(
              ffi.Pointer<mlx_vector_array>, int)>();

  mlx_vector_vector_array mlx_vector_vector_array_new_value(
    mlx_vector_array val,
  ) {
    return _mlx_vector_vector_array_new_value(
      val,
    );
  }

  late final _mlx_vector_vector_array_new_valuePtr = _lookup<
          ffi
          .NativeFunction<mlx_vector_vector_array Function(mlx_vector_array)>>(
      'mlx_vector_vector_array_new_value');
  late final _mlx_vector_vector_array_new_value =
      _mlx_vector_vector_array_new_valuePtr
          .asFunction<mlx_vector_vector_array Function(mlx_vector_array)>();

  int mlx_vector_vector_array_set_data(
    ffi.Pointer<mlx_vector_vector_array> vec,
    ffi.Pointer<mlx_vector_array> data,
    int size,
  ) {
    return _mlx_vector_vector_array_set_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_vector_array_set_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_vector_array>,
              ffi.Pointer<mlx_vector_array>,
              ffi.Size)>>('mlx_vector_vector_array_set_data');
  late final _mlx_vector_vector_array_set_data =
      _mlx_vector_vector_array_set_dataPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_vector_array>,
              ffi.Pointer<mlx_vector_array>, int)>();

  int mlx_vector_vector_array_set_value(
    ffi.Pointer<mlx_vector_vector_array> vec,
    mlx_vector_array val,
  ) {
    return _mlx_vector_vector_array_set_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_vector_array_set_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_vector_array>,
              mlx_vector_array)>>('mlx_vector_vector_array_set_value');
  late final _mlx_vector_vector_array_set_value =
      _mlx_vector_vector_array_set_valuePtr.asFunction<
          int Function(
              ffi.Pointer<mlx_vector_vector_array>, mlx_vector_array)>();

  int mlx_vector_vector_array_append_data(
    mlx_vector_vector_array vec,
    ffi.Pointer<mlx_vector_array> data,
    int size,
  ) {
    return _mlx_vector_vector_array_append_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_vector_array_append_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              mlx_vector_vector_array,
              ffi.Pointer<mlx_vector_array>,
              ffi.Size)>>('mlx_vector_vector_array_append_data');
  late final _mlx_vector_vector_array_append_data =
      _mlx_vector_vector_array_append_dataPtr.asFunction<
          int Function(
              mlx_vector_vector_array, ffi.Pointer<mlx_vector_array>, int)>();

  int mlx_vector_vector_array_append_value(
    mlx_vector_vector_array vec,
    mlx_vector_array val,
  ) {
    return _mlx_vector_vector_array_append_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_vector_array_append_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_vector_vector_array,
              mlx_vector_array)>>('mlx_vector_vector_array_append_value');
  late final _mlx_vector_vector_array_append_value =
      _mlx_vector_vector_array_append_valuePtr.asFunction<
          int Function(mlx_vector_vector_array, mlx_vector_array)>();

  int mlx_vector_vector_array_size(
    mlx_vector_vector_array vec,
  ) {
    return _mlx_vector_vector_array_size(
      vec,
    );
  }

  late final _mlx_vector_vector_array_sizePtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_vector_vector_array)>>(
          'mlx_vector_vector_array_size');
  late final _mlx_vector_vector_array_size = _mlx_vector_vector_array_sizePtr
      .asFunction<int Function(mlx_vector_vector_array)>();

  int mlx_vector_vector_array_get(
    ffi.Pointer<mlx_vector_array> res,
    mlx_vector_vector_array vec,
    int idx,
  ) {
    return _mlx_vector_vector_array_get(
      res,
      vec,
      idx,
    );
  }

  late final _mlx_vector_vector_array_getPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_vector_vector_array,
              ffi.Size)>>('mlx_vector_vector_array_get');
  late final _mlx_vector_vector_array_get =
      _mlx_vector_vector_array_getPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_vector_array>, mlx_vector_vector_array, int)>();

  mlx_vector_int mlx_vector_int_new() {
    return _mlx_vector_int_new();
  }

  late final _mlx_vector_int_newPtr =
      _lookup<ffi.NativeFunction<mlx_vector_int Function()>>(
          'mlx_vector_int_new');
  late final _mlx_vector_int_new =
      _mlx_vector_int_newPtr.asFunction<mlx_vector_int Function()>();

  int mlx_vector_int_set(
    ffi.Pointer<mlx_vector_int> vec,
    mlx_vector_int src,
  ) {
    return _mlx_vector_int_set(
      vec,
      src,
    );
  }

  late final _mlx_vector_int_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_int>,
              mlx_vector_int)>>('mlx_vector_int_set');
  late final _mlx_vector_int_set = _mlx_vector_int_setPtr
      .asFunction<int Function(ffi.Pointer<mlx_vector_int>, mlx_vector_int)>();

  int mlx_vector_int_free(
    mlx_vector_int vec,
  ) {
    return _mlx_vector_int_free(
      vec,
    );
  }

  late final _mlx_vector_int_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_vector_int)>>(
          'mlx_vector_int_free');
  late final _mlx_vector_int_free =
      _mlx_vector_int_freePtr.asFunction<int Function(mlx_vector_int)>();

  mlx_vector_int mlx_vector_int_new_data(
    ffi.Pointer<ffi.Int> data,
    int size,
  ) {
    return _mlx_vector_int_new_data(
      data,
      size,
    );
  }

  late final _mlx_vector_int_new_dataPtr = _lookup<
      ffi.NativeFunction<
          mlx_vector_int Function(
              ffi.Pointer<ffi.Int>, ffi.Size)>>('mlx_vector_int_new_data');
  late final _mlx_vector_int_new_data = _mlx_vector_int_new_dataPtr
      .asFunction<mlx_vector_int Function(ffi.Pointer<ffi.Int>, int)>();

  mlx_vector_int mlx_vector_int_new_value(
    int val,
  ) {
    return _mlx_vector_int_new_value(
      val,
    );
  }

  late final _mlx_vector_int_new_valuePtr =
      _lookup<ffi.NativeFunction<mlx_vector_int Function(ffi.Int)>>(
          'mlx_vector_int_new_value');
  late final _mlx_vector_int_new_value =
      _mlx_vector_int_new_valuePtr.asFunction<mlx_vector_int Function(int)>();

  int mlx_vector_int_set_data(
    ffi.Pointer<mlx_vector_int> vec,
    ffi.Pointer<ffi.Int> data,
    int size,
  ) {
    return _mlx_vector_int_set_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_int_set_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_int>, ffi.Pointer<ffi.Int>,
              ffi.Size)>>('mlx_vector_int_set_data');
  late final _mlx_vector_int_set_data = _mlx_vector_int_set_dataPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_int>, ffi.Pointer<ffi.Int>, int)>();

  int mlx_vector_int_set_value(
    ffi.Pointer<mlx_vector_int> vec,
    int val,
  ) {
    return _mlx_vector_int_set_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_int_set_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_int>,
              ffi.Int)>>('mlx_vector_int_set_value');
  late final _mlx_vector_int_set_value = _mlx_vector_int_set_valuePtr
      .asFunction<int Function(ffi.Pointer<mlx_vector_int>, int)>();

  int mlx_vector_int_append_data(
    mlx_vector_int vec,
    ffi.Pointer<ffi.Int> data,
    int size,
  ) {
    return _mlx_vector_int_append_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_int_append_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_vector_int, ffi.Pointer<ffi.Int>,
              ffi.Size)>>('mlx_vector_int_append_data');
  late final _mlx_vector_int_append_data = _mlx_vector_int_append_dataPtr
      .asFunction<int Function(mlx_vector_int, ffi.Pointer<ffi.Int>, int)>();

  int mlx_vector_int_append_value(
    mlx_vector_int vec,
    int val,
  ) {
    return _mlx_vector_int_append_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_int_append_valuePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_vector_int, ffi.Int)>>(
          'mlx_vector_int_append_value');
  late final _mlx_vector_int_append_value = _mlx_vector_int_append_valuePtr
      .asFunction<int Function(mlx_vector_int, int)>();

  int mlx_vector_int_size(
    mlx_vector_int vec,
  ) {
    return _mlx_vector_int_size(
      vec,
    );
  }

  late final _mlx_vector_int_sizePtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_vector_int)>>(
          'mlx_vector_int_size');
  late final _mlx_vector_int_size =
      _mlx_vector_int_sizePtr.asFunction<int Function(mlx_vector_int)>();

  int mlx_vector_int_get(
    ffi.Pointer<ffi.Int> res,
    mlx_vector_int vec,
    int idx,
  ) {
    return _mlx_vector_int_get(
      res,
      vec,
      idx,
    );
  }

  late final _mlx_vector_int_getPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Int>, mlx_vector_int,
              ffi.Size)>>('mlx_vector_int_get');
  late final _mlx_vector_int_get = _mlx_vector_int_getPtr
      .asFunction<int Function(ffi.Pointer<ffi.Int>, mlx_vector_int, int)>();

  mlx_vector_string mlx_vector_string_new() {
    return _mlx_vector_string_new();
  }

  late final _mlx_vector_string_newPtr =
      _lookup<ffi.NativeFunction<mlx_vector_string Function()>>(
          'mlx_vector_string_new');
  late final _mlx_vector_string_new =
      _mlx_vector_string_newPtr.asFunction<mlx_vector_string Function()>();

  int mlx_vector_string_set(
    ffi.Pointer<mlx_vector_string> vec,
    mlx_vector_string src,
  ) {
    return _mlx_vector_string_set(
      vec,
      src,
    );
  }

  late final _mlx_vector_string_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_string>,
              mlx_vector_string)>>('mlx_vector_string_set');
  late final _mlx_vector_string_set = _mlx_vector_string_setPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_string>, mlx_vector_string)>();

  int mlx_vector_string_free(
    mlx_vector_string vec,
  ) {
    return _mlx_vector_string_free(
      vec,
    );
  }

  late final _mlx_vector_string_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_vector_string)>>(
          'mlx_vector_string_free');
  late final _mlx_vector_string_free =
      _mlx_vector_string_freePtr.asFunction<int Function(mlx_vector_string)>();

  mlx_vector_string mlx_vector_string_new_data(
    ffi.Pointer<ffi.Pointer<ffi.Char>> data,
    int size,
  ) {
    return _mlx_vector_string_new_data(
      data,
      size,
    );
  }

  late final _mlx_vector_string_new_dataPtr = _lookup<
      ffi.NativeFunction<
          mlx_vector_string Function(ffi.Pointer<ffi.Pointer<ffi.Char>>,
              ffi.Size)>>('mlx_vector_string_new_data');
  late final _mlx_vector_string_new_data =
      _mlx_vector_string_new_dataPtr.asFunction<
          mlx_vector_string Function(
              ffi.Pointer<ffi.Pointer<ffi.Char>>, int)>();

  mlx_vector_string mlx_vector_string_new_value(
    ffi.Pointer<ffi.Char> val,
  ) {
    return _mlx_vector_string_new_value(
      val,
    );
  }

  late final _mlx_vector_string_new_valuePtr = _lookup<
          ffi
          .NativeFunction<mlx_vector_string Function(ffi.Pointer<ffi.Char>)>>(
      'mlx_vector_string_new_value');
  late final _mlx_vector_string_new_value = _mlx_vector_string_new_valuePtr
      .asFunction<mlx_vector_string Function(ffi.Pointer<ffi.Char>)>();

  int mlx_vector_string_set_data(
    ffi.Pointer<mlx_vector_string> vec,
    ffi.Pointer<ffi.Pointer<ffi.Char>> data,
    int size,
  ) {
    return _mlx_vector_string_set_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_string_set_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_string>,
              ffi.Pointer<ffi.Pointer<ffi.Char>>,
              ffi.Size)>>('mlx_vector_string_set_data');
  late final _mlx_vector_string_set_data =
      _mlx_vector_string_set_dataPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_string>,
              ffi.Pointer<ffi.Pointer<ffi.Char>>, int)>();

  int mlx_vector_string_set_value(
    ffi.Pointer<mlx_vector_string> vec,
    ffi.Pointer<ffi.Char> val,
  ) {
    return _mlx_vector_string_set_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_string_set_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_string>,
              ffi.Pointer<ffi.Char>)>>('mlx_vector_string_set_value');
  late final _mlx_vector_string_set_value =
      _mlx_vector_string_set_valuePtr.asFunction<
          int Function(
              ffi.Pointer<mlx_vector_string>, ffi.Pointer<ffi.Char>)>();

  int mlx_vector_string_append_data(
    mlx_vector_string vec,
    ffi.Pointer<ffi.Pointer<ffi.Char>> data,
    int size,
  ) {
    return _mlx_vector_string_append_data(
      vec,
      data,
      size,
    );
  }

  late final _mlx_vector_string_append_dataPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              mlx_vector_string,
              ffi.Pointer<ffi.Pointer<ffi.Char>>,
              ffi.Size)>>('mlx_vector_string_append_data');
  late final _mlx_vector_string_append_data =
      _mlx_vector_string_append_dataPtr.asFunction<
          int Function(
              mlx_vector_string, ffi.Pointer<ffi.Pointer<ffi.Char>>, int)>();

  int mlx_vector_string_append_value(
    mlx_vector_string vec,
    ffi.Pointer<ffi.Char> val,
  ) {
    return _mlx_vector_string_append_value(
      vec,
      val,
    );
  }

  late final _mlx_vector_string_append_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_vector_string,
              ffi.Pointer<ffi.Char>)>>('mlx_vector_string_append_value');
  late final _mlx_vector_string_append_value =
      _mlx_vector_string_append_valuePtr
          .asFunction<int Function(mlx_vector_string, ffi.Pointer<ffi.Char>)>();

  int mlx_vector_string_size(
    mlx_vector_string vec,
  ) {
    return _mlx_vector_string_size(
      vec,
    );
  }

  late final _mlx_vector_string_sizePtr =
      _lookup<ffi.NativeFunction<ffi.Size Function(mlx_vector_string)>>(
          'mlx_vector_string_size');
  late final _mlx_vector_string_size =
      _mlx_vector_string_sizePtr.asFunction<int Function(mlx_vector_string)>();

  int mlx_vector_string_get(
    ffi.Pointer<ffi.Pointer<ffi.Char>> res,
    mlx_vector_string vec,
    int idx,
  ) {
    return _mlx_vector_string_get(
      res,
      vec,
      idx,
    );
  }

  late final _mlx_vector_string_getPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Pointer<ffi.Char>>,
              mlx_vector_string, ffi.Size)>>('mlx_vector_string_get');
  late final _mlx_vector_string_get = _mlx_vector_string_getPtr.asFunction<
      int Function(
          ffi.Pointer<ffi.Pointer<ffi.Char>>, mlx_vector_string, int)>();

  /// Returns a new empty device.
  mlx_device mlx_device_new() {
    return _mlx_device_new();
  }

  late final _mlx_device_newPtr =
      _lookup<ffi.NativeFunction<mlx_device Function()>>('mlx_device_new');
  late final _mlx_device_new =
      _mlx_device_newPtr.asFunction<mlx_device Function()>();

  /// Returns a new device of specified `type`, with specified `index`.
  mlx_device mlx_device_new_type(
    mlx_device_type_ type,
    int index,
  ) {
    return _mlx_device_new_type(
      type.value,
      index,
    );
  }

  late final _mlx_device_new_typePtr = _lookup<
          ffi.NativeFunction<mlx_device Function(ffi.UnsignedInt, ffi.Int)>>(
      'mlx_device_new_type');
  late final _mlx_device_new_type =
      _mlx_device_new_typePtr.asFunction<mlx_device Function(int, int)>();

  /// Free a device.
  int mlx_device_free(
    mlx_device dev,
  ) {
    return _mlx_device_free(
      dev,
    );
  }

  late final _mlx_device_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_device)>>(
          'mlx_device_free');
  late final _mlx_device_free =
      _mlx_device_freePtr.asFunction<int Function(mlx_device)>();

  /// Set device to provided src device.
  int mlx_device_set(
    ffi.Pointer<mlx_device> dev,
    mlx_device src,
  ) {
    return _mlx_device_set(
      dev,
      src,
    );
  }

  late final _mlx_device_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_device>, mlx_device)>>('mlx_device_set');
  late final _mlx_device_set = _mlx_device_setPtr
      .asFunction<int Function(ffi.Pointer<mlx_device>, mlx_device)>();

  /// Get device description.
  int mlx_device_tostring(
    ffi.Pointer<mlx_string> str,
    mlx_device dev,
  ) {
    return _mlx_device_tostring(
      str,
      dev,
    );
  }

  late final _mlx_device_tostringPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_string>, mlx_device)>>('mlx_device_tostring');
  late final _mlx_device_tostring = _mlx_device_tostringPtr
      .asFunction<int Function(ffi.Pointer<mlx_string>, mlx_device)>();

  /// Check if devices are the same.
  bool mlx_device_equal(
    mlx_device lhs,
    mlx_device rhs,
  ) {
    return _mlx_device_equal(
      lhs,
      rhs,
    );
  }

  late final _mlx_device_equalPtr =
      _lookup<ffi.NativeFunction<ffi.Bool Function(mlx_device, mlx_device)>>(
          'mlx_device_equal');
  late final _mlx_device_equal =
      _mlx_device_equalPtr.asFunction<bool Function(mlx_device, mlx_device)>();

  /// Returns the index of the device.
  int mlx_device_get_index(
    ffi.Pointer<ffi.Int> index,
    mlx_device dev,
  ) {
    return _mlx_device_get_index(
      index,
      dev,
    );
  }

  late final _mlx_device_get_indexPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Int>, mlx_device)>>(
      'mlx_device_get_index');
  late final _mlx_device_get_index = _mlx_device_get_indexPtr
      .asFunction<int Function(ffi.Pointer<ffi.Int>, mlx_device)>();

  /// Returns the type of the device.
  int mlx_device_get_type(
    ffi.Pointer<ffi.UnsignedInt> type,
    mlx_device dev,
  ) {
    return _mlx_device_get_type(
      type,
      dev,
    );
  }

  late final _mlx_device_get_typePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.UnsignedInt>,
              mlx_device)>>('mlx_device_get_type');
  late final _mlx_device_get_type = _mlx_device_get_typePtr
      .asFunction<int Function(ffi.Pointer<ffi.UnsignedInt>, mlx_device)>();

  /// Returns the default MLX device.
  int mlx_get_default_device(
    ffi.Pointer<mlx_device> dev,
  ) {
    return _mlx_get_default_device(
      dev,
    );
  }

  late final _mlx_get_default_devicePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<mlx_device>)>>(
          'mlx_get_default_device');
  late final _mlx_get_default_device = _mlx_get_default_devicePtr
      .asFunction<int Function(ffi.Pointer<mlx_device>)>();

  /// Set the default MLX device.
  int mlx_set_default_device(
    mlx_device dev,
  ) {
    return _mlx_set_default_device(
      dev,
    );
  }

  late final _mlx_set_default_devicePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_device)>>(
          'mlx_set_default_device');
  late final _mlx_set_default_device =
      _mlx_set_default_devicePtr.asFunction<int Function(mlx_device)>();

  /// Check if device is available.
  int mlx_device_is_available(
    ffi.Pointer<ffi.Bool> avail,
    mlx_device dev,
  ) {
    return _mlx_device_is_available(
      avail,
      dev,
    );
  }

  late final _mlx_device_is_availablePtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Bool>, mlx_device)>>(
      'mlx_device_is_available');
  late final _mlx_device_is_available = _mlx_device_is_availablePtr
      .asFunction<int Function(ffi.Pointer<ffi.Bool>, mlx_device)>();

  /// Get the number of available devices for a device type.
  int mlx_device_count(
    ffi.Pointer<ffi.Int> count,
    mlx_device_type_ type,
  ) {
    return _mlx_device_count(
      count,
      type.value,
    );
  }

  late final _mlx_device_countPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Int>, ffi.UnsignedInt)>>('mlx_device_count');
  late final _mlx_device_count = _mlx_device_countPtr
      .asFunction<int Function(ffi.Pointer<ffi.Int>, int)>();

  /// Returns a new empty device info object.
  mlx_device_info mlx_device_info_new() {
    return _mlx_device_info_new();
  }

  late final _mlx_device_info_newPtr =
      _lookup<ffi.NativeFunction<mlx_device_info Function()>>(
          'mlx_device_info_new');
  late final _mlx_device_info_new =
      _mlx_device_info_newPtr.asFunction<mlx_device_info Function()>();

  /// Get device information for a device.
  int mlx_device_info_get(
    ffi.Pointer<mlx_device_info> info,
    mlx_device dev,
  ) {
    return _mlx_device_info_get(
      info,
      dev,
    );
  }

  late final _mlx_device_info_getPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_device_info>,
              mlx_device)>>('mlx_device_info_get');
  late final _mlx_device_info_get = _mlx_device_info_getPtr
      .asFunction<int Function(ffi.Pointer<mlx_device_info>, mlx_device)>();

  /// Free a device info object.
  int mlx_device_info_free(
    mlx_device_info info,
  ) {
    return _mlx_device_info_free(
      info,
    );
  }

  late final _mlx_device_info_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_device_info)>>(
          'mlx_device_info_free');
  late final _mlx_device_info_free =
      _mlx_device_info_freePtr.asFunction<int Function(mlx_device_info)>();

  /// Check if a key exists in the device info.
  /// Returns 0 on success, 1 on error.
  /// Sets *exists to true if the key exists, false otherwise.
  int mlx_device_info_has_key(
    ffi.Pointer<ffi.Bool> exists,
    mlx_device_info info,
    ffi.Pointer<ffi.Char> key,
  ) {
    return _mlx_device_info_has_key(
      exists,
      info,
      key,
    );
  }

  late final _mlx_device_info_has_keyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Bool>, mlx_device_info,
              ffi.Pointer<ffi.Char>)>>('mlx_device_info_has_key');
  late final _mlx_device_info_has_key = _mlx_device_info_has_keyPtr.asFunction<
      int Function(
          ffi.Pointer<ffi.Bool>, mlx_device_info, ffi.Pointer<ffi.Char>)>();

  /// Check if a value is a string type.
  /// Returns 0 on success, 1 on error.
  /// Sets *is_string to true if the value is a string, false if it's a size_t.
  int mlx_device_info_is_string(
    ffi.Pointer<ffi.Bool> is_string,
    mlx_device_info info,
    ffi.Pointer<ffi.Char> key,
  ) {
    return _mlx_device_info_is_string(
      is_string,
      info,
      key,
    );
  }

  late final _mlx_device_info_is_stringPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Bool>, mlx_device_info,
              ffi.Pointer<ffi.Char>)>>('mlx_device_info_is_string');
  late final _mlx_device_info_is_string =
      _mlx_device_info_is_stringPtr.asFunction<
          int Function(
              ffi.Pointer<ffi.Bool>, mlx_device_info, ffi.Pointer<ffi.Char>)>();

  /// Get a string value from device info.
  /// Returns 0 on success, 1 on error, 2 if key not found or wrong type.
  int mlx_device_info_get_string(
    ffi.Pointer<ffi.Pointer<ffi.Char>> value,
    mlx_device_info info,
    ffi.Pointer<ffi.Char> key,
  ) {
    return _mlx_device_info_get_string(
      value,
      info,
      key,
    );
  }

  late final _mlx_device_info_get_stringPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Pointer<ffi.Char>>, mlx_device_info,
              ffi.Pointer<ffi.Char>)>>('mlx_device_info_get_string');
  late final _mlx_device_info_get_string =
      _mlx_device_info_get_stringPtr.asFunction<
          int Function(ffi.Pointer<ffi.Pointer<ffi.Char>>, mlx_device_info,
              ffi.Pointer<ffi.Char>)>();

  /// Get a size_t value from device info.
  /// Returns 0 on success, 1 on error, 2 if key not found or wrong type.
  int mlx_device_info_get_size(
    ffi.Pointer<ffi.Size> value,
    mlx_device_info info,
    ffi.Pointer<ffi.Char> key,
  ) {
    return _mlx_device_info_get_size(
      value,
      info,
      key,
    );
  }

  late final _mlx_device_info_get_sizePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Size>, mlx_device_info,
              ffi.Pointer<ffi.Char>)>>('mlx_device_info_get_size');
  late final _mlx_device_info_get_size =
      _mlx_device_info_get_sizePtr.asFunction<
          int Function(
              ffi.Pointer<ffi.Size>, mlx_device_info, ffi.Pointer<ffi.Char>)>();

  /// Get all keys from device info.
  /// Returns 0 on success, 1 on error.
  int mlx_device_info_get_keys(
    ffi.Pointer<mlx_vector_string> keys,
    mlx_device_info info,
  ) {
    return _mlx_device_info_get_keys(
      keys,
      info,
    );
  }

  late final _mlx_device_info_get_keysPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_string>,
              mlx_device_info)>>('mlx_device_info_get_keys');
  late final _mlx_device_info_get_keys =
      _mlx_device_info_get_keysPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_string>, mlx_device_info)>();

  /// Returns a new empty stream.
  mlx_stream mlx_stream_new() {
    return _mlx_stream_new();
  }

  late final _mlx_stream_newPtr =
      _lookup<ffi.NativeFunction<mlx_stream Function()>>('mlx_stream_new');
  late final _mlx_stream_new =
      _mlx_stream_newPtr.asFunction<mlx_stream Function()>();

  /// Returns a new stream on a device.
  mlx_stream mlx_stream_new_device(
    mlx_device dev,
  ) {
    return _mlx_stream_new_device(
      dev,
    );
  }

  late final _mlx_stream_new_devicePtr =
      _lookup<ffi.NativeFunction<mlx_stream Function(mlx_device)>>(
          'mlx_stream_new_device');
  late final _mlx_stream_new_device =
      _mlx_stream_new_devicePtr.asFunction<mlx_stream Function(mlx_device)>();

  /// Set stream to provided src stream.
  int mlx_stream_set(
    ffi.Pointer<mlx_stream> stream,
    mlx_stream src,
  ) {
    return _mlx_stream_set(
      stream,
      src,
    );
  }

  late final _mlx_stream_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_stream>, mlx_stream)>>('mlx_stream_set');
  late final _mlx_stream_set = _mlx_stream_setPtr
      .asFunction<int Function(ffi.Pointer<mlx_stream>, mlx_stream)>();

  /// Free a stream.
  int mlx_stream_free(
    mlx_stream stream,
  ) {
    return _mlx_stream_free(
      stream,
    );
  }

  late final _mlx_stream_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_stream)>>(
          'mlx_stream_free');
  late final _mlx_stream_free =
      _mlx_stream_freePtr.asFunction<int Function(mlx_stream)>();

  /// Get stream description.
  int mlx_stream_tostring(
    ffi.Pointer<mlx_string> str,
    mlx_stream stream,
  ) {
    return _mlx_stream_tostring(
      str,
      stream,
    );
  }

  late final _mlx_stream_tostringPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_string>, mlx_stream)>>('mlx_stream_tostring');
  late final _mlx_stream_tostring = _mlx_stream_tostringPtr
      .asFunction<int Function(ffi.Pointer<mlx_string>, mlx_stream)>();

  /// Check if streams are the same.
  bool mlx_stream_equal(
    mlx_stream lhs,
    mlx_stream rhs,
  ) {
    return _mlx_stream_equal(
      lhs,
      rhs,
    );
  }

  late final _mlx_stream_equalPtr =
      _lookup<ffi.NativeFunction<ffi.Bool Function(mlx_stream, mlx_stream)>>(
          'mlx_stream_equal');
  late final _mlx_stream_equal =
      _mlx_stream_equalPtr.asFunction<bool Function(mlx_stream, mlx_stream)>();

  /// Return the device of the stream.
  int mlx_stream_get_device(
    ffi.Pointer<mlx_device> dev,
    mlx_stream stream,
  ) {
    return _mlx_stream_get_device(
      dev,
      stream,
    );
  }

  late final _mlx_stream_get_devicePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_device>, mlx_stream)>>('mlx_stream_get_device');
  late final _mlx_stream_get_device = _mlx_stream_get_devicePtr
      .asFunction<int Function(ffi.Pointer<mlx_device>, mlx_stream)>();

  /// Return the index of the stream.
  int mlx_stream_get_index(
    ffi.Pointer<ffi.Int> index,
    mlx_stream stream,
  ) {
    return _mlx_stream_get_index(
      index,
      stream,
    );
  }

  late final _mlx_stream_get_indexPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Int>, mlx_stream)>>(
      'mlx_stream_get_index');
  late final _mlx_stream_get_index = _mlx_stream_get_indexPtr
      .asFunction<int Function(ffi.Pointer<ffi.Int>, mlx_stream)>();

  /// Synchronize with the provided stream.
  int mlx_synchronize(
    mlx_stream stream,
  ) {
    return _mlx_synchronize(
      stream,
    );
  }

  late final _mlx_synchronizePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_stream)>>(
          'mlx_synchronize');
  late final _mlx_synchronize =
      _mlx_synchronizePtr.asFunction<int Function(mlx_stream)>();

  /// Returns the default stream on the given device.
  int mlx_get_default_stream(
    ffi.Pointer<mlx_stream> stream,
    mlx_device dev,
  ) {
    return _mlx_get_default_stream(
      stream,
      dev,
    );
  }

  late final _mlx_get_default_streamPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_stream>, mlx_device)>>('mlx_get_default_stream');
  late final _mlx_get_default_stream = _mlx_get_default_streamPtr
      .asFunction<int Function(ffi.Pointer<mlx_stream>, mlx_device)>();

  /// Set default stream.
  int mlx_set_default_stream(
    mlx_stream stream,
  ) {
    return _mlx_set_default_stream(
      stream,
    );
  }

  late final _mlx_set_default_streamPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_stream)>>(
          'mlx_set_default_stream');
  late final _mlx_set_default_stream =
      _mlx_set_default_streamPtr.asFunction<int Function(mlx_stream)>();

  /// Returns the current default CPU stream.
  mlx_stream mlx_default_cpu_stream_new() {
    return _mlx_default_cpu_stream_new();
  }

  late final _mlx_default_cpu_stream_newPtr =
      _lookup<ffi.NativeFunction<mlx_stream Function()>>(
          'mlx_default_cpu_stream_new');
  late final _mlx_default_cpu_stream_new =
      _mlx_default_cpu_stream_newPtr.asFunction<mlx_stream Function()>();

  /// Returns the current default GPU stream.
  mlx_stream mlx_default_gpu_stream_new() {
    return _mlx_default_gpu_stream_new();
  }

  late final _mlx_default_gpu_stream_newPtr =
      _lookup<ffi.NativeFunction<mlx_stream Function()>>(
          'mlx_default_gpu_stream_new');
  late final _mlx_default_gpu_stream_new =
      _mlx_default_gpu_stream_newPtr.asFunction<mlx_stream Function()>();

  mlx_closure mlx_closure_new() {
    return _mlx_closure_new();
  }

  late final _mlx_closure_newPtr =
      _lookup<ffi.NativeFunction<mlx_closure Function()>>('mlx_closure_new');
  late final _mlx_closure_new =
      _mlx_closure_newPtr.asFunction<mlx_closure Function()>();

  int mlx_closure_free(
    mlx_closure cls,
  ) {
    return _mlx_closure_free(
      cls,
    );
  }

  late final _mlx_closure_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_closure)>>(
          'mlx_closure_free');
  late final _mlx_closure_free =
      _mlx_closure_freePtr.asFunction<int Function(mlx_closure)>();

  mlx_closure mlx_closure_new_func(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>, mlx_vector_array)>>
        fun,
  ) {
    return _mlx_closure_new_func(
      fun,
    );
  }

  late final _mlx_closure_new_funcPtr = _lookup<
      ffi.NativeFunction<
          mlx_closure Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array)>>)>>('mlx_closure_new_func');
  late final _mlx_closure_new_func = _mlx_closure_new_funcPtr.asFunction<
      mlx_closure Function(
          ffi.Pointer<
              ffi.NativeFunction<
                  ffi.Int Function(
                      ffi.Pointer<mlx_vector_array>, mlx_vector_array)>>)>();

  mlx_closure mlx_closure_new_func_payload(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array, ffi.Pointer<ffi.Void>)>>
        fun,
    ffi.Pointer<ffi.Void> payload,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_closure_new_func_payload(
      fun,
      payload,
      dtor,
    );
  }

  late final _mlx_closure_new_func_payloadPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                              mlx_vector_array, ffi.Pointer<ffi.Void>)>>,
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_closure_new_func_payload');
  late final _mlx_closure_new_func_payload =
      _mlx_closure_new_func_payloadPtr.asFunction<
          mlx_closure Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array, ffi.Pointer<ffi.Void>)>>,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  int mlx_closure_set(
    ffi.Pointer<mlx_closure> cls,
    mlx_closure src,
  ) {
    return _mlx_closure_set(
      cls,
      src,
    );
  }

  late final _mlx_closure_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_closure>, mlx_closure)>>('mlx_closure_set');
  late final _mlx_closure_set = _mlx_closure_setPtr
      .asFunction<int Function(ffi.Pointer<mlx_closure>, mlx_closure)>();

  int mlx_closure_apply(
    ffi.Pointer<mlx_vector_array> res,
    mlx_closure cls,
    mlx_vector_array input,
  ) {
    return _mlx_closure_apply(
      res,
      cls,
      input,
    );
  }

  late final _mlx_closure_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_closure,
              mlx_vector_array)>>('mlx_closure_apply');
  late final _mlx_closure_apply = _mlx_closure_applyPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_vector_array>, mlx_closure, mlx_vector_array)>();

  mlx_closure mlx_closure_new_unary(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array)>>
        fun,
  ) {
    return _mlx_closure_new_unary(
      fun,
    );
  }

  late final _mlx_closure_new_unaryPtr = _lookup<
      ffi.NativeFunction<
          mlx_closure Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(ffi.Pointer<mlx_array>,
                          mlx_array)>>)>>('mlx_closure_new_unary');
  late final _mlx_closure_new_unary = _mlx_closure_new_unaryPtr.asFunction<
      mlx_closure Function(
          ffi.Pointer<
              ffi.NativeFunction<
                  ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array)>>)>();

  mlx_closure_kwargs mlx_closure_kwargs_new() {
    return _mlx_closure_kwargs_new();
  }

  late final _mlx_closure_kwargs_newPtr =
      _lookup<ffi.NativeFunction<mlx_closure_kwargs Function()>>(
          'mlx_closure_kwargs_new');
  late final _mlx_closure_kwargs_new =
      _mlx_closure_kwargs_newPtr.asFunction<mlx_closure_kwargs Function()>();

  int mlx_closure_kwargs_free(
    mlx_closure_kwargs cls,
  ) {
    return _mlx_closure_kwargs_free(
      cls,
    );
  }

  late final _mlx_closure_kwargs_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_closure_kwargs)>>(
          'mlx_closure_kwargs_free');
  late final _mlx_closure_kwargs_free = _mlx_closure_kwargs_freePtr
      .asFunction<int Function(mlx_closure_kwargs)>();

  mlx_closure_kwargs mlx_closure_kwargs_new_func(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array, mlx_map_string_to_array)>>
        fun,
  ) {
    return _mlx_closure_kwargs_new_func(
      fun,
    );
  }

  late final _mlx_closure_kwargs_new_funcPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure_kwargs Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                              mlx_vector_array, mlx_map_string_to_array)>>)>>(
      'mlx_closure_kwargs_new_func');
  late final _mlx_closure_kwargs_new_func =
      _mlx_closure_kwargs_new_funcPtr.asFunction<
          mlx_closure_kwargs Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array, mlx_map_string_to_array)>>)>();

  mlx_closure_kwargs mlx_closure_kwargs_new_func_payload(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array,
                    mlx_map_string_to_array,
                    ffi.Pointer<ffi.Void>)>>
        fun,
    ffi.Pointer<ffi.Void> payload,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_closure_kwargs_new_func_payload(
      fun,
      payload,
      dtor,
    );
  }

  late final _mlx_closure_kwargs_new_func_payloadPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure_kwargs Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(
                              ffi.Pointer<mlx_vector_array>,
                              mlx_vector_array,
                              mlx_map_string_to_array,
                              ffi.Pointer<ffi.Void>)>>,
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_closure_kwargs_new_func_payload');
  late final _mlx_closure_kwargs_new_func_payload =
      _mlx_closure_kwargs_new_func_payloadPtr.asFunction<
          mlx_closure_kwargs Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          mlx_map_string_to_array,
                          ffi.Pointer<ffi.Void>)>>,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  int mlx_closure_kwargs_set(
    ffi.Pointer<mlx_closure_kwargs> cls,
    mlx_closure_kwargs src,
  ) {
    return _mlx_closure_kwargs_set(
      cls,
      src,
    );
  }

  late final _mlx_closure_kwargs_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_closure_kwargs>,
              mlx_closure_kwargs)>>('mlx_closure_kwargs_set');
  late final _mlx_closure_kwargs_set = _mlx_closure_kwargs_setPtr.asFunction<
      int Function(ffi.Pointer<mlx_closure_kwargs>, mlx_closure_kwargs)>();

  int mlx_closure_kwargs_apply(
    ffi.Pointer<mlx_vector_array> res,
    mlx_closure_kwargs cls,
    mlx_vector_array input_0,
    mlx_map_string_to_array input_1,
  ) {
    return _mlx_closure_kwargs_apply(
      res,
      cls,
      input_0,
      input_1,
    );
  }

  late final _mlx_closure_kwargs_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_closure_kwargs,
              mlx_vector_array,
              mlx_map_string_to_array)>>('mlx_closure_kwargs_apply');
  late final _mlx_closure_kwargs_apply =
      _mlx_closure_kwargs_applyPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_array>, mlx_closure_kwargs,
              mlx_vector_array, mlx_map_string_to_array)>();

  mlx_closure_value_and_grad mlx_closure_value_and_grad_new() {
    return _mlx_closure_value_and_grad_new();
  }

  late final _mlx_closure_value_and_grad_newPtr =
      _lookup<ffi.NativeFunction<mlx_closure_value_and_grad Function()>>(
          'mlx_closure_value_and_grad_new');
  late final _mlx_closure_value_and_grad_new =
      _mlx_closure_value_and_grad_newPtr
          .asFunction<mlx_closure_value_and_grad Function()>();

  int mlx_closure_value_and_grad_free(
    mlx_closure_value_and_grad cls,
  ) {
    return _mlx_closure_value_and_grad_free(
      cls,
    );
  }

  late final _mlx_closure_value_and_grad_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_closure_value_and_grad)>>(
          'mlx_closure_value_and_grad_free');
  late final _mlx_closure_value_and_grad_free =
      _mlx_closure_value_and_grad_freePtr
          .asFunction<int Function(mlx_closure_value_and_grad)>();

  mlx_closure_value_and_grad mlx_closure_value_and_grad_new_func(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                    ffi.Pointer<mlx_vector_array>, mlx_vector_array)>>
        fun,
  ) {
    return _mlx_closure_value_and_grad_new_func(
      fun,
    );
  }

  late final _mlx_closure_value_and_grad_new_funcPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure_value_and_grad Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(
                              ffi.Pointer<mlx_vector_array>,
                              ffi.Pointer<mlx_vector_array>,
                              mlx_vector_array)>>)>>(
      'mlx_closure_value_and_grad_new_func');
  late final _mlx_closure_value_and_grad_new_func =
      _mlx_closure_value_and_grad_new_funcPtr.asFunction<
          mlx_closure_value_and_grad Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array)>>)>();

  mlx_closure_value_and_grad mlx_closure_value_and_grad_new_func_payload(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>,
                    ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array,
                    ffi.Pointer<ffi.Void>)>>
        fun,
    ffi.Pointer<ffi.Void> payload,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_closure_value_and_grad_new_func_payload(
      fun,
      payload,
      dtor,
    );
  }

  late final _mlx_closure_value_and_grad_new_func_payloadPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure_value_and_grad Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(
                              ffi.Pointer<mlx_vector_array>,
                              ffi.Pointer<mlx_vector_array>,
                              mlx_vector_array,
                              ffi.Pointer<ffi.Void>)>>,
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_closure_value_and_grad_new_func_payload');
  late final _mlx_closure_value_and_grad_new_func_payload =
      _mlx_closure_value_and_grad_new_func_payloadPtr.asFunction<
          mlx_closure_value_and_grad Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Void>)>>,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  int mlx_closure_value_and_grad_set(
    ffi.Pointer<mlx_closure_value_and_grad> cls,
    mlx_closure_value_and_grad src,
  ) {
    return _mlx_closure_value_and_grad_set(
      cls,
      src,
    );
  }

  late final _mlx_closure_value_and_grad_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_closure_value_and_grad>,
              mlx_closure_value_and_grad)>>('mlx_closure_value_and_grad_set');
  late final _mlx_closure_value_and_grad_set =
      _mlx_closure_value_and_grad_setPtr.asFunction<
          int Function(ffi.Pointer<mlx_closure_value_and_grad>,
              mlx_closure_value_and_grad)>();

  int mlx_closure_value_and_grad_apply(
    ffi.Pointer<mlx_vector_array> res_0,
    ffi.Pointer<mlx_vector_array> res_1,
    mlx_closure_value_and_grad cls,
    mlx_vector_array input,
  ) {
    return _mlx_closure_value_and_grad_apply(
      res_0,
      res_1,
      cls,
      input,
    );
  }

  late final _mlx_closure_value_and_grad_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_vector_array>,
              mlx_closure_value_and_grad,
              mlx_vector_array)>>('mlx_closure_value_and_grad_apply');
  late final _mlx_closure_value_and_grad_apply =
      _mlx_closure_value_and_grad_applyPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_vector_array>,
              mlx_closure_value_and_grad,
              mlx_vector_array)>();

  mlx_closure_custom mlx_closure_custom_new() {
    return _mlx_closure_custom_new();
  }

  late final _mlx_closure_custom_newPtr =
      _lookup<ffi.NativeFunction<mlx_closure_custom Function()>>(
          'mlx_closure_custom_new');
  late final _mlx_closure_custom_new =
      _mlx_closure_custom_newPtr.asFunction<mlx_closure_custom Function()>();

  int mlx_closure_custom_free(
    mlx_closure_custom cls,
  ) {
    return _mlx_closure_custom_free(
      cls,
    );
  }

  late final _mlx_closure_custom_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_closure_custom)>>(
          'mlx_closure_custom_free');
  late final _mlx_closure_custom_free = _mlx_closure_custom_freePtr
      .asFunction<int Function(mlx_closure_custom)>();

  mlx_closure_custom mlx_closure_custom_new_func(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array, mlx_vector_array, mlx_vector_array)>>
        fun,
  ) {
    return _mlx_closure_custom_new_func(
      fun,
    );
  }

  late final _mlx_closure_custom_new_funcPtr = _lookup<
      ffi.NativeFunction<
          mlx_closure_custom Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          mlx_vector_array,
                          mlx_vector_array)>>)>>('mlx_closure_custom_new_func');
  late final _mlx_closure_custom_new_func =
      _mlx_closure_custom_new_funcPtr.asFunction<
          mlx_closure_custom Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          mlx_vector_array,
                          mlx_vector_array)>>)>();

  mlx_closure_custom mlx_closure_custom_new_func_payload(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array,
                    mlx_vector_array,
                    mlx_vector_array,
                    ffi.Pointer<ffi.Void>)>>
        fun,
    ffi.Pointer<ffi.Void> payload,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_closure_custom_new_func_payload(
      fun,
      payload,
      dtor,
    );
  }

  late final _mlx_closure_custom_new_func_payloadPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure_custom Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(
                              ffi.Pointer<mlx_vector_array>,
                              mlx_vector_array,
                              mlx_vector_array,
                              mlx_vector_array,
                              ffi.Pointer<ffi.Void>)>>,
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_closure_custom_new_func_payload');
  late final _mlx_closure_custom_new_func_payload =
      _mlx_closure_custom_new_func_payloadPtr.asFunction<
          mlx_closure_custom Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          mlx_vector_array,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Void>)>>,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  int mlx_closure_custom_set(
    ffi.Pointer<mlx_closure_custom> cls,
    mlx_closure_custom src,
  ) {
    return _mlx_closure_custom_set(
      cls,
      src,
    );
  }

  late final _mlx_closure_custom_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_closure_custom>,
              mlx_closure_custom)>>('mlx_closure_custom_set');
  late final _mlx_closure_custom_set = _mlx_closure_custom_setPtr.asFunction<
      int Function(ffi.Pointer<mlx_closure_custom>, mlx_closure_custom)>();

  int mlx_closure_custom_apply(
    ffi.Pointer<mlx_vector_array> res,
    mlx_closure_custom cls,
    mlx_vector_array input_0,
    mlx_vector_array input_1,
    mlx_vector_array input_2,
  ) {
    return _mlx_closure_custom_apply(
      res,
      cls,
      input_0,
      input_1,
      input_2,
    );
  }

  late final _mlx_closure_custom_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_closure_custom,
              mlx_vector_array,
              mlx_vector_array,
              mlx_vector_array)>>('mlx_closure_custom_apply');
  late final _mlx_closure_custom_apply =
      _mlx_closure_custom_applyPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_array>, mlx_closure_custom,
              mlx_vector_array, mlx_vector_array, mlx_vector_array)>();

  mlx_closure_custom_jvp mlx_closure_custom_jvp_new() {
    return _mlx_closure_custom_jvp_new();
  }

  late final _mlx_closure_custom_jvp_newPtr =
      _lookup<ffi.NativeFunction<mlx_closure_custom_jvp Function()>>(
          'mlx_closure_custom_jvp_new');
  late final _mlx_closure_custom_jvp_new = _mlx_closure_custom_jvp_newPtr
      .asFunction<mlx_closure_custom_jvp Function()>();

  int mlx_closure_custom_jvp_free(
    mlx_closure_custom_jvp cls,
  ) {
    return _mlx_closure_custom_jvp_free(
      cls,
    );
  }

  late final _mlx_closure_custom_jvp_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_closure_custom_jvp)>>(
          'mlx_closure_custom_jvp_free');
  late final _mlx_closure_custom_jvp_free = _mlx_closure_custom_jvp_freePtr
      .asFunction<int Function(mlx_closure_custom_jvp)>();

  mlx_closure_custom_jvp mlx_closure_custom_jvp_new_func(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array,
                    mlx_vector_array,
                    ffi.Pointer<ffi.Int>,
                    ffi.Size)>>
        fun,
  ) {
    return _mlx_closure_custom_jvp_new_func(
      fun,
    );
  }

  late final _mlx_closure_custom_jvp_new_funcPtr = _lookup<
      ffi.NativeFunction<
          mlx_closure_custom_jvp Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Int>,
                          ffi.Size)>>)>>('mlx_closure_custom_jvp_new_func');
  late final _mlx_closure_custom_jvp_new_func =
      _mlx_closure_custom_jvp_new_funcPtr.asFunction<
          mlx_closure_custom_jvp Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Int>,
                          ffi.Size)>>)>();

  mlx_closure_custom_jvp mlx_closure_custom_jvp_new_func_payload(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>,
                    mlx_vector_array,
                    mlx_vector_array,
                    ffi.Pointer<ffi.Int>,
                    ffi.Size,
                    ffi.Pointer<ffi.Void>)>>
        fun,
    ffi.Pointer<ffi.Void> payload,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_closure_custom_jvp_new_func_payload(
      fun,
      payload,
      dtor,
    );
  }

  late final _mlx_closure_custom_jvp_new_func_payloadPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure_custom_jvp Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(
                              ffi.Pointer<mlx_vector_array>,
                              mlx_vector_array,
                              mlx_vector_array,
                              ffi.Pointer<ffi.Int>,
                              ffi.Size,
                              ffi.Pointer<ffi.Void>)>>,
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_closure_custom_jvp_new_func_payload');
  late final _mlx_closure_custom_jvp_new_func_payload =
      _mlx_closure_custom_jvp_new_func_payloadPtr.asFunction<
          mlx_closure_custom_jvp Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          mlx_vector_array,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Int>,
                          ffi.Size,
                          ffi.Pointer<ffi.Void>)>>,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  int mlx_closure_custom_jvp_set(
    ffi.Pointer<mlx_closure_custom_jvp> cls,
    mlx_closure_custom_jvp src,
  ) {
    return _mlx_closure_custom_jvp_set(
      cls,
      src,
    );
  }

  late final _mlx_closure_custom_jvp_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_closure_custom_jvp>,
              mlx_closure_custom_jvp)>>('mlx_closure_custom_jvp_set');
  late final _mlx_closure_custom_jvp_set =
      _mlx_closure_custom_jvp_setPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_closure_custom_jvp>, mlx_closure_custom_jvp)>();

  int mlx_closure_custom_jvp_apply(
    ffi.Pointer<mlx_vector_array> res,
    mlx_closure_custom_jvp cls,
    mlx_vector_array input_0,
    mlx_vector_array input_1,
    ffi.Pointer<ffi.Int> input_2,
    int input_2_num,
  ) {
    return _mlx_closure_custom_jvp_apply(
      res,
      cls,
      input_0,
      input_1,
      input_2,
      input_2_num,
    );
  }

  late final _mlx_closure_custom_jvp_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_closure_custom_jvp,
              mlx_vector_array,
              mlx_vector_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size)>>('mlx_closure_custom_jvp_apply');
  late final _mlx_closure_custom_jvp_apply =
      _mlx_closure_custom_jvp_applyPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_array>, mlx_closure_custom_jvp,
              mlx_vector_array, mlx_vector_array, ffi.Pointer<ffi.Int>, int)>();

  mlx_closure_custom_vmap mlx_closure_custom_vmap_new() {
    return _mlx_closure_custom_vmap_new();
  }

  late final _mlx_closure_custom_vmap_newPtr =
      _lookup<ffi.NativeFunction<mlx_closure_custom_vmap Function()>>(
          'mlx_closure_custom_vmap_new');
  late final _mlx_closure_custom_vmap_new = _mlx_closure_custom_vmap_newPtr
      .asFunction<mlx_closure_custom_vmap Function()>();

  int mlx_closure_custom_vmap_free(
    mlx_closure_custom_vmap cls,
  ) {
    return _mlx_closure_custom_vmap_free(
      cls,
    );
  }

  late final _mlx_closure_custom_vmap_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_closure_custom_vmap)>>(
          'mlx_closure_custom_vmap_free');
  late final _mlx_closure_custom_vmap_free = _mlx_closure_custom_vmap_freePtr
      .asFunction<int Function(mlx_closure_custom_vmap)>();

  mlx_closure_custom_vmap mlx_closure_custom_vmap_new_func(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>,
                    ffi.Pointer<mlx_vector_int>,
                    mlx_vector_array,
                    ffi.Pointer<ffi.Int>,
                    ffi.Size)>>
        fun,
  ) {
    return _mlx_closure_custom_vmap_new_func(
      fun,
    );
  }

  late final _mlx_closure_custom_vmap_new_funcPtr = _lookup<
      ffi.NativeFunction<
          mlx_closure_custom_vmap Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          ffi.Pointer<mlx_vector_int>,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Int>,
                          ffi.Size)>>)>>('mlx_closure_custom_vmap_new_func');
  late final _mlx_closure_custom_vmap_new_func =
      _mlx_closure_custom_vmap_new_funcPtr.asFunction<
          mlx_closure_custom_vmap Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          ffi.Pointer<mlx_vector_int>,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Int>,
                          ffi.Size)>>)>();

  mlx_closure_custom_vmap mlx_closure_custom_vmap_new_func_payload(
    ffi.Pointer<
            ffi.NativeFunction<
                ffi.Int Function(
                    ffi.Pointer<mlx_vector_array>,
                    ffi.Pointer<mlx_vector_int>,
                    mlx_vector_array,
                    ffi.Pointer<ffi.Int>,
                    ffi.Size,
                    ffi.Pointer<ffi.Void>)>>
        fun,
    ffi.Pointer<ffi.Void> payload,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_closure_custom_vmap_new_func_payload(
      fun,
      payload,
      dtor,
    );
  }

  late final _mlx_closure_custom_vmap_new_func_payloadPtr = _lookup<
          ffi.NativeFunction<
              mlx_closure_custom_vmap Function(
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Int Function(
                              ffi.Pointer<mlx_vector_array>,
                              ffi.Pointer<mlx_vector_int>,
                              mlx_vector_array,
                              ffi.Pointer<ffi.Int>,
                              ffi.Size,
                              ffi.Pointer<ffi.Void>)>>,
                  ffi.Pointer<ffi.Void>,
                  ffi.Pointer<
                      ffi.NativeFunction<
                          ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>>(
      'mlx_closure_custom_vmap_new_func_payload');
  late final _mlx_closure_custom_vmap_new_func_payload =
      _mlx_closure_custom_vmap_new_func_payloadPtr.asFunction<
          mlx_closure_custom_vmap Function(
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Int Function(
                          ffi.Pointer<mlx_vector_array>,
                          ffi.Pointer<mlx_vector_int>,
                          mlx_vector_array,
                          ffi.Pointer<ffi.Int>,
                          ffi.Size,
                          ffi.Pointer<ffi.Void>)>>,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  int mlx_closure_custom_vmap_set(
    ffi.Pointer<mlx_closure_custom_vmap> cls,
    mlx_closure_custom_vmap src,
  ) {
    return _mlx_closure_custom_vmap_set(
      cls,
      src,
    );
  }

  late final _mlx_closure_custom_vmap_setPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_closure_custom_vmap>,
              mlx_closure_custom_vmap)>>('mlx_closure_custom_vmap_set');
  late final _mlx_closure_custom_vmap_set =
      _mlx_closure_custom_vmap_setPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_closure_custom_vmap>, mlx_closure_custom_vmap)>();

  int mlx_closure_custom_vmap_apply(
    ffi.Pointer<mlx_vector_array> res_0,
    ffi.Pointer<mlx_vector_int> res_1,
    mlx_closure_custom_vmap cls,
    mlx_vector_array input_0,
    ffi.Pointer<ffi.Int> input_1,
    int input_1_num,
  ) {
    return _mlx_closure_custom_vmap_apply(
      res_0,
      res_1,
      cls,
      input_0,
      input_1,
      input_1_num,
    );
  }

  late final _mlx_closure_custom_vmap_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_vector_int>,
              mlx_closure_custom_vmap,
              mlx_vector_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size)>>('mlx_closure_custom_vmap_apply');
  late final _mlx_closure_custom_vmap_apply =
      _mlx_closure_custom_vmap_applyPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_vector_int>,
              mlx_closure_custom_vmap,
              mlx_vector_array,
              ffi.Pointer<ffi.Int>,
              int)>();

  /// Get the rank.
  int mlx_distributed_group_rank(
    mlx_distributed_group group,
  ) {
    return _mlx_distributed_group_rank(
      group,
    );
  }

  late final _mlx_distributed_group_rankPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_distributed_group)>>(
          'mlx_distributed_group_rank');
  late final _mlx_distributed_group_rank = _mlx_distributed_group_rankPtr
      .asFunction<int Function(mlx_distributed_group)>();

  /// Get the group size.
  int mlx_distributed_group_size(
    mlx_distributed_group group,
  ) {
    return _mlx_distributed_group_size(
      group,
    );
  }

  late final _mlx_distributed_group_sizePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_distributed_group)>>(
          'mlx_distributed_group_size');
  late final _mlx_distributed_group_size = _mlx_distributed_group_sizePtr
      .asFunction<int Function(mlx_distributed_group)>();

  /// Split the group.
  mlx_distributed_group mlx_distributed_group_split(
    mlx_distributed_group group,
    int color,
    int key,
  ) {
    return _mlx_distributed_group_split(
      group,
      color,
      key,
    );
  }

  late final _mlx_distributed_group_splitPtr = _lookup<
      ffi.NativeFunction<
          mlx_distributed_group Function(mlx_distributed_group, ffi.Int,
              ffi.Int)>>('mlx_distributed_group_split');
  late final _mlx_distributed_group_split =
      _mlx_distributed_group_splitPtr.asFunction<
          mlx_distributed_group Function(mlx_distributed_group, int, int)>();

  /// Check if distributed is available.
  bool mlx_distributed_is_available() {
    return _mlx_distributed_is_available();
  }

  late final _mlx_distributed_is_availablePtr =
      _lookup<ffi.NativeFunction<ffi.Bool Function()>>(
          'mlx_distributed_is_available');
  late final _mlx_distributed_is_available =
      _mlx_distributed_is_availablePtr.asFunction<bool Function()>();

  /// Initialize distributed.
  mlx_distributed_group mlx_distributed_init(
    bool strict,
  ) {
    return _mlx_distributed_init(
      strict,
    );
  }

  late final _mlx_distributed_initPtr =
      _lookup<ffi.NativeFunction<mlx_distributed_group Function(ffi.Bool)>>(
          'mlx_distributed_init');
  late final _mlx_distributed_init = _mlx_distributed_initPtr
      .asFunction<mlx_distributed_group Function(bool)>();

  /// Returns a new custom IO reader.
  /// `vtable` operates on user descriptor `desc`.
  mlx_io_reader mlx_io_reader_new(
    ffi.Pointer<ffi.Void> desc,
    mlx_io_vtable vtable,
  ) {
    return _mlx_io_reader_new(
      desc,
      vtable,
    );
  }

  late final _mlx_io_reader_newPtr = _lookup<
      ffi.NativeFunction<
          mlx_io_reader Function(
              ffi.Pointer<ffi.Void>, mlx_io_vtable)>>('mlx_io_reader_new');
  late final _mlx_io_reader_new = _mlx_io_reader_newPtr.asFunction<
      mlx_io_reader Function(ffi.Pointer<ffi.Void>, mlx_io_vtable)>();

  /// Get IO reader user descriptor.
  int mlx_io_reader_descriptor(
    ffi.Pointer<ffi.Pointer<ffi.Void>> desc_,
    mlx_io_reader io,
  ) {
    return _mlx_io_reader_descriptor(
      desc_,
      io,
    );
  }

  late final _mlx_io_reader_descriptorPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Pointer<ffi.Void>>,
              mlx_io_reader)>>('mlx_io_reader_descriptor');
  late final _mlx_io_reader_descriptor =
      _mlx_io_reader_descriptorPtr.asFunction<
          int Function(ffi.Pointer<ffi.Pointer<ffi.Void>>, mlx_io_reader)>();

  /// Get IO reader description.
  int mlx_io_reader_tostring(
    ffi.Pointer<mlx_string> str_,
    mlx_io_reader io,
  ) {
    return _mlx_io_reader_tostring(
      str_,
      io,
    );
  }

  late final _mlx_io_reader_tostringPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_string>,
              mlx_io_reader)>>('mlx_io_reader_tostring');
  late final _mlx_io_reader_tostring = _mlx_io_reader_tostringPtr
      .asFunction<int Function(ffi.Pointer<mlx_string>, mlx_io_reader)>();

  /// Free IO reader.
  ///
  /// Note that MLX arrays are lazily evaluated, so the underlying object may
  /// be not freed right away. The ``free()`` callback from ``mlx_io_vtable``
  /// will be called when the underlying object is actually freed.
  int mlx_io_reader_free(
    mlx_io_reader io,
  ) {
    return _mlx_io_reader_free(
      io,
    );
  }

  late final _mlx_io_reader_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_io_reader)>>(
          'mlx_io_reader_free');
  late final _mlx_io_reader_free =
      _mlx_io_reader_freePtr.asFunction<int Function(mlx_io_reader)>();

  /// Returns a new custom IO writer.
  /// `vtable` operates on user descriptor `desc`.
  mlx_io_writer mlx_io_writer_new(
    ffi.Pointer<ffi.Void> desc,
    mlx_io_vtable vtable,
  ) {
    return _mlx_io_writer_new(
      desc,
      vtable,
    );
  }

  late final _mlx_io_writer_newPtr = _lookup<
      ffi.NativeFunction<
          mlx_io_writer Function(
              ffi.Pointer<ffi.Void>, mlx_io_vtable)>>('mlx_io_writer_new');
  late final _mlx_io_writer_new = _mlx_io_writer_newPtr.asFunction<
      mlx_io_writer Function(ffi.Pointer<ffi.Void>, mlx_io_vtable)>();

  /// Get IO writer user descriptor.
  int mlx_io_writer_descriptor(
    ffi.Pointer<ffi.Pointer<ffi.Void>> desc_,
    mlx_io_writer io,
  ) {
    return _mlx_io_writer_descriptor(
      desc_,
      io,
    );
  }

  late final _mlx_io_writer_descriptorPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Pointer<ffi.Void>>,
              mlx_io_writer)>>('mlx_io_writer_descriptor');
  late final _mlx_io_writer_descriptor =
      _mlx_io_writer_descriptorPtr.asFunction<
          int Function(ffi.Pointer<ffi.Pointer<ffi.Void>>, mlx_io_writer)>();

  /// Get IO writer description.
  int mlx_io_writer_tostring(
    ffi.Pointer<mlx_string> str_,
    mlx_io_writer io,
  ) {
    return _mlx_io_writer_tostring(
      str_,
      io,
    );
  }

  late final _mlx_io_writer_tostringPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_string>,
              mlx_io_writer)>>('mlx_io_writer_tostring');
  late final _mlx_io_writer_tostring = _mlx_io_writer_tostringPtr
      .asFunction<int Function(ffi.Pointer<mlx_string>, mlx_io_writer)>();

  /// Free IO writer.
  ///
  /// Note that MLX arrays are lazily evaluated, so the underlying object may
  /// be not freed right away. The ``free()`` callback from ``mlx_io_vtable``
  /// will be called when the underlying object is actually freed.
  int mlx_io_writer_free(
    mlx_io_writer io,
  ) {
    return _mlx_io_writer_free(
      io,
    );
  }

  late final _mlx_io_writer_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_io_writer)>>(
          'mlx_io_writer_free');
  late final _mlx_io_writer_free =
      _mlx_io_writer_freePtr.asFunction<int Function(mlx_io_writer)>();

  int mlx_compile(
    ffi.Pointer<mlx_closure> res,
    mlx_closure fun,
    bool shapeless,
  ) {
    return _mlx_compile(
      res,
      fun,
      shapeless,
    );
  }

  late final _mlx_compilePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_closure>, mlx_closure, ffi.Bool)>>('mlx_compile');
  late final _mlx_compile = _mlx_compilePtr
      .asFunction<int Function(ffi.Pointer<mlx_closure>, mlx_closure, bool)>();

  int mlx_detail_compile(
    ffi.Pointer<mlx_closure> res,
    mlx_closure fun,
    int fun_id,
    bool shapeless,
    ffi.Pointer<ffi.Uint64> constants,
    int constants_num,
  ) {
    return _mlx_detail_compile(
      res,
      fun,
      fun_id,
      shapeless,
      constants,
      constants_num,
    );
  }

  late final _mlx_detail_compilePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_closure>,
              mlx_closure,
              ffi.UintPtr,
              ffi.Bool,
              ffi.Pointer<ffi.Uint64>,
              ffi.Size)>>('mlx_detail_compile');
  late final _mlx_detail_compile = _mlx_detail_compilePtr.asFunction<
      int Function(ffi.Pointer<mlx_closure>, mlx_closure, int, bool,
          ffi.Pointer<ffi.Uint64>, int)>();

  int mlx_detail_compile_clear_cache() {
    return _mlx_detail_compile_clear_cache();
  }

  late final _mlx_detail_compile_clear_cachePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function()>>(
          'mlx_detail_compile_clear_cache');
  late final _mlx_detail_compile_clear_cache =
      _mlx_detail_compile_clear_cachePtr.asFunction<int Function()>();

  int mlx_detail_compile_erase(
    int fun_id,
  ) {
    return _mlx_detail_compile_erase(
      fun_id,
    );
  }

  late final _mlx_detail_compile_erasePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.UintPtr)>>(
          'mlx_detail_compile_erase');
  late final _mlx_detail_compile_erase =
      _mlx_detail_compile_erasePtr.asFunction<int Function(int)>();

  int mlx_disable_compile() {
    return _mlx_disable_compile();
  }

  late final _mlx_disable_compilePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function()>>('mlx_disable_compile');
  late final _mlx_disable_compile =
      _mlx_disable_compilePtr.asFunction<int Function()>();

  int mlx_enable_compile() {
    return _mlx_enable_compile();
  }

  late final _mlx_enable_compilePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function()>>('mlx_enable_compile');
  late final _mlx_enable_compile =
      _mlx_enable_compilePtr.asFunction<int Function()>();

  int mlx_set_compile_mode(
    mlx_compile_mode_ mode,
  ) {
    return _mlx_set_compile_mode(
      mode.value,
    );
  }

  late final _mlx_set_compile_modePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.UnsignedInt)>>(
          'mlx_set_compile_mode');
  late final _mlx_set_compile_mode =
      _mlx_set_compile_modePtr.asFunction<int Function(int)>();

  /// \defgroup cuda Cuda specific operations
  /// /
  /// /**@{
  int mlx_cuda_is_available(
    ffi.Pointer<ffi.Bool> res,
  ) {
    return _mlx_cuda_is_available(
      res,
    );
  }

  late final _mlx_cuda_is_availablePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Bool>)>>(
          'mlx_cuda_is_available');
  late final _mlx_cuda_is_available = _mlx_cuda_is_availablePtr
      .asFunction<int Function(ffi.Pointer<ffi.Bool>)>();

  /// \defgroup distributed Distributed collectives
  /// /
  /// /**@{
  int mlx_distributed_all_gather(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_distributed_group group,
    mlx_stream S,
  ) {
    return _mlx_distributed_all_gather(
      res,
      x,
      group,
      S,
    );
  }

  late final _mlx_distributed_all_gatherPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_distributed_group,
              mlx_stream)>>('mlx_distributed_all_gather');
  late final _mlx_distributed_all_gather =
      _mlx_distributed_all_gatherPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_distributed_group,
              mlx_stream)>();

  int mlx_distributed_all_max(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_distributed_group group,
    mlx_stream s,
  ) {
    return _mlx_distributed_all_max(
      res,
      x,
      group,
      s,
    );
  }

  late final _mlx_distributed_all_maxPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_distributed_group, mlx_stream)>>('mlx_distributed_all_max');
  late final _mlx_distributed_all_max = _mlx_distributed_all_maxPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_distributed_group,
          mlx_stream)>();

  int mlx_distributed_all_min(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_distributed_group group,
    mlx_stream s,
  ) {
    return _mlx_distributed_all_min(
      res,
      x,
      group,
      s,
    );
  }

  late final _mlx_distributed_all_minPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_distributed_group, mlx_stream)>>('mlx_distributed_all_min');
  late final _mlx_distributed_all_min = _mlx_distributed_all_minPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_distributed_group,
          mlx_stream)>();

  int mlx_distributed_all_sum(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_distributed_group group,
    mlx_stream s,
  ) {
    return _mlx_distributed_all_sum(
      res,
      x,
      group,
      s,
    );
  }

  late final _mlx_distributed_all_sumPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_distributed_group, mlx_stream)>>('mlx_distributed_all_sum');
  late final _mlx_distributed_all_sum = _mlx_distributed_all_sumPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_distributed_group,
          mlx_stream)>();

  int mlx_distributed_recv(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    int src,
    mlx_distributed_group group,
    mlx_stream s,
  ) {
    return _mlx_distributed_recv(
      res,
      shape,
      shape_num,
      dtype.value,
      src,
      group,
      s,
    );
  }

  late final _mlx_distributed_recvPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              ffi.Int,
              mlx_distributed_group,
              mlx_stream)>>('mlx_distributed_recv');
  late final _mlx_distributed_recv = _mlx_distributed_recvPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int, int,
          mlx_distributed_group, mlx_stream)>();

  int mlx_distributed_recv_like(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    int src,
    mlx_distributed_group group,
    mlx_stream s,
  ) {
    return _mlx_distributed_recv_like(
      res,
      x,
      src,
      group,
      s,
    );
  }

  late final _mlx_distributed_recv_likePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_distributed_group, mlx_stream)>>('mlx_distributed_recv_like');
  late final _mlx_distributed_recv_like =
      _mlx_distributed_recv_likePtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, int,
              mlx_distributed_group, mlx_stream)>();

  int mlx_distributed_send(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    int dst,
    mlx_distributed_group group,
    mlx_stream s,
  ) {
    return _mlx_distributed_send(
      res,
      x,
      dst,
      group,
      s,
    );
  }

  late final _mlx_distributed_sendPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_distributed_group, mlx_stream)>>('mlx_distributed_send');
  late final _mlx_distributed_send = _mlx_distributed_sendPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int,
          mlx_distributed_group, mlx_stream)>();

  int mlx_distributed_sum_scatter(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_distributed_group group,
    mlx_stream s,
  ) {
    return _mlx_distributed_sum_scatter(
      res,
      x,
      group,
      s,
    );
  }

  late final _mlx_distributed_sum_scatterPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_distributed_group,
              mlx_stream)>>('mlx_distributed_sum_scatter');
  late final _mlx_distributed_sum_scatter =
      _mlx_distributed_sum_scatterPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_distributed_group,
              mlx_stream)>();

  /// Set the error handler.
  void mlx_set_error_handler(
    mlx_error_handler_func handler,
    ffi.Pointer<ffi.Void> data,
    ffi.Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
        dtor,
  ) {
    return _mlx_set_error_handler(
      handler,
      data,
      dtor,
    );
  }

  late final _mlx_set_error_handlerPtr = _lookup<
      ffi.NativeFunction<
          ffi.Void Function(
              mlx_error_handler_func,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<
                  ffi.NativeFunction<
                      ffi.Void Function(
                          ffi.Pointer<ffi.Void>)>>)>>('mlx_set_error_handler');
  late final _mlx_set_error_handler = _mlx_set_error_handlerPtr.asFunction<
      void Function(
          mlx_error_handler_func,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<
              ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>)>();

  /// \defgroup export Function serialization
  /// /
  /// /**@{
  int mlx_export_function(
    ffi.Pointer<ffi.Char> file,
    mlx_closure fun,
    mlx_vector_array args,
    bool shapeless,
  ) {
    return _mlx_export_function(
      file,
      fun,
      args,
      shapeless,
    );
  }

  late final _mlx_export_functionPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Char>, mlx_closure, mlx_vector_array,
              ffi.Bool)>>('mlx_export_function');
  late final _mlx_export_function = _mlx_export_functionPtr.asFunction<
      int Function(
          ffi.Pointer<ffi.Char>, mlx_closure, mlx_vector_array, bool)>();

  int mlx_export_function_kwargs(
    ffi.Pointer<ffi.Char> file,
    mlx_closure_kwargs fun,
    mlx_vector_array args,
    mlx_map_string_to_array kwargs,
    bool shapeless,
  ) {
    return _mlx_export_function_kwargs(
      file,
      fun,
      args,
      kwargs,
      shapeless,
    );
  }

  late final _mlx_export_function_kwargsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<ffi.Char>,
              mlx_closure_kwargs,
              mlx_vector_array,
              mlx_map_string_to_array,
              ffi.Bool)>>('mlx_export_function_kwargs');
  late final _mlx_export_function_kwargs =
      _mlx_export_function_kwargsPtr.asFunction<
          int Function(ffi.Pointer<ffi.Char>, mlx_closure_kwargs,
              mlx_vector_array, mlx_map_string_to_array, bool)>();

  mlx_function_exporter mlx_function_exporter_new(
    ffi.Pointer<ffi.Char> file,
    mlx_closure fun,
    bool shapeless,
  ) {
    return _mlx_function_exporter_new(
      file,
      fun,
      shapeless,
    );
  }

  late final _mlx_function_exporter_newPtr = _lookup<
      ffi.NativeFunction<
          mlx_function_exporter Function(ffi.Pointer<ffi.Char>, mlx_closure,
              ffi.Bool)>>('mlx_function_exporter_new');
  late final _mlx_function_exporter_new =
      _mlx_function_exporter_newPtr.asFunction<
          mlx_function_exporter Function(
              ffi.Pointer<ffi.Char>, mlx_closure, bool)>();

  int mlx_function_exporter_free(
    mlx_function_exporter xfunc,
  ) {
    return _mlx_function_exporter_free(
      xfunc,
    );
  }

  late final _mlx_function_exporter_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_function_exporter)>>(
          'mlx_function_exporter_free');
  late final _mlx_function_exporter_free = _mlx_function_exporter_freePtr
      .asFunction<int Function(mlx_function_exporter)>();

  int mlx_function_exporter_apply(
    mlx_function_exporter xfunc,
    mlx_vector_array args,
  ) {
    return _mlx_function_exporter_apply(
      xfunc,
      args,
    );
  }

  late final _mlx_function_exporter_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_function_exporter,
              mlx_vector_array)>>('mlx_function_exporter_apply');
  late final _mlx_function_exporter_apply = _mlx_function_exporter_applyPtr
      .asFunction<int Function(mlx_function_exporter, mlx_vector_array)>();

  int mlx_function_exporter_apply_kwargs(
    mlx_function_exporter xfunc,
    mlx_vector_array args,
    mlx_map_string_to_array kwargs,
  ) {
    return _mlx_function_exporter_apply_kwargs(
      xfunc,
      args,
      kwargs,
    );
  }

  late final _mlx_function_exporter_apply_kwargsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_function_exporter, mlx_vector_array,
              mlx_map_string_to_array)>>('mlx_function_exporter_apply_kwargs');
  late final _mlx_function_exporter_apply_kwargs =
      _mlx_function_exporter_apply_kwargsPtr.asFunction<
          int Function(mlx_function_exporter, mlx_vector_array,
              mlx_map_string_to_array)>();

  mlx_imported_function mlx_imported_function_new(
    ffi.Pointer<ffi.Char> file,
  ) {
    return _mlx_imported_function_new(
      file,
    );
  }

  late final _mlx_imported_function_newPtr = _lookup<
      ffi.NativeFunction<
          mlx_imported_function Function(
              ffi.Pointer<ffi.Char>)>>('mlx_imported_function_new');
  late final _mlx_imported_function_new = _mlx_imported_function_newPtr
      .asFunction<mlx_imported_function Function(ffi.Pointer<ffi.Char>)>();

  int mlx_imported_function_free(
    mlx_imported_function xfunc,
  ) {
    return _mlx_imported_function_free(
      xfunc,
    );
  }

  late final _mlx_imported_function_freePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_imported_function)>>(
          'mlx_imported_function_free');
  late final _mlx_imported_function_free = _mlx_imported_function_freePtr
      .asFunction<int Function(mlx_imported_function)>();

  int mlx_imported_function_apply(
    ffi.Pointer<mlx_vector_array> res,
    mlx_imported_function xfunc,
    mlx_vector_array args,
  ) {
    return _mlx_imported_function_apply(
      res,
      xfunc,
      args,
    );
  }

  late final _mlx_imported_function_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_imported_function,
              mlx_vector_array)>>('mlx_imported_function_apply');
  late final _mlx_imported_function_apply =
      _mlx_imported_function_applyPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_array>, mlx_imported_function,
              mlx_vector_array)>();

  int mlx_imported_function_apply_kwargs(
    ffi.Pointer<mlx_vector_array> res,
    mlx_imported_function xfunc,
    mlx_vector_array args,
    mlx_map_string_to_array kwargs,
  ) {
    return _mlx_imported_function_apply_kwargs(
      res,
      xfunc,
      args,
      kwargs,
    );
  }

  late final _mlx_imported_function_apply_kwargsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_imported_function,
              mlx_vector_array,
              mlx_map_string_to_array)>>('mlx_imported_function_apply_kwargs');
  late final _mlx_imported_function_apply_kwargs =
      _mlx_imported_function_apply_kwargsPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_array>, mlx_imported_function,
              mlx_vector_array, mlx_map_string_to_array)>();

  mlx_fast_cuda_kernel_config mlx_fast_cuda_kernel_config_new() {
    return _mlx_fast_cuda_kernel_config_new();
  }

  late final _mlx_fast_cuda_kernel_config_newPtr =
      _lookup<ffi.NativeFunction<mlx_fast_cuda_kernel_config Function()>>(
          'mlx_fast_cuda_kernel_config_new');
  late final _mlx_fast_cuda_kernel_config_new =
      _mlx_fast_cuda_kernel_config_newPtr
          .asFunction<mlx_fast_cuda_kernel_config Function()>();

  void mlx_fast_cuda_kernel_config_free(
    mlx_fast_cuda_kernel_config cls,
  ) {
    return _mlx_fast_cuda_kernel_config_free(
      cls,
    );
  }

  late final _mlx_fast_cuda_kernel_config_freePtr = _lookup<
          ffi.NativeFunction<ffi.Void Function(mlx_fast_cuda_kernel_config)>>(
      'mlx_fast_cuda_kernel_config_free');
  late final _mlx_fast_cuda_kernel_config_free =
      _mlx_fast_cuda_kernel_config_freePtr
          .asFunction<void Function(mlx_fast_cuda_kernel_config)>();

  int mlx_fast_cuda_kernel_config_add_output_arg(
    mlx_fast_cuda_kernel_config cls,
    ffi.Pointer<ffi.Int> shape,
    int size,
    mlx_dtype_ dtype,
  ) {
    return _mlx_fast_cuda_kernel_config_add_output_arg(
      cls,
      shape,
      size,
      dtype.value,
    );
  }

  late final _mlx_fast_cuda_kernel_config_add_output_argPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              mlx_fast_cuda_kernel_config,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt)>>('mlx_fast_cuda_kernel_config_add_output_arg');
  late final _mlx_fast_cuda_kernel_config_add_output_arg =
      _mlx_fast_cuda_kernel_config_add_output_argPtr.asFunction<
          int Function(
              mlx_fast_cuda_kernel_config, ffi.Pointer<ffi.Int>, int, int)>();

  int mlx_fast_cuda_kernel_config_set_grid(
    mlx_fast_cuda_kernel_config cls,
    int grid1,
    int grid2,
    int grid3,
  ) {
    return _mlx_fast_cuda_kernel_config_set_grid(
      cls,
      grid1,
      grid2,
      grid3,
    );
  }

  late final _mlx_fast_cuda_kernel_config_set_gridPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_cuda_kernel_config, ffi.Int, ffi.Int,
              ffi.Int)>>('mlx_fast_cuda_kernel_config_set_grid');
  late final _mlx_fast_cuda_kernel_config_set_grid =
      _mlx_fast_cuda_kernel_config_set_gridPtr.asFunction<
          int Function(mlx_fast_cuda_kernel_config, int, int, int)>();

  int mlx_fast_cuda_kernel_config_set_thread_group(
    mlx_fast_cuda_kernel_config cls,
    int thread1,
    int thread2,
    int thread3,
  ) {
    return _mlx_fast_cuda_kernel_config_set_thread_group(
      cls,
      thread1,
      thread2,
      thread3,
    );
  }

  late final _mlx_fast_cuda_kernel_config_set_thread_groupPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_cuda_kernel_config, ffi.Int, ffi.Int,
              ffi.Int)>>('mlx_fast_cuda_kernel_config_set_thread_group');
  late final _mlx_fast_cuda_kernel_config_set_thread_group =
      _mlx_fast_cuda_kernel_config_set_thread_groupPtr.asFunction<
          int Function(mlx_fast_cuda_kernel_config, int, int, int)>();

  int mlx_fast_cuda_kernel_config_set_init_value(
    mlx_fast_cuda_kernel_config cls,
    double value,
  ) {
    return _mlx_fast_cuda_kernel_config_set_init_value(
      cls,
      value,
    );
  }

  late final _mlx_fast_cuda_kernel_config_set_init_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_cuda_kernel_config,
              ffi.Float)>>('mlx_fast_cuda_kernel_config_set_init_value');
  late final _mlx_fast_cuda_kernel_config_set_init_value =
      _mlx_fast_cuda_kernel_config_set_init_valuePtr
          .asFunction<int Function(mlx_fast_cuda_kernel_config, double)>();

  int mlx_fast_cuda_kernel_config_set_verbose(
    mlx_fast_cuda_kernel_config cls,
    bool verbose,
  ) {
    return _mlx_fast_cuda_kernel_config_set_verbose(
      cls,
      verbose,
    );
  }

  late final _mlx_fast_cuda_kernel_config_set_verbosePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_cuda_kernel_config,
              ffi.Bool)>>('mlx_fast_cuda_kernel_config_set_verbose');
  late final _mlx_fast_cuda_kernel_config_set_verbose =
      _mlx_fast_cuda_kernel_config_set_verbosePtr
          .asFunction<int Function(mlx_fast_cuda_kernel_config, bool)>();

  int mlx_fast_cuda_kernel_config_add_template_arg_dtype(
    mlx_fast_cuda_kernel_config cls,
    ffi.Pointer<ffi.Char> name,
    mlx_dtype_ dtype,
  ) {
    return _mlx_fast_cuda_kernel_config_add_template_arg_dtype(
      cls,
      name,
      dtype.value,
    );
  }

  late final _mlx_fast_cuda_kernel_config_add_template_arg_dtypePtr = _lookup<
          ffi.NativeFunction<
              ffi.Int Function(mlx_fast_cuda_kernel_config,
                  ffi.Pointer<ffi.Char>, ffi.UnsignedInt)>>(
      'mlx_fast_cuda_kernel_config_add_template_arg_dtype');
  late final _mlx_fast_cuda_kernel_config_add_template_arg_dtype =
      _mlx_fast_cuda_kernel_config_add_template_arg_dtypePtr.asFunction<
          int Function(
              mlx_fast_cuda_kernel_config, ffi.Pointer<ffi.Char>, int)>();

  int mlx_fast_cuda_kernel_config_add_template_arg_int(
    mlx_fast_cuda_kernel_config cls,
    ffi.Pointer<ffi.Char> name,
    int value,
  ) {
    return _mlx_fast_cuda_kernel_config_add_template_arg_int(
      cls,
      name,
      value,
    );
  }

  late final _mlx_fast_cuda_kernel_config_add_template_arg_intPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_cuda_kernel_config, ffi.Pointer<ffi.Char>,
              ffi.Int)>>('mlx_fast_cuda_kernel_config_add_template_arg_int');
  late final _mlx_fast_cuda_kernel_config_add_template_arg_int =
      _mlx_fast_cuda_kernel_config_add_template_arg_intPtr.asFunction<
          int Function(
              mlx_fast_cuda_kernel_config, ffi.Pointer<ffi.Char>, int)>();

  int mlx_fast_cuda_kernel_config_add_template_arg_bool(
    mlx_fast_cuda_kernel_config cls,
    ffi.Pointer<ffi.Char> name,
    bool value,
  ) {
    return _mlx_fast_cuda_kernel_config_add_template_arg_bool(
      cls,
      name,
      value,
    );
  }

  late final _mlx_fast_cuda_kernel_config_add_template_arg_boolPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_cuda_kernel_config, ffi.Pointer<ffi.Char>,
              ffi.Bool)>>('mlx_fast_cuda_kernel_config_add_template_arg_bool');
  late final _mlx_fast_cuda_kernel_config_add_template_arg_bool =
      _mlx_fast_cuda_kernel_config_add_template_arg_boolPtr.asFunction<
          int Function(
              mlx_fast_cuda_kernel_config, ffi.Pointer<ffi.Char>, bool)>();

  mlx_fast_cuda_kernel mlx_fast_cuda_kernel_new(
    ffi.Pointer<ffi.Char> name,
    mlx_vector_string input_names,
    mlx_vector_string output_names,
    ffi.Pointer<ffi.Char> source,
    ffi.Pointer<ffi.Char> header,
    bool ensure_row_contiguous,
    int shared_memory,
  ) {
    return _mlx_fast_cuda_kernel_new(
      name,
      input_names,
      output_names,
      source,
      header,
      ensure_row_contiguous,
      shared_memory,
    );
  }

  late final _mlx_fast_cuda_kernel_newPtr = _lookup<
      ffi.NativeFunction<
          mlx_fast_cuda_kernel Function(
              ffi.Pointer<ffi.Char>,
              mlx_vector_string,
              mlx_vector_string,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              ffi.Bool,
              ffi.Int)>>('mlx_fast_cuda_kernel_new');
  late final _mlx_fast_cuda_kernel_new =
      _mlx_fast_cuda_kernel_newPtr.asFunction<
          mlx_fast_cuda_kernel Function(
              ffi.Pointer<ffi.Char>,
              mlx_vector_string,
              mlx_vector_string,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              bool,
              int)>();

  void mlx_fast_cuda_kernel_free(
    mlx_fast_cuda_kernel cls,
  ) {
    return _mlx_fast_cuda_kernel_free(
      cls,
    );
  }

  late final _mlx_fast_cuda_kernel_freePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(mlx_fast_cuda_kernel)>>(
          'mlx_fast_cuda_kernel_free');
  late final _mlx_fast_cuda_kernel_free = _mlx_fast_cuda_kernel_freePtr
      .asFunction<void Function(mlx_fast_cuda_kernel)>();

  int mlx_fast_cuda_kernel_apply(
    ffi.Pointer<mlx_vector_array> outputs,
    mlx_fast_cuda_kernel cls,
    mlx_vector_array inputs,
    mlx_fast_cuda_kernel_config config,
    mlx_stream stream,
  ) {
    return _mlx_fast_cuda_kernel_apply(
      outputs,
      cls,
      inputs,
      config,
      stream,
    );
  }

  late final _mlx_fast_cuda_kernel_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_fast_cuda_kernel,
              mlx_vector_array,
              mlx_fast_cuda_kernel_config,
              mlx_stream)>>('mlx_fast_cuda_kernel_apply');
  late final _mlx_fast_cuda_kernel_apply =
      _mlx_fast_cuda_kernel_applyPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_array>, mlx_fast_cuda_kernel,
              mlx_vector_array, mlx_fast_cuda_kernel_config, mlx_stream)>();

  int mlx_fast_layer_norm(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_array weight,
    mlx_array bias,
    double eps,
    mlx_stream s,
  ) {
    return _mlx_fast_layer_norm(
      res,
      x,
      weight,
      bias,
      eps,
      s,
    );
  }

  late final _mlx_fast_layer_normPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Float, mlx_stream)>>('mlx_fast_layer_norm');
  late final _mlx_fast_layer_norm = _mlx_fast_layer_normPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
          double, mlx_stream)>();

  mlx_fast_metal_kernel_config mlx_fast_metal_kernel_config_new() {
    return _mlx_fast_metal_kernel_config_new();
  }

  late final _mlx_fast_metal_kernel_config_newPtr =
      _lookup<ffi.NativeFunction<mlx_fast_metal_kernel_config Function()>>(
          'mlx_fast_metal_kernel_config_new');
  late final _mlx_fast_metal_kernel_config_new =
      _mlx_fast_metal_kernel_config_newPtr
          .asFunction<mlx_fast_metal_kernel_config Function()>();

  void mlx_fast_metal_kernel_config_free(
    mlx_fast_metal_kernel_config cls,
  ) {
    return _mlx_fast_metal_kernel_config_free(
      cls,
    );
  }

  late final _mlx_fast_metal_kernel_config_freePtr = _lookup<
          ffi.NativeFunction<ffi.Void Function(mlx_fast_metal_kernel_config)>>(
      'mlx_fast_metal_kernel_config_free');
  late final _mlx_fast_metal_kernel_config_free =
      _mlx_fast_metal_kernel_config_freePtr
          .asFunction<void Function(mlx_fast_metal_kernel_config)>();

  int mlx_fast_metal_kernel_config_add_output_arg(
    mlx_fast_metal_kernel_config cls,
    ffi.Pointer<ffi.Int> shape,
    int size,
    mlx_dtype_ dtype,
  ) {
    return _mlx_fast_metal_kernel_config_add_output_arg(
      cls,
      shape,
      size,
      dtype.value,
    );
  }

  late final _mlx_fast_metal_kernel_config_add_output_argPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              mlx_fast_metal_kernel_config,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt)>>('mlx_fast_metal_kernel_config_add_output_arg');
  late final _mlx_fast_metal_kernel_config_add_output_arg =
      _mlx_fast_metal_kernel_config_add_output_argPtr.asFunction<
          int Function(
              mlx_fast_metal_kernel_config, ffi.Pointer<ffi.Int>, int, int)>();

  int mlx_fast_metal_kernel_config_set_grid(
    mlx_fast_metal_kernel_config cls,
    int grid1,
    int grid2,
    int grid3,
  ) {
    return _mlx_fast_metal_kernel_config_set_grid(
      cls,
      grid1,
      grid2,
      grid3,
    );
  }

  late final _mlx_fast_metal_kernel_config_set_gridPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_metal_kernel_config, ffi.Int, ffi.Int,
              ffi.Int)>>('mlx_fast_metal_kernel_config_set_grid');
  late final _mlx_fast_metal_kernel_config_set_grid =
      _mlx_fast_metal_kernel_config_set_gridPtr.asFunction<
          int Function(mlx_fast_metal_kernel_config, int, int, int)>();

  int mlx_fast_metal_kernel_config_set_thread_group(
    mlx_fast_metal_kernel_config cls,
    int thread1,
    int thread2,
    int thread3,
  ) {
    return _mlx_fast_metal_kernel_config_set_thread_group(
      cls,
      thread1,
      thread2,
      thread3,
    );
  }

  late final _mlx_fast_metal_kernel_config_set_thread_groupPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_metal_kernel_config, ffi.Int, ffi.Int,
              ffi.Int)>>('mlx_fast_metal_kernel_config_set_thread_group');
  late final _mlx_fast_metal_kernel_config_set_thread_group =
      _mlx_fast_metal_kernel_config_set_thread_groupPtr.asFunction<
          int Function(mlx_fast_metal_kernel_config, int, int, int)>();

  int mlx_fast_metal_kernel_config_set_init_value(
    mlx_fast_metal_kernel_config cls,
    double value,
  ) {
    return _mlx_fast_metal_kernel_config_set_init_value(
      cls,
      value,
    );
  }

  late final _mlx_fast_metal_kernel_config_set_init_valuePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_metal_kernel_config,
              ffi.Float)>>('mlx_fast_metal_kernel_config_set_init_value');
  late final _mlx_fast_metal_kernel_config_set_init_value =
      _mlx_fast_metal_kernel_config_set_init_valuePtr
          .asFunction<int Function(mlx_fast_metal_kernel_config, double)>();

  int mlx_fast_metal_kernel_config_set_verbose(
    mlx_fast_metal_kernel_config cls,
    bool verbose,
  ) {
    return _mlx_fast_metal_kernel_config_set_verbose(
      cls,
      verbose,
    );
  }

  late final _mlx_fast_metal_kernel_config_set_verbosePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_metal_kernel_config,
              ffi.Bool)>>('mlx_fast_metal_kernel_config_set_verbose');
  late final _mlx_fast_metal_kernel_config_set_verbose =
      _mlx_fast_metal_kernel_config_set_verbosePtr
          .asFunction<int Function(mlx_fast_metal_kernel_config, bool)>();

  int mlx_fast_metal_kernel_config_add_template_arg_dtype(
    mlx_fast_metal_kernel_config cls,
    ffi.Pointer<ffi.Char> name,
    mlx_dtype_ dtype,
  ) {
    return _mlx_fast_metal_kernel_config_add_template_arg_dtype(
      cls,
      name,
      dtype.value,
    );
  }

  late final _mlx_fast_metal_kernel_config_add_template_arg_dtypePtr = _lookup<
          ffi.NativeFunction<
              ffi.Int Function(mlx_fast_metal_kernel_config,
                  ffi.Pointer<ffi.Char>, ffi.UnsignedInt)>>(
      'mlx_fast_metal_kernel_config_add_template_arg_dtype');
  late final _mlx_fast_metal_kernel_config_add_template_arg_dtype =
      _mlx_fast_metal_kernel_config_add_template_arg_dtypePtr.asFunction<
          int Function(
              mlx_fast_metal_kernel_config, ffi.Pointer<ffi.Char>, int)>();

  int mlx_fast_metal_kernel_config_add_template_arg_int(
    mlx_fast_metal_kernel_config cls,
    ffi.Pointer<ffi.Char> name,
    int value,
  ) {
    return _mlx_fast_metal_kernel_config_add_template_arg_int(
      cls,
      name,
      value,
    );
  }

  late final _mlx_fast_metal_kernel_config_add_template_arg_intPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_metal_kernel_config, ffi.Pointer<ffi.Char>,
              ffi.Int)>>('mlx_fast_metal_kernel_config_add_template_arg_int');
  late final _mlx_fast_metal_kernel_config_add_template_arg_int =
      _mlx_fast_metal_kernel_config_add_template_arg_intPtr.asFunction<
          int Function(
              mlx_fast_metal_kernel_config, ffi.Pointer<ffi.Char>, int)>();

  int mlx_fast_metal_kernel_config_add_template_arg_bool(
    mlx_fast_metal_kernel_config cls,
    ffi.Pointer<ffi.Char> name,
    bool value,
  ) {
    return _mlx_fast_metal_kernel_config_add_template_arg_bool(
      cls,
      name,
      value,
    );
  }

  late final _mlx_fast_metal_kernel_config_add_template_arg_boolPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_fast_metal_kernel_config, ffi.Pointer<ffi.Char>,
              ffi.Bool)>>('mlx_fast_metal_kernel_config_add_template_arg_bool');
  late final _mlx_fast_metal_kernel_config_add_template_arg_bool =
      _mlx_fast_metal_kernel_config_add_template_arg_boolPtr.asFunction<
          int Function(
              mlx_fast_metal_kernel_config, ffi.Pointer<ffi.Char>, bool)>();

  mlx_fast_metal_kernel mlx_fast_metal_kernel_new(
    ffi.Pointer<ffi.Char> name,
    mlx_vector_string input_names,
    mlx_vector_string output_names,
    ffi.Pointer<ffi.Char> source,
    ffi.Pointer<ffi.Char> header,
    bool ensure_row_contiguous,
    bool atomic_outputs,
  ) {
    return _mlx_fast_metal_kernel_new(
      name,
      input_names,
      output_names,
      source,
      header,
      ensure_row_contiguous,
      atomic_outputs,
    );
  }

  late final _mlx_fast_metal_kernel_newPtr = _lookup<
      ffi.NativeFunction<
          mlx_fast_metal_kernel Function(
              ffi.Pointer<ffi.Char>,
              mlx_vector_string,
              mlx_vector_string,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              ffi.Bool,
              ffi.Bool)>>('mlx_fast_metal_kernel_new');
  late final _mlx_fast_metal_kernel_new =
      _mlx_fast_metal_kernel_newPtr.asFunction<
          mlx_fast_metal_kernel Function(
              ffi.Pointer<ffi.Char>,
              mlx_vector_string,
              mlx_vector_string,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              bool,
              bool)>();

  void mlx_fast_metal_kernel_free(
    mlx_fast_metal_kernel cls,
  ) {
    return _mlx_fast_metal_kernel_free(
      cls,
    );
  }

  late final _mlx_fast_metal_kernel_freePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(mlx_fast_metal_kernel)>>(
          'mlx_fast_metal_kernel_free');
  late final _mlx_fast_metal_kernel_free = _mlx_fast_metal_kernel_freePtr
      .asFunction<void Function(mlx_fast_metal_kernel)>();

  int mlx_fast_metal_kernel_apply(
    ffi.Pointer<mlx_vector_array> outputs,
    mlx_fast_metal_kernel cls,
    mlx_vector_array inputs,
    mlx_fast_metal_kernel_config config,
    mlx_stream stream,
  ) {
    return _mlx_fast_metal_kernel_apply(
      outputs,
      cls,
      inputs,
      config,
      stream,
    );
  }

  late final _mlx_fast_metal_kernel_applyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_fast_metal_kernel,
              mlx_vector_array,
              mlx_fast_metal_kernel_config,
              mlx_stream)>>('mlx_fast_metal_kernel_apply');
  late final _mlx_fast_metal_kernel_apply =
      _mlx_fast_metal_kernel_applyPtr.asFunction<
          int Function(ffi.Pointer<mlx_vector_array>, mlx_fast_metal_kernel,
              mlx_vector_array, mlx_fast_metal_kernel_config, mlx_stream)>();

  int mlx_fast_rms_norm(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_array weight,
    double eps,
    mlx_stream s,
  ) {
    return _mlx_fast_rms_norm(
      res,
      x,
      weight,
      eps,
      s,
    );
  }

  late final _mlx_fast_rms_normPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Float, mlx_stream)>>('mlx_fast_rms_norm');
  late final _mlx_fast_rms_norm = _mlx_fast_rms_normPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_array, double, mlx_stream)>();

  int mlx_fast_rope(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    int dims,
    bool traditional,
    mlx_optional_float base,
    double scale,
    int offset,
    mlx_array freqs,
    mlx_stream s,
  ) {
    return _mlx_fast_rope(
      res,
      x,
      dims,
      traditional,
      base,
      scale,
      offset,
      freqs,
      s,
    );
  }

  late final _mlx_fast_ropePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Int,
              ffi.Bool,
              mlx_optional_float,
              ffi.Float,
              ffi.Int,
              mlx_array,
              mlx_stream)>>('mlx_fast_rope');
  late final _mlx_fast_rope = _mlx_fast_ropePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool,
          mlx_optional_float, double, int, mlx_array, mlx_stream)>();

  int mlx_fast_rope_dynamic(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    int dims,
    bool traditional,
    mlx_optional_float base,
    double scale,
    mlx_array offset,
    mlx_array freqs,
    mlx_stream s,
  ) {
    return _mlx_fast_rope_dynamic(
      res,
      x,
      dims,
      traditional,
      base,
      scale,
      offset,
      freqs,
      s,
    );
  }

  late final _mlx_fast_rope_dynamicPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Int,
              ffi.Bool,
              mlx_optional_float,
              ffi.Float,
              mlx_array,
              mlx_array,
              mlx_stream)>>('mlx_fast_rope_dynamic');
  late final _mlx_fast_rope_dynamic = _mlx_fast_rope_dynamicPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool,
          mlx_optional_float, double, mlx_array, mlx_array, mlx_stream)>();

  int mlx_fast_scaled_dot_product_attention(
    ffi.Pointer<mlx_array> res,
    mlx_array queries,
    mlx_array keys,
    mlx_array values,
    double scale,
    ffi.Pointer<ffi.Char> mask_mode,
    mlx_array mask_arr,
    mlx_array sinks,
    mlx_stream s,
  ) {
    return _mlx_fast_scaled_dot_product_attention(
      res,
      queries,
      keys,
      values,
      scale,
      mask_mode,
      mask_arr,
      sinks,
      s,
    );
  }

  late final _mlx_fast_scaled_dot_product_attentionPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              mlx_array,
              ffi.Float,
              ffi.Pointer<ffi.Char>,
              mlx_array,
              mlx_array,
              mlx_stream)>>('mlx_fast_scaled_dot_product_attention');
  late final _mlx_fast_scaled_dot_product_attention =
      _mlx_fast_scaled_dot_product_attentionPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              mlx_array,
              double,
              ffi.Pointer<ffi.Char>,
              mlx_array,
              mlx_array,
              mlx_stream)>();

  /// \defgroup fft FFT operations
  /// /
  /// /**@{
  int mlx_fft_fft(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int n,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_fft_fft(
      res,
      a,
      n,
      axis,
      s,
    );
  }

  late final _mlx_fft_fftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_fft_fft');
  late final _mlx_fft_fft = _mlx_fft_fftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_fft_fft2(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_fft2(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_fft2Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_fft2');
  late final _mlx_fft_fft2 = _mlx_fft_fft2Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_fft_fftn(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_fftn(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_fftnPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_fftn');
  late final _mlx_fft_fftn = _mlx_fft_fftnPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_fft_fftshift(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_fftshift(
      res,
      a,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_fftshiftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              ffi.Pointer<ffi.Int>, ffi.Size, mlx_stream)>>('mlx_fft_fftshift');
  late final _mlx_fft_fftshift = _mlx_fft_fftshiftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_fft_ifft(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int n,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_fft_ifft(
      res,
      a,
      n,
      axis,
      s,
    );
  }

  late final _mlx_fft_ifftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_fft_ifft');
  late final _mlx_fft_ifft = _mlx_fft_ifftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_fft_ifft2(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_ifft2(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_ifft2Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_ifft2');
  late final _mlx_fft_ifft2 = _mlx_fft_ifft2Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_fft_ifftn(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_ifftn(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_ifftnPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_ifftn');
  late final _mlx_fft_ifftn = _mlx_fft_ifftnPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_fft_ifftshift(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_ifftshift(
      res,
      a,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_ifftshiftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_ifftshift');
  late final _mlx_fft_ifftshift = _mlx_fft_ifftshiftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_fft_irfft(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int n,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_fft_irfft(
      res,
      a,
      n,
      axis,
      s,
    );
  }

  late final _mlx_fft_irfftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_fft_irfft');
  late final _mlx_fft_irfft = _mlx_fft_irfftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_fft_irfft2(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_irfft2(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_irfft2Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_irfft2');
  late final _mlx_fft_irfft2 = _mlx_fft_irfft2Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_fft_irfftn(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_irfftn(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_irfftnPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_irfftn');
  late final _mlx_fft_irfftn = _mlx_fft_irfftnPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_fft_rfft(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int n,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_fft_rfft(
      res,
      a,
      n,
      axis,
      s,
    );
  }

  late final _mlx_fft_rfftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_fft_rfft');
  late final _mlx_fft_rfft = _mlx_fft_rfftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_fft_rfft2(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_rfft2(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_rfft2Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_rfft2');
  late final _mlx_fft_rfft2 = _mlx_fft_rfft2Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_fft_rfftn(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> n,
    int n_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_fft_rfftn(
      res,
      a,
      n,
      n_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_fft_rfftnPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_fft_rfftn');
  late final _mlx_fft_rfftn = _mlx_fft_rfftnPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  /// \defgroup io IO operations
  /// /
  /// /**@{
  int mlx_load_reader(
    ffi.Pointer<mlx_array> res,
    mlx_io_reader in_stream,
    mlx_stream s,
  ) {
    return _mlx_load_reader(
      res,
      in_stream,
      s,
    );
  }

  late final _mlx_load_readerPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_io_reader,
              mlx_stream)>>('mlx_load_reader');
  late final _mlx_load_reader = _mlx_load_readerPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_io_reader, mlx_stream)>();

  int mlx_load(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Char> file,
    mlx_stream s,
  ) {
    return _mlx_load(
      res,
      file,
      s,
    );
  }

  late final _mlx_loadPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_load');
  late final _mlx_load = _mlx_loadPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Char>, mlx_stream)>();

  int mlx_load_safetensors_reader(
    ffi.Pointer<mlx_map_string_to_array> res_0,
    ffi.Pointer<mlx_map_string_to_string> res_1,
    mlx_io_reader in_stream,
    mlx_stream s,
  ) {
    return _mlx_load_safetensors_reader(
      res_0,
      res_1,
      in_stream,
      s,
    );
  }

  late final _mlx_load_safetensors_readerPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_map_string_to_array>,
              ffi.Pointer<mlx_map_string_to_string>,
              mlx_io_reader,
              mlx_stream)>>('mlx_load_safetensors_reader');
  late final _mlx_load_safetensors_reader =
      _mlx_load_safetensors_readerPtr.asFunction<
          int Function(
              ffi.Pointer<mlx_map_string_to_array>,
              ffi.Pointer<mlx_map_string_to_string>,
              mlx_io_reader,
              mlx_stream)>();

  int mlx_load_safetensors(
    ffi.Pointer<mlx_map_string_to_array> res_0,
    ffi.Pointer<mlx_map_string_to_string> res_1,
    ffi.Pointer<ffi.Char> file,
    mlx_stream s,
  ) {
    return _mlx_load_safetensors(
      res_0,
      res_1,
      file,
      s,
    );
  }

  late final _mlx_load_safetensorsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_map_string_to_array>,
              ffi.Pointer<mlx_map_string_to_string>,
              ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_load_safetensors');
  late final _mlx_load_safetensors = _mlx_load_safetensorsPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_map_string_to_array>,
          ffi.Pointer<mlx_map_string_to_string>,
          ffi.Pointer<ffi.Char>,
          mlx_stream)>();

  int mlx_save_writer(
    mlx_io_writer out_stream,
    mlx_array a,
  ) {
    return _mlx_save_writer(
      out_stream,
      a,
    );
  }

  late final _mlx_save_writerPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_io_writer, mlx_array)>>(
          'mlx_save_writer');
  late final _mlx_save_writer =
      _mlx_save_writerPtr.asFunction<int Function(mlx_io_writer, mlx_array)>();

  int mlx_save(
    ffi.Pointer<ffi.Char> file,
    mlx_array a,
  ) {
    return _mlx_save(
      file,
      a,
    );
  }

  late final _mlx_savePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Char>, mlx_array)>>('mlx_save');
  late final _mlx_save =
      _mlx_savePtr.asFunction<int Function(ffi.Pointer<ffi.Char>, mlx_array)>();

  int mlx_save_safetensors_writer(
    mlx_io_writer in_stream,
    mlx_map_string_to_array param,
    mlx_map_string_to_string metadata,
  ) {
    return _mlx_save_safetensors_writer(
      in_stream,
      param,
      metadata,
    );
  }

  late final _mlx_save_safetensors_writerPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(mlx_io_writer, mlx_map_string_to_array,
              mlx_map_string_to_string)>>('mlx_save_safetensors_writer');
  late final _mlx_save_safetensors_writer =
      _mlx_save_safetensors_writerPtr.asFunction<
          int Function(mlx_io_writer, mlx_map_string_to_array,
              mlx_map_string_to_string)>();

  int mlx_save_safetensors(
    ffi.Pointer<ffi.Char> file,
    mlx_map_string_to_array param,
    mlx_map_string_to_string metadata,
  ) {
    return _mlx_save_safetensors(
      file,
      param,
      metadata,
    );
  }

  late final _mlx_save_safetensorsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<ffi.Char>, mlx_map_string_to_array,
              mlx_map_string_to_string)>>('mlx_save_safetensors');
  late final _mlx_save_safetensors = _mlx_save_safetensorsPtr.asFunction<
      int Function(ffi.Pointer<ffi.Char>, mlx_map_string_to_array,
          mlx_map_string_to_string)>();

  /// \defgroup linalg Linear algebra operations
  /// /
  /// /**@{
  int mlx_linalg_cholesky(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool upper,
    mlx_stream s,
  ) {
    return _mlx_linalg_cholesky(
      res,
      a,
      upper,
      s,
    );
  }

  late final _mlx_linalg_choleskyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_linalg_cholesky');
  late final _mlx_linalg_cholesky = _mlx_linalg_choleskyPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_linalg_cholesky_inv(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool upper,
    mlx_stream s,
  ) {
    return _mlx_linalg_cholesky_inv(
      res,
      a,
      upper,
      s,
    );
  }

  late final _mlx_linalg_cholesky_invPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_linalg_cholesky_inv');
  late final _mlx_linalg_cholesky_inv = _mlx_linalg_cholesky_invPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_linalg_cross(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_linalg_cross(
      res,
      a,
      b,
      axis,
      s,
    );
  }

  late final _mlx_linalg_crossPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Int, mlx_stream)>>('mlx_linalg_cross');
  late final _mlx_linalg_cross = _mlx_linalg_crossPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, mlx_stream)>();

  int mlx_linalg_eig(
    ffi.Pointer<mlx_array> res_0,
    ffi.Pointer<mlx_array> res_1,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_linalg_eig(
      res_0,
      res_1,
      a,
      s,
    );
  }

  late final _mlx_linalg_eigPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>,
              mlx_array, mlx_stream)>>('mlx_linalg_eig');
  late final _mlx_linalg_eig = _mlx_linalg_eigPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>, mlx_array,
          mlx_stream)>();

  int mlx_linalg_eigh(
    ffi.Pointer<mlx_array> res_0,
    ffi.Pointer<mlx_array> res_1,
    mlx_array a,
    ffi.Pointer<ffi.Char> UPLO,
    mlx_stream s,
  ) {
    return _mlx_linalg_eigh(
      res_0,
      res_1,
      a,
      UPLO,
      s,
    );
  }

  late final _mlx_linalg_eighPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_linalg_eigh');
  late final _mlx_linalg_eigh = _mlx_linalg_eighPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>, mlx_array,
          ffi.Pointer<ffi.Char>, mlx_stream)>();

  int mlx_linalg_eigvals(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_linalg_eigvals(
      res,
      a,
      s,
    );
  }

  late final _mlx_linalg_eigvalsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_linalg_eigvals');
  late final _mlx_linalg_eigvals = _mlx_linalg_eigvalsPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_linalg_eigvalsh(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Char> UPLO,
    mlx_stream s,
  ) {
    return _mlx_linalg_eigvalsh(
      res,
      a,
      UPLO,
      s,
    );
  }

  late final _mlx_linalg_eigvalshPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              ffi.Pointer<ffi.Char>, mlx_stream)>>('mlx_linalg_eigvalsh');
  late final _mlx_linalg_eigvalsh = _mlx_linalg_eigvalshPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Char>,
          mlx_stream)>();

  int mlx_linalg_inv(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_linalg_inv(
      res,
      a,
      s,
    );
  }

  late final _mlx_linalg_invPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_linalg_inv');
  late final _mlx_linalg_inv = _mlx_linalg_invPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_linalg_lu(
    ffi.Pointer<mlx_vector_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_linalg_lu(
      res,
      a,
      s,
    );
  }

  late final _mlx_linalg_luPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_array,
              mlx_stream)>>('mlx_linalg_lu');
  late final _mlx_linalg_lu = _mlx_linalg_luPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, mlx_array, mlx_stream)>();

  int mlx_linalg_lu_factor(
    ffi.Pointer<mlx_array> res_0,
    ffi.Pointer<mlx_array> res_1,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_linalg_lu_factor(
      res_0,
      res_1,
      a,
      s,
    );
  }

  late final _mlx_linalg_lu_factorPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>,
              mlx_array, mlx_stream)>>('mlx_linalg_lu_factor');
  late final _mlx_linalg_lu_factor = _mlx_linalg_lu_factorPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>, mlx_array,
          mlx_stream)>();

  int mlx_linalg_norm(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    double ord,
    ffi.Pointer<ffi.Int> axis,
    int axis_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_linalg_norm(
      res,
      a,
      ord,
      axis,
      axis_num,
      keepdims,
      s,
    );
  }

  late final _mlx_linalg_normPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Double,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_linalg_norm');
  late final _mlx_linalg_norm = _mlx_linalg_normPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, double,
          ffi.Pointer<ffi.Int>, int, bool, mlx_stream)>();

  int mlx_linalg_norm_matrix(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Char> ord,
    ffi.Pointer<ffi.Int> axis,
    int axis_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_linalg_norm_matrix(
      res,
      a,
      ord,
      axis,
      axis_num,
      keepdims,
      s,
    );
  }

  late final _mlx_linalg_norm_matrixPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_linalg_norm_matrix');
  late final _mlx_linalg_norm_matrix = _mlx_linalg_norm_matrixPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Int>, int, bool, mlx_stream)>();

  int mlx_linalg_norm_l2(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axis,
    int axis_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_linalg_norm_l2(
      res,
      a,
      axis,
      axis_num,
      keepdims,
      s,
    );
  }

  late final _mlx_linalg_norm_l2Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_linalg_norm_l2');
  late final _mlx_linalg_norm_l2 = _mlx_linalg_norm_l2Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_linalg_pinv(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_linalg_pinv(
      res,
      a,
      s,
    );
  }

  late final _mlx_linalg_pinvPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_linalg_pinv');
  late final _mlx_linalg_pinv = _mlx_linalg_pinvPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_linalg_qr(
    ffi.Pointer<mlx_array> res_0,
    ffi.Pointer<mlx_array> res_1,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_linalg_qr(
      res_0,
      res_1,
      a,
      s,
    );
  }

  late final _mlx_linalg_qrPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>,
              mlx_array, mlx_stream)>>('mlx_linalg_qr');
  late final _mlx_linalg_qr = _mlx_linalg_qrPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>, mlx_array,
          mlx_stream)>();

  int mlx_linalg_solve(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_linalg_solve(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_linalg_solvePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_linalg_solve');
  late final _mlx_linalg_solve = _mlx_linalg_solvePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_linalg_solve_triangular(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    bool upper,
    mlx_stream s,
  ) {
    return _mlx_linalg_solve_triangular(
      res,
      a,
      b,
      upper,
      s,
    );
  }

  late final _mlx_linalg_solve_triangularPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Bool, mlx_stream)>>('mlx_linalg_solve_triangular');
  late final _mlx_linalg_solve_triangular =
      _mlx_linalg_solve_triangularPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, bool,
              mlx_stream)>();

  int mlx_linalg_svd(
    ffi.Pointer<mlx_vector_array> res,
    mlx_array a,
    bool compute_uv,
    mlx_stream s,
  ) {
    return _mlx_linalg_svd(
      res,
      a,
      compute_uv,
      s,
    );
  }

  late final _mlx_linalg_svdPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_linalg_svd');
  late final _mlx_linalg_svd = _mlx_linalg_svdPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_vector_array>, mlx_array, bool, mlx_stream)>();

  int mlx_linalg_tri_inv(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool upper,
    mlx_stream s,
  ) {
    return _mlx_linalg_tri_inv(
      res,
      a,
      upper,
      s,
    );
  }

  late final _mlx_linalg_tri_invPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_linalg_tri_inv');
  late final _mlx_linalg_tri_inv = _mlx_linalg_tri_invPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  /// \defgroup memory Memory operations
  /// /
  /// /**@{
  int mlx_clear_cache() {
    return _mlx_clear_cache();
  }

  late final _mlx_clear_cachePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function()>>('mlx_clear_cache');
  late final _mlx_clear_cache =
      _mlx_clear_cachePtr.asFunction<int Function()>();

  int mlx_get_active_memory(
    ffi.Pointer<ffi.Size> res,
  ) {
    return _mlx_get_active_memory(
      res,
    );
  }

  late final _mlx_get_active_memoryPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Size>)>>(
          'mlx_get_active_memory');
  late final _mlx_get_active_memory = _mlx_get_active_memoryPtr
      .asFunction<int Function(ffi.Pointer<ffi.Size>)>();

  int mlx_get_cache_memory(
    ffi.Pointer<ffi.Size> res,
  ) {
    return _mlx_get_cache_memory(
      res,
    );
  }

  late final _mlx_get_cache_memoryPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Size>)>>(
          'mlx_get_cache_memory');
  late final _mlx_get_cache_memory = _mlx_get_cache_memoryPtr
      .asFunction<int Function(ffi.Pointer<ffi.Size>)>();

  int mlx_get_memory_limit(
    ffi.Pointer<ffi.Size> res,
  ) {
    return _mlx_get_memory_limit(
      res,
    );
  }

  late final _mlx_get_memory_limitPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Size>)>>(
          'mlx_get_memory_limit');
  late final _mlx_get_memory_limit = _mlx_get_memory_limitPtr
      .asFunction<int Function(ffi.Pointer<ffi.Size>)>();

  int mlx_get_peak_memory(
    ffi.Pointer<ffi.Size> res,
  ) {
    return _mlx_get_peak_memory(
      res,
    );
  }

  late final _mlx_get_peak_memoryPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Size>)>>(
          'mlx_get_peak_memory');
  late final _mlx_get_peak_memory =
      _mlx_get_peak_memoryPtr.asFunction<int Function(ffi.Pointer<ffi.Size>)>();

  int mlx_reset_peak_memory() {
    return _mlx_reset_peak_memory();
  }

  late final _mlx_reset_peak_memoryPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function()>>('mlx_reset_peak_memory');
  late final _mlx_reset_peak_memory =
      _mlx_reset_peak_memoryPtr.asFunction<int Function()>();

  int mlx_set_cache_limit(
    ffi.Pointer<ffi.Size> res,
    int limit,
  ) {
    return _mlx_set_cache_limit(
      res,
      limit,
    );
  }

  late final _mlx_set_cache_limitPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Size>, ffi.Size)>>(
      'mlx_set_cache_limit');
  late final _mlx_set_cache_limit = _mlx_set_cache_limitPtr
      .asFunction<int Function(ffi.Pointer<ffi.Size>, int)>();

  int mlx_set_memory_limit(
    ffi.Pointer<ffi.Size> res,
    int limit,
  ) {
    return _mlx_set_memory_limit(
      res,
      limit,
    );
  }

  late final _mlx_set_memory_limitPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Size>, ffi.Size)>>(
      'mlx_set_memory_limit');
  late final _mlx_set_memory_limit = _mlx_set_memory_limitPtr
      .asFunction<int Function(ffi.Pointer<ffi.Size>, int)>();

  int mlx_set_wired_limit(
    ffi.Pointer<ffi.Size> res,
    int limit,
  ) {
    return _mlx_set_wired_limit(
      res,
      limit,
    );
  }

  late final _mlx_set_wired_limitPtr = _lookup<
          ffi
          .NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Size>, ffi.Size)>>(
      'mlx_set_wired_limit');
  late final _mlx_set_wired_limit = _mlx_set_wired_limitPtr
      .asFunction<int Function(ffi.Pointer<ffi.Size>, int)>();

  /// \defgroup metal Metal specific operations
  /// /
  /// /**@{
  int mlx_metal_is_available(
    ffi.Pointer<ffi.Bool> res,
  ) {
    return _mlx_metal_is_available(
      res,
    );
  }

  late final _mlx_metal_is_availablePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Bool>)>>(
          'mlx_metal_is_available');
  late final _mlx_metal_is_available = _mlx_metal_is_availablePtr
      .asFunction<int Function(ffi.Pointer<ffi.Bool>)>();

  int mlx_metal_start_capture(
    ffi.Pointer<ffi.Char> path,
  ) {
    return _mlx_metal_start_capture(
      path,
    );
  }

  late final _mlx_metal_start_capturePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<ffi.Char>)>>(
          'mlx_metal_start_capture');
  late final _mlx_metal_start_capture = _mlx_metal_start_capturePtr
      .asFunction<int Function(ffi.Pointer<ffi.Char>)>();

  int mlx_metal_stop_capture() {
    return _mlx_metal_stop_capture();
  }

  late final _mlx_metal_stop_capturePtr =
      _lookup<ffi.NativeFunction<ffi.Int Function()>>('mlx_metal_stop_capture');
  late final _mlx_metal_stop_capture =
      _mlx_metal_stop_capturePtr.asFunction<int Function()>();

  /// \defgroup ops Core array operations
  /// /
  /// /**@{
  int mlx_abs(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_abs(
      res,
      a,
      s,
    );
  }

  late final _mlx_absPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_abs');
  late final _mlx_abs = _mlx_absPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_add(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_add(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_addPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_add');
  late final _mlx_add = _mlx_addPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_addmm(
    ffi.Pointer<mlx_array> res,
    mlx_array c,
    mlx_array a,
    mlx_array b,
    double alpha,
    double beta,
    mlx_stream s,
  ) {
    return _mlx_addmm(
      res,
      c,
      a,
      b,
      alpha,
      beta,
      s,
    );
  }

  late final _mlx_addmmPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Float, ffi.Float, mlx_stream)>>('mlx_addmm');
  late final _mlx_addmm = _mlx_addmmPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
          double, double, mlx_stream)>();

  int mlx_all_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_all_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_all_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_all_axes');
  late final _mlx_all_axes = _mlx_all_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_all_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_all_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_all_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_all_axis');
  late final _mlx_all_axis = _mlx_all_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_all(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_all(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_allPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_all');
  late final _mlx_all = _mlx_allPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_allclose(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    double rtol,
    double atol,
    bool equal_nan,
    mlx_stream s,
  ) {
    return _mlx_allclose(
      res,
      a,
      b,
      rtol,
      atol,
      equal_nan,
      s,
    );
  }

  late final _mlx_allclosePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Double, ffi.Double, ffi.Bool, mlx_stream)>>('mlx_allclose');
  late final _mlx_allclose = _mlx_allclosePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, double, double,
          bool, mlx_stream)>();

  int mlx_any_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_any_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_any_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_any_axes');
  late final _mlx_any_axes = _mlx_any_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_any_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_any_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_any_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_any_axis');
  late final _mlx_any_axis = _mlx_any_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_any(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_any(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_anyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_any');
  late final _mlx_any = _mlx_anyPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_arange(
    ffi.Pointer<mlx_array> res,
    double start,
    double stop,
    double step,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_arange(
      res,
      start,
      stop,
      step,
      dtype.value,
      s,
    );
  }

  late final _mlx_arangePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Double, ffi.Double,
              ffi.Double, ffi.UnsignedInt, mlx_stream)>>('mlx_arange');
  late final _mlx_arange = _mlx_arangePtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, double, double, double, int, mlx_stream)>();

  int mlx_arccos(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_arccos(
      res,
      a,
      s,
    );
  }

  late final _mlx_arccosPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_arccos');
  late final _mlx_arccos = _mlx_arccosPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_arccosh(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_arccosh(
      res,
      a,
      s,
    );
  }

  late final _mlx_arccoshPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_arccosh');
  late final _mlx_arccosh = _mlx_arccoshPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_arcsin(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_arcsin(
      res,
      a,
      s,
    );
  }

  late final _mlx_arcsinPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_arcsin');
  late final _mlx_arcsin = _mlx_arcsinPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_arcsinh(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_arcsinh(
      res,
      a,
      s,
    );
  }

  late final _mlx_arcsinhPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_arcsinh');
  late final _mlx_arcsinh = _mlx_arcsinhPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_arctan(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_arctan(
      res,
      a,
      s,
    );
  }

  late final _mlx_arctanPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_arctan');
  late final _mlx_arctan = _mlx_arctanPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_arctan2(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_arctan2(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_arctan2Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_arctan2');
  late final _mlx_arctan2 = _mlx_arctan2Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_arctanh(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_arctanh(
      res,
      a,
      s,
    );
  }

  late final _mlx_arctanhPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_arctanh');
  late final _mlx_arctanh = _mlx_arctanhPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_argmax_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_argmax_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_argmax_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_argmax_axis');
  late final _mlx_argmax_axis = _mlx_argmax_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_argmax(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_argmax(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_argmaxPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_argmax');
  late final _mlx_argmax = _mlx_argmaxPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_argmin_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_argmin_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_argmin_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_argmin_axis');
  late final _mlx_argmin_axis = _mlx_argmin_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_argmin(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_argmin(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_argminPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_argmin');
  late final _mlx_argmin = _mlx_argminPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_argpartition_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int kth,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_argpartition_axis(
      res,
      a,
      kth,
      axis,
      s,
    );
  }

  late final _mlx_argpartition_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_argpartition_axis');
  late final _mlx_argpartition_axis = _mlx_argpartition_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_argpartition(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int kth,
    mlx_stream s,
  ) {
    return _mlx_argpartition(
      res,
      a,
      kth,
      s,
    );
  }

  late final _mlx_argpartitionPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_argpartition');
  late final _mlx_argpartition = _mlx_argpartitionPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_argsort_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_argsort_axis(
      res,
      a,
      axis,
      s,
    );
  }

  late final _mlx_argsort_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_argsort_axis');
  late final _mlx_argsort_axis = _mlx_argsort_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_argsort(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_argsort(
      res,
      a,
      s,
    );
  }

  late final _mlx_argsortPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_argsort');
  late final _mlx_argsort = _mlx_argsortPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_array_equal(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    bool equal_nan,
    mlx_stream s,
  ) {
    return _mlx_array_equal(
      res,
      a,
      b,
      equal_nan,
      s,
    );
  }

  late final _mlx_array_equalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Bool, mlx_stream)>>('mlx_array_equal');
  late final _mlx_array_equal = _mlx_array_equalPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_array, bool, mlx_stream)>();

  int mlx_as_strided(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    ffi.Pointer<ffi.Int64> strides,
    int strides_num,
    int offset,
    mlx_stream s,
  ) {
    return _mlx_as_strided(
      res,
      a,
      shape,
      shape_num,
      strides,
      strides_num,
      offset,
      s,
    );
  }

  late final _mlx_as_stridedPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int64>,
              ffi.Size,
              ffi.Size,
              mlx_stream)>>('mlx_as_strided');
  late final _mlx_as_strided = _mlx_as_stridedPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int64>, int, int, mlx_stream)>();

  int mlx_astype(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_astype(
      res,
      a,
      dtype.value,
      s,
    );
  }

  late final _mlx_astypePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.UnsignedInt,
              mlx_stream)>>('mlx_astype');
  late final _mlx_astype = _mlx_astypePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_atleast_1d(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_atleast_1d(
      res,
      a,
      s,
    );
  }

  late final _mlx_atleast_1dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_atleast_1d');
  late final _mlx_atleast_1d = _mlx_atleast_1dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_atleast_2d(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_atleast_2d(
      res,
      a,
      s,
    );
  }

  late final _mlx_atleast_2dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_atleast_2d');
  late final _mlx_atleast_2d = _mlx_atleast_2dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_atleast_3d(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_atleast_3d(
      res,
      a,
      s,
    );
  }

  late final _mlx_atleast_3dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_atleast_3d');
  late final _mlx_atleast_3d = _mlx_atleast_3dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_bitwise_and(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_bitwise_and(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_bitwise_andPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_bitwise_and');
  late final _mlx_bitwise_and = _mlx_bitwise_andPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_bitwise_invert(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_bitwise_invert(
      res,
      a,
      s,
    );
  }

  late final _mlx_bitwise_invertPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_bitwise_invert');
  late final _mlx_bitwise_invert = _mlx_bitwise_invertPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_bitwise_or(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_bitwise_or(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_bitwise_orPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_bitwise_or');
  late final _mlx_bitwise_or = _mlx_bitwise_orPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_bitwise_xor(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_bitwise_xor(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_bitwise_xorPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_bitwise_xor');
  late final _mlx_bitwise_xor = _mlx_bitwise_xorPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_block_masked_mm(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    int block_size,
    mlx_array mask_out,
    mlx_array mask_lhs,
    mlx_array mask_rhs,
    mlx_stream s,
  ) {
    return _mlx_block_masked_mm(
      res,
      a,
      b,
      block_size,
      mask_out,
      mask_lhs,
      mask_rhs,
      s,
    );
  }

  late final _mlx_block_masked_mmPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Int,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_stream)>>('mlx_block_masked_mm');
  late final _mlx_block_masked_mm = _mlx_block_masked_mmPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, mlx_array,
          mlx_array, mlx_array, mlx_stream)>();

  int mlx_broadcast_arrays(
    ffi.Pointer<mlx_vector_array> res,
    mlx_vector_array inputs,
    mlx_stream s,
  ) {
    return _mlx_broadcast_arrays(
      res,
      inputs,
      s,
    );
  }

  late final _mlx_broadcast_arraysPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_vector_array,
              mlx_stream)>>('mlx_broadcast_arrays');
  late final _mlx_broadcast_arrays = _mlx_broadcast_arraysPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_vector_array>, mlx_vector_array, mlx_stream)>();

  int mlx_broadcast_to(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_stream s,
  ) {
    return _mlx_broadcast_to(
      res,
      a,
      shape,
      shape_num,
      s,
    );
  }

  late final _mlx_broadcast_toPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              ffi.Pointer<ffi.Int>, ffi.Size, mlx_stream)>>('mlx_broadcast_to');
  late final _mlx_broadcast_to = _mlx_broadcast_toPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_ceil(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_ceil(
      res,
      a,
      s,
    );
  }

  late final _mlx_ceilPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_ceil');
  late final _mlx_ceil = _mlx_ceilPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_clip(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array a_min,
    mlx_array a_max,
    mlx_stream s,
  ) {
    return _mlx_clip(
      res,
      a,
      a_min,
      a_max,
      s,
    );
  }

  late final _mlx_clipPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, mlx_stream)>>('mlx_clip');
  late final _mlx_clip = _mlx_clipPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
          mlx_stream)>();

  int mlx_concatenate_axis(
    ffi.Pointer<mlx_array> res,
    mlx_vector_array arrays,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_concatenate_axis(
      res,
      arrays,
      axis,
      s,
    );
  }

  late final _mlx_concatenate_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_vector_array, ffi.Int,
              mlx_stream)>>('mlx_concatenate_axis');
  late final _mlx_concatenate_axis = _mlx_concatenate_axisPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_vector_array, int, mlx_stream)>();

  int mlx_concatenate(
    ffi.Pointer<mlx_array> res,
    mlx_vector_array arrays,
    mlx_stream s,
  ) {
    return _mlx_concatenate(
      res,
      arrays,
      s,
    );
  }

  late final _mlx_concatenatePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_vector_array,
              mlx_stream)>>('mlx_concatenate');
  late final _mlx_concatenate = _mlx_concatenatePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_vector_array, mlx_stream)>();

  int mlx_conjugate(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_conjugate(
      res,
      a,
      s,
    );
  }

  late final _mlx_conjugatePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_conjugate');
  late final _mlx_conjugate = _mlx_conjugatePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_contiguous(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool allow_col_major,
    mlx_stream s,
  ) {
    return _mlx_contiguous(
      res,
      a,
      allow_col_major,
      s,
    );
  }

  late final _mlx_contiguousPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_contiguous');
  late final _mlx_contiguous = _mlx_contiguousPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_conv1d(
    ffi.Pointer<mlx_array> res,
    mlx_array input,
    mlx_array weight,
    int stride,
    int padding,
    int dilation,
    int groups,
    mlx_stream s,
  ) {
    return _mlx_conv1d(
      res,
      input,
      weight,
      stride,
      padding,
      dilation,
      groups,
      s,
    );
  }

  late final _mlx_conv1dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Int, ffi.Int, ffi.Int, ffi.Int, mlx_stream)>>('mlx_conv1d');
  late final _mlx_conv1d = _mlx_conv1dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, int, int,
          int, mlx_stream)>();

  int mlx_conv2d(
    ffi.Pointer<mlx_array> res,
    mlx_array input,
    mlx_array weight,
    int stride_0,
    int stride_1,
    int padding_0,
    int padding_1,
    int dilation_0,
    int dilation_1,
    int groups,
    mlx_stream s,
  ) {
    return _mlx_conv2d(
      res,
      input,
      weight,
      stride_0,
      stride_1,
      padding_0,
      padding_1,
      dilation_0,
      dilation_1,
      groups,
      s,
    );
  }

  late final _mlx_conv2dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              mlx_stream)>>('mlx_conv2d');
  late final _mlx_conv2d = _mlx_conv2dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, int, int,
          int, int, int, int, mlx_stream)>();

  int mlx_conv3d(
    ffi.Pointer<mlx_array> res,
    mlx_array input,
    mlx_array weight,
    int stride_0,
    int stride_1,
    int stride_2,
    int padding_0,
    int padding_1,
    int padding_2,
    int dilation_0,
    int dilation_1,
    int dilation_2,
    int groups,
    mlx_stream s,
  ) {
    return _mlx_conv3d(
      res,
      input,
      weight,
      stride_0,
      stride_1,
      stride_2,
      padding_0,
      padding_1,
      padding_2,
      dilation_0,
      dilation_1,
      dilation_2,
      groups,
      s,
    );
  }

  late final _mlx_conv3dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              mlx_stream)>>('mlx_conv3d');
  late final _mlx_conv3d = _mlx_conv3dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, int, int,
          int, int, int, int, int, int, int, mlx_stream)>();

  int mlx_conv_general(
    ffi.Pointer<mlx_array> res,
    mlx_array input,
    mlx_array weight,
    ffi.Pointer<ffi.Int> stride,
    int stride_num,
    ffi.Pointer<ffi.Int> padding_lo,
    int padding_lo_num,
    ffi.Pointer<ffi.Int> padding_hi,
    int padding_hi_num,
    ffi.Pointer<ffi.Int> kernel_dilation,
    int kernel_dilation_num,
    ffi.Pointer<ffi.Int> input_dilation,
    int input_dilation_num,
    int groups,
    bool flip,
    mlx_stream s,
  ) {
    return _mlx_conv_general(
      res,
      input,
      weight,
      stride,
      stride_num,
      padding_lo,
      padding_lo_num,
      padding_hi,
      padding_hi_num,
      kernel_dilation,
      kernel_dilation_num,
      input_dilation,
      input_dilation_num,
      groups,
      flip,
      s,
    );
  }

  late final _mlx_conv_generalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Int,
              ffi.Bool,
              mlx_stream)>>('mlx_conv_general');
  late final _mlx_conv_general = _mlx_conv_generalPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>,
          mlx_array,
          mlx_array,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          int,
          bool,
          mlx_stream)>();

  int mlx_conv_transpose1d(
    ffi.Pointer<mlx_array> res,
    mlx_array input,
    mlx_array weight,
    int stride,
    int padding,
    int dilation,
    int output_padding,
    int groups,
    mlx_stream s,
  ) {
    return _mlx_conv_transpose1d(
      res,
      input,
      weight,
      stride,
      padding,
      dilation,
      output_padding,
      groups,
      s,
    );
  }

  late final _mlx_conv_transpose1dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              mlx_stream)>>('mlx_conv_transpose1d');
  late final _mlx_conv_transpose1d = _mlx_conv_transpose1dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, int, int,
          int, int, mlx_stream)>();

  int mlx_conv_transpose2d(
    ffi.Pointer<mlx_array> res,
    mlx_array input,
    mlx_array weight,
    int stride_0,
    int stride_1,
    int padding_0,
    int padding_1,
    int dilation_0,
    int dilation_1,
    int output_padding_0,
    int output_padding_1,
    int groups,
    mlx_stream s,
  ) {
    return _mlx_conv_transpose2d(
      res,
      input,
      weight,
      stride_0,
      stride_1,
      padding_0,
      padding_1,
      dilation_0,
      dilation_1,
      output_padding_0,
      output_padding_1,
      groups,
      s,
    );
  }

  late final _mlx_conv_transpose2dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              mlx_stream)>>('mlx_conv_transpose2d');
  late final _mlx_conv_transpose2d = _mlx_conv_transpose2dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, int, int,
          int, int, int, int, int, int, mlx_stream)>();

  int mlx_conv_transpose3d(
    ffi.Pointer<mlx_array> res,
    mlx_array input,
    mlx_array weight,
    int stride_0,
    int stride_1,
    int stride_2,
    int padding_0,
    int padding_1,
    int padding_2,
    int dilation_0,
    int dilation_1,
    int dilation_2,
    int output_padding_0,
    int output_padding_1,
    int output_padding_2,
    int groups,
    mlx_stream s,
  ) {
    return _mlx_conv_transpose3d(
      res,
      input,
      weight,
      stride_0,
      stride_1,
      stride_2,
      padding_0,
      padding_1,
      padding_2,
      dilation_0,
      dilation_1,
      dilation_2,
      output_padding_0,
      output_padding_1,
      output_padding_2,
      groups,
      s,
    );
  }

  late final _mlx_conv_transpose3dPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              ffi.Int,
              mlx_stream)>>('mlx_conv_transpose3d');
  late final _mlx_conv_transpose3d = _mlx_conv_transpose3dPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, int, int,
          int, int, int, int, int, int, int, int, int, int, mlx_stream)>();

  int mlx_copy(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_copy(
      res,
      a,
      s,
    );
  }

  late final _mlx_copyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_copy');
  late final _mlx_copy = _mlx_copyPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_cos(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_cos(
      res,
      a,
      s,
    );
  }

  late final _mlx_cosPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_cos');
  late final _mlx_cos = _mlx_cosPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_cosh(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_cosh(
      res,
      a,
      s,
    );
  }

  late final _mlx_coshPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_cosh');
  late final _mlx_cosh = _mlx_coshPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_cummax(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool reverse,
    bool inclusive,
    mlx_stream s,
  ) {
    return _mlx_cummax(
      res,
      a,
      axis,
      reverse,
      inclusive,
      s,
    );
  }

  late final _mlx_cummaxPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              ffi.Bool, mlx_stream)>>('mlx_cummax');
  late final _mlx_cummax = _mlx_cummaxPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, bool, bool, mlx_stream)>();

  int mlx_cummin(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool reverse,
    bool inclusive,
    mlx_stream s,
  ) {
    return _mlx_cummin(
      res,
      a,
      axis,
      reverse,
      inclusive,
      s,
    );
  }

  late final _mlx_cumminPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              ffi.Bool, mlx_stream)>>('mlx_cummin');
  late final _mlx_cummin = _mlx_cumminPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, bool, bool, mlx_stream)>();

  int mlx_cumprod(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool reverse,
    bool inclusive,
    mlx_stream s,
  ) {
    return _mlx_cumprod(
      res,
      a,
      axis,
      reverse,
      inclusive,
      s,
    );
  }

  late final _mlx_cumprodPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              ffi.Bool, mlx_stream)>>('mlx_cumprod');
  late final _mlx_cumprod = _mlx_cumprodPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, bool, bool, mlx_stream)>();

  int mlx_cumsum(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool reverse,
    bool inclusive,
    mlx_stream s,
  ) {
    return _mlx_cumsum(
      res,
      a,
      axis,
      reverse,
      inclusive,
      s,
    );
  }

  late final _mlx_cumsumPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              ffi.Bool, mlx_stream)>>('mlx_cumsum');
  late final _mlx_cumsum = _mlx_cumsumPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, bool, bool, mlx_stream)>();

  int mlx_degrees(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_degrees(
      res,
      a,
      s,
    );
  }

  late final _mlx_degreesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_degrees');
  late final _mlx_degrees = _mlx_degreesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_depends(
    ffi.Pointer<mlx_vector_array> res,
    mlx_vector_array inputs,
    mlx_vector_array dependencies,
  ) {
    return _mlx_depends(
      res,
      inputs,
      dependencies,
    );
  }

  late final _mlx_dependsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_vector_array,
              mlx_vector_array)>>('mlx_depends');
  late final _mlx_depends = _mlx_dependsPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_vector_array>, mlx_vector_array, mlx_vector_array)>();

  int mlx_dequantize(
    ffi.Pointer<mlx_array> res,
    mlx_array w,
    mlx_array scales,
    mlx_array biases,
    mlx_optional_int group_size,
    mlx_optional_int bits,
    ffi.Pointer<ffi.Char> mode,
    mlx_optional_dtype dtype,
    mlx_stream s,
  ) {
    return _mlx_dequantize(
      res,
      w,
      scales,
      biases,
      group_size,
      bits,
      mode,
      dtype,
      s,
    );
  }

  late final _mlx_dequantizePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_optional_int,
              mlx_optional_int,
              ffi.Pointer<ffi.Char>,
              mlx_optional_dtype,
              mlx_stream)>>('mlx_dequantize');
  late final _mlx_dequantize = _mlx_dequantizePtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>,
          mlx_array,
          mlx_array,
          mlx_array,
          mlx_optional_int,
          mlx_optional_int,
          ffi.Pointer<ffi.Char>,
          mlx_optional_dtype,
          mlx_stream)>();

  int mlx_diag(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int k,
    mlx_stream s,
  ) {
    return _mlx_diag(
      res,
      a,
      k,
      s,
    );
  }

  late final _mlx_diagPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_diag');
  late final _mlx_diag = _mlx_diagPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_diagonal(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int offset,
    int axis1,
    int axis2,
    mlx_stream s,
  ) {
    return _mlx_diagonal(
      res,
      a,
      offset,
      axis1,
      axis2,
      s,
    );
  }

  late final _mlx_diagonalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              ffi.Int, mlx_stream)>>('mlx_diagonal');
  late final _mlx_diagonal = _mlx_diagonalPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, int, int, mlx_stream)>();

  int mlx_divide(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_divide(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_dividePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_divide');
  late final _mlx_divide = _mlx_dividePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_divmod(
    ffi.Pointer<mlx_vector_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_divmod(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_divmodPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_divmod');
  late final _mlx_divmod = _mlx_divmodPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_vector_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_einsum(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Char> subscripts,
    mlx_vector_array operands,
    mlx_stream s,
  ) {
    return _mlx_einsum(
      res,
      subscripts,
      operands,
      s,
    );
  }

  late final _mlx_einsumPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Char>,
              mlx_vector_array, mlx_stream)>>('mlx_einsum');
  late final _mlx_einsum = _mlx_einsumPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Char>,
          mlx_vector_array, mlx_stream)>();

  int mlx_equal(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_equal(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_equalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_equal');
  late final _mlx_equal = _mlx_equalPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_erf(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_erf(
      res,
      a,
      s,
    );
  }

  late final _mlx_erfPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_erf');
  late final _mlx_erf = _mlx_erfPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_erfinv(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_erfinv(
      res,
      a,
      s,
    );
  }

  late final _mlx_erfinvPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_erfinv');
  late final _mlx_erfinv = _mlx_erfinvPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_exp(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_exp(
      res,
      a,
      s,
    );
  }

  late final _mlx_expPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_exp');
  late final _mlx_exp = _mlx_expPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_expand_dims_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_expand_dims_axes(
      res,
      a,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_expand_dims_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_expand_dims_axes');
  late final _mlx_expand_dims_axes = _mlx_expand_dims_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_expand_dims(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_expand_dims(
      res,
      a,
      axis,
      s,
    );
  }

  late final _mlx_expand_dimsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_expand_dims');
  late final _mlx_expand_dims = _mlx_expand_dimsPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_expm1(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_expm1(
      res,
      a,
      s,
    );
  }

  late final _mlx_expm1Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_expm1');
  late final _mlx_expm1 = _mlx_expm1Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_eye(
    ffi.Pointer<mlx_array> res,
    int n,
    int m,
    int k,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_eye(
      res,
      n,
      m,
      k,
      dtype.value,
      s,
    );
  }

  late final _mlx_eyePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Int, ffi.Int, ffi.Int,
              ffi.UnsignedInt, mlx_stream)>>('mlx_eye');
  late final _mlx_eye = _mlx_eyePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, int, int, int, int, mlx_stream)>();

  int mlx_flatten(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int start_axis,
    int end_axis,
    mlx_stream s,
  ) {
    return _mlx_flatten(
      res,
      a,
      start_axis,
      end_axis,
      s,
    );
  }

  late final _mlx_flattenPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_flatten');
  late final _mlx_flatten = _mlx_flattenPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_floor(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_floor(
      res,
      a,
      s,
    );
  }

  late final _mlx_floorPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_floor');
  late final _mlx_floor = _mlx_floorPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_floor_divide(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_floor_divide(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_floor_dividePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_floor_divide');
  late final _mlx_floor_divide = _mlx_floor_dividePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_from_fp8(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_from_fp8(
      res,
      x,
      dtype.value,
      s,
    );
  }

  late final _mlx_from_fp8Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.UnsignedInt,
              mlx_stream)>>('mlx_from_fp8');
  late final _mlx_from_fp8 = _mlx_from_fp8Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_full(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_array vals,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_full(
      res,
      shape,
      shape_num,
      vals,
      dtype.value,
      s,
    );
  }

  late final _mlx_fullPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>,
              ffi.Size, mlx_array, ffi.UnsignedInt, mlx_stream)>>('mlx_full');
  late final _mlx_full = _mlx_fullPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, mlx_array,
          int, mlx_stream)>();

  int mlx_full_like(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array vals,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_full_like(
      res,
      a,
      vals,
      dtype.value,
      s,
    );
  }

  late final _mlx_full_likePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.UnsignedInt, mlx_stream)>>('mlx_full_like');
  late final _mlx_full_like = _mlx_full_likePtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, mlx_stream)>();

  int mlx_gather(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_vector_array indices,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    ffi.Pointer<ffi.Int> slice_sizes,
    int slice_sizes_num,
    mlx_stream s,
  ) {
    return _mlx_gather(
      res,
      a,
      indices,
      axes,
      axes_num,
      slice_sizes,
      slice_sizes_num,
      s,
    );
  }

  late final _mlx_gatherPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_vector_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_gather');
  late final _mlx_gather = _mlx_gatherPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_vector_array,
          ffi.Pointer<ffi.Int>, int, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_gather_single(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    int axis,
    ffi.Pointer<ffi.Int> slice_sizes,
    int slice_sizes_num,
    mlx_stream s,
  ) {
    return _mlx_gather_single(
      res,
      a,
      indices,
      axis,
      slice_sizes,
      slice_sizes_num,
      s,
    );
  }

  late final _mlx_gather_singlePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Int,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_gather_single');
  late final _mlx_gather_single = _mlx_gather_singlePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_gather_mm(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_array lhs_indices,
    mlx_array rhs_indices,
    bool sorted_indices,
    mlx_stream s,
  ) {
    return _mlx_gather_mm(
      res,
      a,
      b,
      lhs_indices,
      rhs_indices,
      sorted_indices,
      s,
    );
  }

  late final _mlx_gather_mmPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, mlx_array, ffi.Bool, mlx_stream)>>('mlx_gather_mm');
  late final _mlx_gather_mm = _mlx_gather_mmPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
          mlx_array, bool, mlx_stream)>();

  int mlx_gather_qmm(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_array w,
    mlx_array scales,
    mlx_array biases,
    mlx_array lhs_indices,
    mlx_array rhs_indices,
    bool transpose,
    mlx_optional_int group_size,
    mlx_optional_int bits,
    ffi.Pointer<ffi.Char> mode,
    bool sorted_indices,
    mlx_stream s,
  ) {
    return _mlx_gather_qmm(
      res,
      x,
      w,
      scales,
      biases,
      lhs_indices,
      rhs_indices,
      transpose,
      group_size,
      bits,
      mode,
      sorted_indices,
      s,
    );
  }

  late final _mlx_gather_qmmPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_array,
              ffi.Bool,
              mlx_optional_int,
              mlx_optional_int,
              ffi.Pointer<ffi.Char>,
              ffi.Bool,
              mlx_stream)>>('mlx_gather_qmm');
  late final _mlx_gather_qmm = _mlx_gather_qmmPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>,
          mlx_array,
          mlx_array,
          mlx_array,
          mlx_array,
          mlx_array,
          mlx_array,
          bool,
          mlx_optional_int,
          mlx_optional_int,
          ffi.Pointer<ffi.Char>,
          bool,
          mlx_stream)>();

  int mlx_greater(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_greater(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_greaterPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_greater');
  late final _mlx_greater = _mlx_greaterPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_greater_equal(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_greater_equal(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_greater_equalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_greater_equal');
  late final _mlx_greater_equal = _mlx_greater_equalPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_hadamard_transform(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_optional_float scale,
    mlx_stream s,
  ) {
    return _mlx_hadamard_transform(
      res,
      a,
      scale,
      s,
    );
  }

  late final _mlx_hadamard_transformPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_optional_float, mlx_stream)>>('mlx_hadamard_transform');
  late final _mlx_hadamard_transform = _mlx_hadamard_transformPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_optional_float, mlx_stream)>();

  int mlx_identity(
    ffi.Pointer<mlx_array> res,
    int n,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_identity(
      res,
      n,
      dtype.value,
      s,
    );
  }

  late final _mlx_identityPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Int, ffi.UnsignedInt,
              mlx_stream)>>('mlx_identity');
  late final _mlx_identity = _mlx_identityPtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, int, int, mlx_stream)>();

  int mlx_imag(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_imag(
      res,
      a,
      s,
    );
  }

  late final _mlx_imagPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_imag');
  late final _mlx_imag = _mlx_imagPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_inner(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_inner(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_innerPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_inner');
  late final _mlx_inner = _mlx_innerPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_isclose(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    double rtol,
    double atol,
    bool equal_nan,
    mlx_stream s,
  ) {
    return _mlx_isclose(
      res,
      a,
      b,
      rtol,
      atol,
      equal_nan,
      s,
    );
  }

  late final _mlx_isclosePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Double, ffi.Double, ffi.Bool, mlx_stream)>>('mlx_isclose');
  late final _mlx_isclose = _mlx_isclosePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, double, double,
          bool, mlx_stream)>();

  int mlx_isfinite(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_isfinite(
      res,
      a,
      s,
    );
  }

  late final _mlx_isfinitePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_isfinite');
  late final _mlx_isfinite = _mlx_isfinitePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_isinf(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_isinf(
      res,
      a,
      s,
    );
  }

  late final _mlx_isinfPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_isinf');
  late final _mlx_isinf = _mlx_isinfPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_isnan(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_isnan(
      res,
      a,
      s,
    );
  }

  late final _mlx_isnanPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_isnan');
  late final _mlx_isnan = _mlx_isnanPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_isneginf(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_isneginf(
      res,
      a,
      s,
    );
  }

  late final _mlx_isneginfPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_isneginf');
  late final _mlx_isneginf = _mlx_isneginfPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_isposinf(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_isposinf(
      res,
      a,
      s,
    );
  }

  late final _mlx_isposinfPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_isposinf');
  late final _mlx_isposinf = _mlx_isposinfPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_kron(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_kron(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_kronPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_kron');
  late final _mlx_kron = _mlx_kronPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_left_shift(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_left_shift(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_left_shiftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_left_shift');
  late final _mlx_left_shift = _mlx_left_shiftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_less(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_less(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_lessPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_less');
  late final _mlx_less = _mlx_lessPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_less_equal(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_less_equal(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_less_equalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_less_equal');
  late final _mlx_less_equal = _mlx_less_equalPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_linspace(
    ffi.Pointer<mlx_array> res,
    double start,
    double stop,
    int num,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_linspace(
      res,
      start,
      stop,
      num,
      dtype.value,
      s,
    );
  }

  late final _mlx_linspacePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Double, ffi.Double,
              ffi.Int, ffi.UnsignedInt, mlx_stream)>>('mlx_linspace');
  late final _mlx_linspace = _mlx_linspacePtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, double, double, int, int, mlx_stream)>();

  int mlx_log(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_log(
      res,
      a,
      s,
    );
  }

  late final _mlx_logPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_log');
  late final _mlx_log = _mlx_logPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_log10(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_log10(
      res,
      a,
      s,
    );
  }

  late final _mlx_log10Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_log10');
  late final _mlx_log10 = _mlx_log10Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_log1p(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_log1p(
      res,
      a,
      s,
    );
  }

  late final _mlx_log1pPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_log1p');
  late final _mlx_log1p = _mlx_log1pPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_log2(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_log2(
      res,
      a,
      s,
    );
  }

  late final _mlx_log2Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_log2');
  late final _mlx_log2 = _mlx_log2Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_logaddexp(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_logaddexp(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_logaddexpPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_logaddexp');
  late final _mlx_logaddexp = _mlx_logaddexpPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_logcumsumexp(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool reverse,
    bool inclusive,
    mlx_stream s,
  ) {
    return _mlx_logcumsumexp(
      res,
      a,
      axis,
      reverse,
      inclusive,
      s,
    );
  }

  late final _mlx_logcumsumexpPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              ffi.Bool, mlx_stream)>>('mlx_logcumsumexp');
  late final _mlx_logcumsumexp = _mlx_logcumsumexpPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, bool, bool, mlx_stream)>();

  int mlx_logical_and(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_logical_and(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_logical_andPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_logical_and');
  late final _mlx_logical_and = _mlx_logical_andPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_logical_not(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_logical_not(
      res,
      a,
      s,
    );
  }

  late final _mlx_logical_notPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_logical_not');
  late final _mlx_logical_not = _mlx_logical_notPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_logical_or(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_logical_or(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_logical_orPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_logical_or');
  late final _mlx_logical_or = _mlx_logical_orPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_logsumexp_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_logsumexp_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_logsumexp_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_logsumexp_axes');
  late final _mlx_logsumexp_axes = _mlx_logsumexp_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_logsumexp_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_logsumexp_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_logsumexp_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_logsumexp_axis');
  late final _mlx_logsumexp_axis = _mlx_logsumexp_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_logsumexp(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_logsumexp(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_logsumexpPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_logsumexp');
  late final _mlx_logsumexp = _mlx_logsumexpPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_masked_scatter(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array mask,
    mlx_array src,
    mlx_stream s,
  ) {
    return _mlx_masked_scatter(
      res,
      a,
      mask,
      src,
      s,
    );
  }

  late final _mlx_masked_scatterPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, mlx_stream)>>('mlx_masked_scatter');
  late final _mlx_masked_scatter = _mlx_masked_scatterPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
          mlx_stream)>();

  int mlx_matmul(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_matmul(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_matmulPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_matmul');
  late final _mlx_matmul = _mlx_matmulPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_max_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_max_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_max_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_max_axes');
  late final _mlx_max_axes = _mlx_max_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_max_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_max_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_max_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_max_axis');
  late final _mlx_max_axis = _mlx_max_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_max(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_max(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_maxPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_max');
  late final _mlx_max = _mlx_maxPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_maximum(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_maximum(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_maximumPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_maximum');
  late final _mlx_maximum = _mlx_maximumPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_mean_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_mean_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_mean_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_mean_axes');
  late final _mlx_mean_axes = _mlx_mean_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_mean_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_mean_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_mean_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_mean_axis');
  late final _mlx_mean_axis = _mlx_mean_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_mean(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_mean(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_meanPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_mean');
  late final _mlx_mean = _mlx_meanPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_median(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_median(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_medianPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_median');
  late final _mlx_median = _mlx_medianPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_meshgrid(
    ffi.Pointer<mlx_vector_array> res,
    mlx_vector_array arrays,
    bool sparse,
    ffi.Pointer<ffi.Char> indexing,
    mlx_stream s,
  ) {
    return _mlx_meshgrid(
      res,
      arrays,
      sparse,
      indexing,
      s,
    );
  }

  late final _mlx_meshgridPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_vector_array,
              ffi.Bool, ffi.Pointer<ffi.Char>, mlx_stream)>>('mlx_meshgrid');
  late final _mlx_meshgrid = _mlx_meshgridPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, mlx_vector_array, bool,
          ffi.Pointer<ffi.Char>, mlx_stream)>();

  int mlx_min_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_min_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_min_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_min_axes');
  late final _mlx_min_axes = _mlx_min_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_min_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_min_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_min_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_min_axis');
  late final _mlx_min_axis = _mlx_min_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_min(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_min(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_minPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_min');
  late final _mlx_min = _mlx_minPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_minimum(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_minimum(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_minimumPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_minimum');
  late final _mlx_minimum = _mlx_minimumPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_moveaxis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int source,
    int destination,
    mlx_stream s,
  ) {
    return _mlx_moveaxis(
      res,
      a,
      source,
      destination,
      s,
    );
  }

  late final _mlx_moveaxisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_moveaxis');
  late final _mlx_moveaxis = _mlx_moveaxisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_multiply(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_multiply(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_multiplyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_multiply');
  late final _mlx_multiply = _mlx_multiplyPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_nan_to_num(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    double nan,
    mlx_optional_float posinf,
    mlx_optional_float neginf,
    mlx_stream s,
  ) {
    return _mlx_nan_to_num(
      res,
      a,
      nan,
      posinf,
      neginf,
      s,
    );
  }

  late final _mlx_nan_to_numPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Float,
              mlx_optional_float,
              mlx_optional_float,
              mlx_stream)>>('mlx_nan_to_num');
  late final _mlx_nan_to_num = _mlx_nan_to_numPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, double,
          mlx_optional_float, mlx_optional_float, mlx_stream)>();

  int mlx_negative(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_negative(
      res,
      a,
      s,
    );
  }

  late final _mlx_negativePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_negative');
  late final _mlx_negative = _mlx_negativePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_not_equal(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_not_equal(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_not_equalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_not_equal');
  late final _mlx_not_equal = _mlx_not_equalPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_number_of_elements(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool inverted,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_number_of_elements(
      res,
      a,
      axes,
      axes_num,
      inverted,
      dtype.value,
      s,
    );
  }

  late final _mlx_number_of_elementsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              ffi.UnsignedInt,
              mlx_stream)>>('mlx_number_of_elements');
  late final _mlx_number_of_elements = _mlx_number_of_elementsPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, int, mlx_stream)>();

  int mlx_ones(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_ones(
      res,
      shape,
      shape_num,
      dtype.value,
      s,
    );
  }

  late final _mlx_onesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>,
              ffi.Size, ffi.UnsignedInt, mlx_stream)>>('mlx_ones');
  late final _mlx_ones = _mlx_onesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int,
          mlx_stream)>();

  int mlx_ones_like(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_ones_like(
      res,
      a,
      s,
    );
  }

  late final _mlx_ones_likePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_ones_like');
  late final _mlx_ones_like = _mlx_ones_likePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_outer(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_outer(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_outerPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_outer');
  late final _mlx_outer = _mlx_outerPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_pad(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    ffi.Pointer<ffi.Int> low_pad_size,
    int low_pad_size_num,
    ffi.Pointer<ffi.Int> high_pad_size,
    int high_pad_size_num,
    mlx_array pad_value,
    ffi.Pointer<ffi.Char> mode,
    mlx_stream s,
  ) {
    return _mlx_pad(
      res,
      a,
      axes,
      axes_num,
      low_pad_size,
      low_pad_size_num,
      high_pad_size,
      high_pad_size_num,
      pad_value,
      mode,
      s,
    );
  }

  late final _mlx_padPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_array,
              ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_pad');
  late final _mlx_pad = _mlx_padPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>,
          mlx_array,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          mlx_array,
          ffi.Pointer<ffi.Char>,
          mlx_stream)>();

  int mlx_pad_symmetric(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int pad_width,
    mlx_array pad_value,
    ffi.Pointer<ffi.Char> mode,
    mlx_stream s,
  ) {
    return _mlx_pad_symmetric(
      res,
      a,
      pad_width,
      pad_value,
      mode,
      s,
    );
  }

  late final _mlx_pad_symmetricPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Int,
              mlx_array,
              ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_pad_symmetric');
  late final _mlx_pad_symmetric = _mlx_pad_symmetricPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_array,
          ffi.Pointer<ffi.Char>, mlx_stream)>();

  int mlx_partition_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int kth,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_partition_axis(
      res,
      a,
      kth,
      axis,
      s,
    );
  }

  late final _mlx_partition_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_partition_axis');
  late final _mlx_partition_axis = _mlx_partition_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_partition(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int kth,
    mlx_stream s,
  ) {
    return _mlx_partition(
      res,
      a,
      kth,
      s,
    );
  }

  late final _mlx_partitionPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_partition');
  late final _mlx_partition = _mlx_partitionPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_power(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_power(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_powerPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_power');
  late final _mlx_power = _mlx_powerPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_prod_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_prod_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_prod_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_prod_axes');
  late final _mlx_prod_axes = _mlx_prod_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_prod_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_prod_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_prod_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_prod_axis');
  late final _mlx_prod_axis = _mlx_prod_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_prod(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_prod(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_prodPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_prod');
  late final _mlx_prod = _mlx_prodPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_put_along_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_array values,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_put_along_axis(
      res,
      a,
      indices,
      values,
      axis,
      s,
    );
  }

  late final _mlx_put_along_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Int, mlx_stream)>>('mlx_put_along_axis');
  late final _mlx_put_along_axis = _mlx_put_along_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array, int,
          mlx_stream)>();

  int mlx_qqmm(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_array w,
    mlx_array w_scales,
    mlx_optional_int group_size,
    mlx_optional_int bits,
    ffi.Pointer<ffi.Char> mode,
    mlx_stream s,
  ) {
    return _mlx_qqmm(
      res,
      x,
      w,
      w_scales,
      group_size,
      bits,
      mode,
      s,
    );
  }

  late final _mlx_qqmmPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_optional_int,
              mlx_optional_int,
              ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_qqmm');
  late final _mlx_qqmm = _mlx_qqmmPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>,
          mlx_array,
          mlx_array,
          mlx_array,
          mlx_optional_int,
          mlx_optional_int,
          ffi.Pointer<ffi.Char>,
          mlx_stream)>();

  int mlx_quantize(
    ffi.Pointer<mlx_vector_array> res,
    mlx_array w,
    mlx_optional_int group_size,
    mlx_optional_int bits,
    ffi.Pointer<ffi.Char> mode,
    mlx_stream s,
  ) {
    return _mlx_quantize(
      res,
      w,
      group_size,
      bits,
      mode,
      s,
    );
  }

  late final _mlx_quantizePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_array,
              mlx_optional_int,
              mlx_optional_int,
              ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_quantize');
  late final _mlx_quantize = _mlx_quantizePtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, mlx_array, mlx_optional_int,
          mlx_optional_int, ffi.Pointer<ffi.Char>, mlx_stream)>();

  int mlx_quantized_matmul(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_array w,
    mlx_array scales,
    mlx_array biases,
    bool transpose,
    mlx_optional_int group_size,
    mlx_optional_int bits,
    ffi.Pointer<ffi.Char> mode,
    mlx_stream s,
  ) {
    return _mlx_quantized_matmul(
      res,
      x,
      w,
      scales,
      biases,
      transpose,
      group_size,
      bits,
      mode,
      s,
    );
  }

  late final _mlx_quantized_matmulPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_array,
              ffi.Bool,
              mlx_optional_int,
              mlx_optional_int,
              ffi.Pointer<ffi.Char>,
              mlx_stream)>>('mlx_quantized_matmul');
  late final _mlx_quantized_matmul = _mlx_quantized_matmulPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>,
          mlx_array,
          mlx_array,
          mlx_array,
          mlx_array,
          bool,
          mlx_optional_int,
          mlx_optional_int,
          ffi.Pointer<ffi.Char>,
          mlx_stream)>();

  int mlx_radians(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_radians(
      res,
      a,
      s,
    );
  }

  late final _mlx_radiansPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_radians');
  late final _mlx_radians = _mlx_radiansPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_real(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_real(
      res,
      a,
      s,
    );
  }

  late final _mlx_realPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_real');
  late final _mlx_real = _mlx_realPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_reciprocal(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_reciprocal(
      res,
      a,
      s,
    );
  }

  late final _mlx_reciprocalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_reciprocal');
  late final _mlx_reciprocal = _mlx_reciprocalPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_remainder(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_remainder(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_remainderPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_remainder');
  late final _mlx_remainder = _mlx_remainderPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_repeat_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array arr,
    int repeats,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_repeat_axis(
      res,
      arr,
      repeats,
      axis,
      s,
    );
  }

  late final _mlx_repeat_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_repeat_axis');
  late final _mlx_repeat_axis = _mlx_repeat_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_repeat(
    ffi.Pointer<mlx_array> res,
    mlx_array arr,
    int repeats,
    mlx_stream s,
  ) {
    return _mlx_repeat(
      res,
      arr,
      repeats,
      s,
    );
  }

  late final _mlx_repeatPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_repeat');
  late final _mlx_repeat = _mlx_repeatPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_reshape(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_stream s,
  ) {
    return _mlx_reshape(
      res,
      a,
      shape,
      shape_num,
      s,
    );
  }

  late final _mlx_reshapePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              ffi.Pointer<ffi.Int>, ffi.Size, mlx_stream)>>('mlx_reshape');
  late final _mlx_reshape = _mlx_reshapePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_right_shift(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_right_shift(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_right_shiftPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_right_shift');
  late final _mlx_right_shift = _mlx_right_shiftPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_roll_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> shift,
    int shift_num,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_roll_axis(
      res,
      a,
      shift,
      shift_num,
      axis,
      s,
    );
  }

  late final _mlx_roll_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Int,
              mlx_stream)>>('mlx_roll_axis');
  late final _mlx_roll_axis = _mlx_roll_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          int, mlx_stream)>();

  int mlx_roll_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> shift,
    int shift_num,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_roll_axes(
      res,
      a,
      shift,
      shift_num,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_roll_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_roll_axes');
  late final _mlx_roll_axes = _mlx_roll_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_roll(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> shift,
    int shift_num,
    mlx_stream s,
  ) {
    return _mlx_roll(
      res,
      a,
      shift,
      shift_num,
      s,
    );
  }

  late final _mlx_rollPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              ffi.Pointer<ffi.Int>, ffi.Size, mlx_stream)>>('mlx_roll');
  late final _mlx_roll = _mlx_rollPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_round(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int decimals,
    mlx_stream s,
  ) {
    return _mlx_round(
      res,
      a,
      decimals,
      s,
    );
  }

  late final _mlx_roundPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_round');
  late final _mlx_round = _mlx_roundPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_rsqrt(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_rsqrt(
      res,
      a,
      s,
    );
  }

  late final _mlx_rsqrtPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_rsqrt');
  late final _mlx_rsqrt = _mlx_rsqrtPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_scatter(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_vector_array indices,
    mlx_array updates,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_scatter(
      res,
      a,
      indices,
      updates,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_scatterPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_vector_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_scatter');
  late final _mlx_scatter = _mlx_scatterPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_vector_array,
          mlx_array, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_scatter_single(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_array updates,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_scatter_single(
      res,
      a,
      indices,
      updates,
      axis,
      s,
    );
  }

  late final _mlx_scatter_singlePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Int, mlx_stream)>>('mlx_scatter_single');
  late final _mlx_scatter_single = _mlx_scatter_singlePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array, int,
          mlx_stream)>();

  int mlx_scatter_add(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_vector_array indices,
    mlx_array updates,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_scatter_add(
      res,
      a,
      indices,
      updates,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_scatter_addPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_vector_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_scatter_add');
  late final _mlx_scatter_add = _mlx_scatter_addPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_vector_array,
          mlx_array, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_scatter_add_single(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_array updates,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_scatter_add_single(
      res,
      a,
      indices,
      updates,
      axis,
      s,
    );
  }

  late final _mlx_scatter_add_singlePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Int, mlx_stream)>>('mlx_scatter_add_single');
  late final _mlx_scatter_add_single = _mlx_scatter_add_singlePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array, int,
          mlx_stream)>();

  int mlx_scatter_add_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_array values,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_scatter_add_axis(
      res,
      a,
      indices,
      values,
      axis,
      s,
    );
  }

  late final _mlx_scatter_add_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Int, mlx_stream)>>('mlx_scatter_add_axis');
  late final _mlx_scatter_add_axis = _mlx_scatter_add_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array, int,
          mlx_stream)>();

  int mlx_scatter_max(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_vector_array indices,
    mlx_array updates,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_scatter_max(
      res,
      a,
      indices,
      updates,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_scatter_maxPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_vector_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_scatter_max');
  late final _mlx_scatter_max = _mlx_scatter_maxPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_vector_array,
          mlx_array, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_scatter_max_single(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_array updates,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_scatter_max_single(
      res,
      a,
      indices,
      updates,
      axis,
      s,
    );
  }

  late final _mlx_scatter_max_singlePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Int, mlx_stream)>>('mlx_scatter_max_single');
  late final _mlx_scatter_max_single = _mlx_scatter_max_singlePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array, int,
          mlx_stream)>();

  int mlx_scatter_min(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_vector_array indices,
    mlx_array updates,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_scatter_min(
      res,
      a,
      indices,
      updates,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_scatter_minPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_vector_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_scatter_min');
  late final _mlx_scatter_min = _mlx_scatter_minPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_vector_array,
          mlx_array, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_scatter_min_single(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_array updates,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_scatter_min_single(
      res,
      a,
      indices,
      updates,
      axis,
      s,
    );
  }

  late final _mlx_scatter_min_singlePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Int, mlx_stream)>>('mlx_scatter_min_single');
  late final _mlx_scatter_min_single = _mlx_scatter_min_singlePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array, int,
          mlx_stream)>();

  int mlx_scatter_prod(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_vector_array indices,
    mlx_array updates,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_scatter_prod(
      res,
      a,
      indices,
      updates,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_scatter_prodPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_vector_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_scatter_prod');
  late final _mlx_scatter_prod = _mlx_scatter_prodPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_vector_array,
          mlx_array, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_scatter_prod_single(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_array updates,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_scatter_prod_single(
      res,
      a,
      indices,
      updates,
      axis,
      s,
    );
  }

  late final _mlx_scatter_prod_singlePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, ffi.Int, mlx_stream)>>('mlx_scatter_prod_single');
  late final _mlx_scatter_prod_single = _mlx_scatter_prod_singlePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array, int,
          mlx_stream)>();

  int mlx_segmented_mm(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_array segments,
    mlx_stream s,
  ) {
    return _mlx_segmented_mm(
      res,
      a,
      b,
      segments,
      s,
    );
  }

  late final _mlx_segmented_mmPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, mlx_stream)>>('mlx_segmented_mm');
  late final _mlx_segmented_mm = _mlx_segmented_mmPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
          mlx_stream)>();

  int mlx_sigmoid(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_sigmoid(
      res,
      a,
      s,
    );
  }

  late final _mlx_sigmoidPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_sigmoid');
  late final _mlx_sigmoid = _mlx_sigmoidPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_sign(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_sign(
      res,
      a,
      s,
    );
  }

  late final _mlx_signPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_sign');
  late final _mlx_sign = _mlx_signPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_sin(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_sin(
      res,
      a,
      s,
    );
  }

  late final _mlx_sinPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_sin');
  late final _mlx_sin = _mlx_sinPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_sinh(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_sinh(
      res,
      a,
      s,
    );
  }

  late final _mlx_sinhPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_sinh');
  late final _mlx_sinh = _mlx_sinhPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_slice(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> start,
    int start_num,
    ffi.Pointer<ffi.Int> stop,
    int stop_num,
    ffi.Pointer<ffi.Int> strides,
    int strides_num,
    mlx_stream s,
  ) {
    return _mlx_slice(
      res,
      a,
      start,
      start_num,
      stop,
      stop_num,
      strides,
      strides_num,
      s,
    );
  }

  late final _mlx_slicePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_slice');
  late final _mlx_slice = _mlx_slicePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          ffi.Pointer<ffi.Int>, int, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_slice_dynamic(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array start,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    ffi.Pointer<ffi.Int> slice_size,
    int slice_size_num,
    mlx_stream s,
  ) {
    return _mlx_slice_dynamic(
      res,
      a,
      start,
      axes,
      axes_num,
      slice_size,
      slice_size_num,
      s,
    );
  }

  late final _mlx_slice_dynamicPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_slice_dynamic');
  late final _mlx_slice_dynamic = _mlx_slice_dynamicPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
          ffi.Pointer<ffi.Int>, int, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_slice_update(
    ffi.Pointer<mlx_array> res,
    mlx_array src,
    mlx_array update,
    ffi.Pointer<ffi.Int> start,
    int start_num,
    ffi.Pointer<ffi.Int> stop,
    int stop_num,
    ffi.Pointer<ffi.Int> strides,
    int strides_num,
    mlx_stream s,
  ) {
    return _mlx_slice_update(
      res,
      src,
      update,
      start,
      start_num,
      stop,
      stop_num,
      strides,
      strides_num,
      s,
    );
  }

  late final _mlx_slice_updatePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_slice_update');
  late final _mlx_slice_update = _mlx_slice_updatePtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>,
          mlx_array,
          mlx_array,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int,
          mlx_stream)>();

  int mlx_slice_update_dynamic(
    ffi.Pointer<mlx_array> res,
    mlx_array src,
    mlx_array update,
    mlx_array start,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_slice_update_dynamic(
      res,
      src,
      update,
      start,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_slice_update_dynamicPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_slice_update_dynamic');
  late final _mlx_slice_update_dynamic =
      _mlx_slice_update_dynamicPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
              ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_softmax_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool precise,
    mlx_stream s,
  ) {
    return _mlx_softmax_axes(
      res,
      a,
      axes,
      axes_num,
      precise,
      s,
    );
  }

  late final _mlx_softmax_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_softmax_axes');
  late final _mlx_softmax_axes = _mlx_softmax_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_softmax_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool precise,
    mlx_stream s,
  ) {
    return _mlx_softmax_axis(
      res,
      a,
      axis,
      precise,
      s,
    );
  }

  late final _mlx_softmax_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_softmax_axis');
  late final _mlx_softmax_axis = _mlx_softmax_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_softmax(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool precise,
    mlx_stream s,
  ) {
    return _mlx_softmax(
      res,
      a,
      precise,
      s,
    );
  }

  late final _mlx_softmaxPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_softmax');
  late final _mlx_softmax = _mlx_softmaxPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_sort_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_sort_axis(
      res,
      a,
      axis,
      s,
    );
  }

  late final _mlx_sort_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_sort_axis');
  late final _mlx_sort_axis = _mlx_sort_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_sort(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_sort(
      res,
      a,
      s,
    );
  }

  late final _mlx_sortPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_sort');
  late final _mlx_sort = _mlx_sortPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_split(
    ffi.Pointer<mlx_vector_array> res,
    mlx_array a,
    int num_splits,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_split(
      res,
      a,
      num_splits,
      axis,
      s,
    );
  }

  late final _mlx_splitPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_vector_array>, mlx_array, ffi.Int,
              ffi.Int, mlx_stream)>>('mlx_split');
  late final _mlx_split = _mlx_splitPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_vector_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_split_sections(
    ffi.Pointer<mlx_vector_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> indices,
    int indices_num,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_split_sections(
      res,
      a,
      indices,
      indices_num,
      axis,
      s,
    );
  }

  late final _mlx_split_sectionsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Int,
              mlx_stream)>>('mlx_split_sections');
  late final _mlx_split_sections = _mlx_split_sectionsPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, mlx_array,
          ffi.Pointer<ffi.Int>, int, int, mlx_stream)>();

  int mlx_sqrt(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_sqrt(
      res,
      a,
      s,
    );
  }

  late final _mlx_sqrtPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_sqrt');
  late final _mlx_sqrt = _mlx_sqrtPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_square(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_square(
      res,
      a,
      s,
    );
  }

  late final _mlx_squarePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_square');
  late final _mlx_square = _mlx_squarePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_squeeze_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_squeeze_axes(
      res,
      a,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_squeeze_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              ffi.Pointer<ffi.Int>, ffi.Size, mlx_stream)>>('mlx_squeeze_axes');
  late final _mlx_squeeze_axes = _mlx_squeeze_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_squeeze_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_squeeze_axis(
      res,
      a,
      axis,
      s,
    );
  }

  late final _mlx_squeeze_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_squeeze_axis');
  late final _mlx_squeeze_axis = _mlx_squeeze_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_squeeze(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_squeeze(
      res,
      a,
      s,
    );
  }

  late final _mlx_squeezePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_squeeze');
  late final _mlx_squeeze = _mlx_squeezePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_stack_axis(
    ffi.Pointer<mlx_array> res,
    mlx_vector_array arrays,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_stack_axis(
      res,
      arrays,
      axis,
      s,
    );
  }

  late final _mlx_stack_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_vector_array, ffi.Int,
              mlx_stream)>>('mlx_stack_axis');
  late final _mlx_stack_axis = _mlx_stack_axisPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_vector_array, int, mlx_stream)>();

  int mlx_stack(
    ffi.Pointer<mlx_array> res,
    mlx_vector_array arrays,
    mlx_stream s,
  ) {
    return _mlx_stack(
      res,
      arrays,
      s,
    );
  }

  late final _mlx_stackPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_vector_array,
              mlx_stream)>>('mlx_stack');
  late final _mlx_stack = _mlx_stackPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_vector_array, mlx_stream)>();

  int mlx_std_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    int ddof,
    mlx_stream s,
  ) {
    return _mlx_std_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      ddof,
      s,
    );
  }

  late final _mlx_std_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              ffi.Int,
              mlx_stream)>>('mlx_std_axes');
  late final _mlx_std_axes = _mlx_std_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, int, mlx_stream)>();

  int mlx_std_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    int ddof,
    mlx_stream s,
  ) {
    return _mlx_std_axis(
      res,
      a,
      axis,
      keepdims,
      ddof,
      s,
    );
  }

  late final _mlx_std_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              ffi.Int, mlx_stream)>>('mlx_std_axis');
  late final _mlx_std_axis = _mlx_std_axisPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, bool, int, mlx_stream)>();

  int mlx_std(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    int ddof,
    mlx_stream s,
  ) {
    return _mlx_std(
      res,
      a,
      keepdims,
      ddof,
      s,
    );
  }

  late final _mlx_stdPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool, ffi.Int,
              mlx_stream)>>('mlx_std');
  late final _mlx_std = _mlx_stdPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, int, mlx_stream)>();

  int mlx_stop_gradient(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_stop_gradient(
      res,
      a,
      s,
    );
  }

  late final _mlx_stop_gradientPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_stop_gradient');
  late final _mlx_stop_gradient = _mlx_stop_gradientPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_subtract(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    mlx_stream s,
  ) {
    return _mlx_subtract(
      res,
      a,
      b,
      s,
    );
  }

  late final _mlx_subtractPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_subtract');
  late final _mlx_subtract = _mlx_subtractPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_sum_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_sum_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      s,
    );
  }

  late final _mlx_sum_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              mlx_stream)>>('mlx_sum_axes');
  late final _mlx_sum_axes = _mlx_sum_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, mlx_stream)>();

  int mlx_sum_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_sum_axis(
      res,
      a,
      axis,
      keepdims,
      s,
    );
  }

  late final _mlx_sum_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              mlx_stream)>>('mlx_sum_axis');
  late final _mlx_sum_axis = _mlx_sum_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, bool, mlx_stream)>();

  int mlx_sum(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    mlx_stream s,
  ) {
    return _mlx_sum(
      res,
      a,
      keepdims,
      s,
    );
  }

  late final _mlx_sumPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool,
              mlx_stream)>>('mlx_sum');
  late final _mlx_sum = _mlx_sumPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, mlx_stream)>();

  int mlx_swapaxes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis1,
    int axis2,
    mlx_stream s,
  ) {
    return _mlx_swapaxes(
      res,
      a,
      axis1,
      axis2,
      s,
    );
  }

  late final _mlx_swapaxesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_swapaxes');
  late final _mlx_swapaxes = _mlx_swapaxesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_take_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_take_axis(
      res,
      a,
      indices,
      axis,
      s,
    );
  }

  late final _mlx_take_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Int, mlx_stream)>>('mlx_take_axis');
  late final _mlx_take_axis = _mlx_take_axisPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, mlx_stream)>();

  int mlx_take(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    mlx_stream s,
  ) {
    return _mlx_take(
      res,
      a,
      indices,
      s,
    );
  }

  late final _mlx_takePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_stream)>>('mlx_take');
  late final _mlx_take = _mlx_takePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_stream)>();

  int mlx_take_along_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array indices,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_take_along_axis(
      res,
      a,
      indices,
      axis,
      s,
    );
  }

  late final _mlx_take_along_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Int, mlx_stream)>>('mlx_take_along_axis');
  late final _mlx_take_along_axis = _mlx_take_along_axisPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, mlx_stream)>();

  int mlx_tan(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_tan(
      res,
      a,
      s,
    );
  }

  late final _mlx_tanPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_tan');
  late final _mlx_tan = _mlx_tanPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_tanh(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_tanh(
      res,
      a,
      s,
    );
  }

  late final _mlx_tanhPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_tanh');
  late final _mlx_tanh = _mlx_tanhPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_tensordot(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    ffi.Pointer<ffi.Int> axes_a,
    int axes_a_num,
    ffi.Pointer<ffi.Int> axes_b,
    int axes_b_num,
    mlx_stream s,
  ) {
    return _mlx_tensordot(
      res,
      a,
      b,
      axes_a,
      axes_a_num,
      axes_b,
      axes_b_num,
      s,
    );
  }

  late final _mlx_tensordotPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_tensordot');
  late final _mlx_tensordot = _mlx_tensordotPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
          ffi.Pointer<ffi.Int>, int, ffi.Pointer<ffi.Int>, int, mlx_stream)>();

  int mlx_tensordot_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_array b,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_tensordot_axis(
      res,
      a,
      b,
      axis,
      s,
    );
  }

  late final _mlx_tensordot_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Int, mlx_stream)>>('mlx_tensordot_axis');
  late final _mlx_tensordot_axis = _mlx_tensordot_axisPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, mlx_array, int, mlx_stream)>();

  int mlx_tile(
    ffi.Pointer<mlx_array> res,
    mlx_array arr,
    ffi.Pointer<ffi.Int> reps,
    int reps_num,
    mlx_stream s,
  ) {
    return _mlx_tile(
      res,
      arr,
      reps,
      reps_num,
      s,
    );
  }

  late final _mlx_tilePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              ffi.Pointer<ffi.Int>, ffi.Size, mlx_stream)>>('mlx_tile');
  late final _mlx_tile = _mlx_tilePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_to_fp8(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    mlx_stream s,
  ) {
    return _mlx_to_fp8(
      res,
      x,
      s,
    );
  }

  late final _mlx_to_fp8Ptr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_to_fp8');
  late final _mlx_to_fp8 = _mlx_to_fp8Ptr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_topk_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int k,
    int axis,
    mlx_stream s,
  ) {
    return _mlx_topk_axis(
      res,
      a,
      k,
      axis,
      s,
    );
  }

  late final _mlx_topk_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_stream)>>('mlx_topk_axis');
  late final _mlx_topk_axis = _mlx_topk_axisPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_stream)>();

  int mlx_topk(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int k,
    mlx_stream s,
  ) {
    return _mlx_topk(
      res,
      a,
      k,
      s,
    );
  }

  late final _mlx_topkPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_topk');
  late final _mlx_topk = _mlx_topkPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_trace(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int offset,
    int axis1,
    int axis2,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_trace(
      res,
      a,
      offset,
      axis1,
      axis2,
      dtype.value,
      s,
    );
  }

  late final _mlx_tracePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              ffi.Int, ffi.UnsignedInt, mlx_stream)>>('mlx_trace');
  late final _mlx_trace = _mlx_tracePtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, int, int, int, mlx_stream)>();

  int mlx_transpose_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    mlx_stream s,
  ) {
    return _mlx_transpose_axes(
      res,
      a,
      axes,
      axes_num,
      s,
    );
  }

  late final _mlx_transpose_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_stream)>>('mlx_transpose_axes');
  late final _mlx_transpose_axes = _mlx_transpose_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_stream)>();

  int mlx_transpose(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_transpose(
      res,
      a,
      s,
    );
  }

  late final _mlx_transposePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>>('mlx_transpose');
  late final _mlx_transpose = _mlx_transposePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  int mlx_tri(
    ffi.Pointer<mlx_array> res,
    int n,
    int m,
    int k,
    mlx_dtype_ type,
    mlx_stream s,
  ) {
    return _mlx_tri(
      res,
      n,
      m,
      k,
      type.value,
      s,
    );
  }

  late final _mlx_triPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Int, ffi.Int, ffi.Int,
              ffi.UnsignedInt, mlx_stream)>>('mlx_tri');
  late final _mlx_tri = _mlx_triPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, int, int, int, int, mlx_stream)>();

  int mlx_tril(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    int k,
    mlx_stream s,
  ) {
    return _mlx_tril(
      res,
      x,
      k,
      s,
    );
  }

  late final _mlx_trilPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_tril');
  late final _mlx_tril = _mlx_trilPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_triu(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    int k,
    mlx_stream s,
  ) {
    return _mlx_triu(
      res,
      x,
      k,
      s,
    );
  }

  late final _mlx_triuPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_triu');
  late final _mlx_triu = _mlx_triuPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_unflatten(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_stream s,
  ) {
    return _mlx_unflatten(
      res,
      a,
      axis,
      shape,
      shape_num,
      s,
    );
  }

  late final _mlx_unflattenPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              ffi.Pointer<ffi.Int>, ffi.Size, mlx_stream)>>('mlx_unflatten');
  late final _mlx_unflatten = _mlx_unflattenPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, ffi.Pointer<ffi.Int>,
          int, mlx_stream)>();

  int mlx_var_axes(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    ffi.Pointer<ffi.Int> axes,
    int axes_num,
    bool keepdims,
    int ddof,
    mlx_stream s,
  ) {
    return _mlx_var_axes(
      res,
      a,
      axes,
      axes_num,
      keepdims,
      ddof,
      s,
    );
  }

  late final _mlx_var_axesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Bool,
              ffi.Int,
              mlx_stream)>>('mlx_var_axes');
  late final _mlx_var_axes = _mlx_var_axesPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          bool, int, mlx_stream)>();

  int mlx_var_axis(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    int axis,
    bool keepdims,
    int ddof,
    mlx_stream s,
  ) {
    return _mlx_var_axis(
      res,
      a,
      axis,
      keepdims,
      ddof,
      s,
    );
  }

  late final _mlx_var_axisPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Bool,
              ffi.Int, mlx_stream)>>('mlx_var_axis');
  late final _mlx_var_axis = _mlx_var_axisPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, bool, int, mlx_stream)>();

  int mlx_var(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    bool keepdims,
    int ddof,
    mlx_stream s,
  ) {
    return _mlx_var(
      res,
      a,
      keepdims,
      ddof,
      s,
    );
  }

  late final _mlx_varPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Bool, ffi.Int,
              mlx_stream)>>('mlx_var');
  late final _mlx_var = _mlx_varPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, bool, int, mlx_stream)>();

  int mlx_view(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_view(
      res,
      a,
      dtype.value,
      s,
    );
  }

  late final _mlx_viewPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.UnsignedInt,
              mlx_stream)>>('mlx_view');
  late final _mlx_view = _mlx_viewPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_where(
    ffi.Pointer<mlx_array> res,
    mlx_array condition,
    mlx_array x,
    mlx_array y,
    mlx_stream s,
  ) {
    return _mlx_where(
      res,
      condition,
      x,
      y,
      s,
    );
  }

  late final _mlx_wherePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              mlx_array, mlx_stream)>>('mlx_where');
  late final _mlx_where = _mlx_wherePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array, mlx_array,
          mlx_stream)>();

  int mlx_zeros(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_stream s,
  ) {
    return _mlx_zeros(
      res,
      shape,
      shape_num,
      dtype.value,
      s,
    );
  }

  late final _mlx_zerosPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>,
              ffi.Size, ffi.UnsignedInt, mlx_stream)>>('mlx_zeros');
  late final _mlx_zeros = _mlx_zerosPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int,
          mlx_stream)>();

  int mlx_zeros_like(
    ffi.Pointer<mlx_array> res,
    mlx_array a,
    mlx_stream s,
  ) {
    return _mlx_zeros_like(
      res,
      a,
      s,
    );
  }

  late final _mlx_zeros_likePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array,
              mlx_stream)>>('mlx_zeros_like');
  late final _mlx_zeros_like = _mlx_zeros_likePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_stream)>();

  /// \defgroup random Random number operations
  /// /
  /// /**@{
  int mlx_random_bernoulli(
    ffi.Pointer<mlx_array> res,
    mlx_array p,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_bernoulli(
      res,
      p,
      shape,
      shape_num,
      key,
      s,
    );
  }

  late final _mlx_random_bernoulliPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_array,
              mlx_stream)>>('mlx_random_bernoulli');
  late final _mlx_random_bernoulli = _mlx_random_bernoulliPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Pointer<ffi.Int>, int,
          mlx_array, mlx_stream)>();

  int mlx_random_bits(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    int width,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_bits(
      res,
      shape,
      shape_num,
      width,
      key,
      s,
    );
  }

  late final _mlx_random_bitsPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>,
              ffi.Size, ffi.Int, mlx_array, mlx_stream)>>('mlx_random_bits');
  late final _mlx_random_bits = _mlx_random_bitsPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int,
          mlx_array, mlx_stream)>();

  int mlx_random_categorical_shape(
    ffi.Pointer<mlx_array> res,
    mlx_array logits,
    int axis,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_categorical_shape(
      res,
      logits,
      axis,
      shape,
      shape_num,
      key,
      s,
    );
  }

  late final _mlx_random_categorical_shapePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              ffi.Int,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              mlx_array,
              mlx_stream)>>('mlx_random_categorical_shape');
  late final _mlx_random_categorical_shape =
      _mlx_random_categorical_shapePtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, int,
              ffi.Pointer<ffi.Int>, int, mlx_array, mlx_stream)>();

  int mlx_random_categorical_num_samples(
    ffi.Pointer<mlx_array> res,
    mlx_array logits_,
    int axis,
    int num_samples,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_categorical_num_samples(
      res,
      logits_,
      axis,
      num_samples,
      key,
      s,
    );
  }

  late final _mlx_random_categorical_num_samplesPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int, ffi.Int,
              mlx_array, mlx_stream)>>('mlx_random_categorical_num_samples');
  late final _mlx_random_categorical_num_samples =
      _mlx_random_categorical_num_samplesPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, int, int, mlx_array,
              mlx_stream)>();

  int mlx_random_categorical(
    ffi.Pointer<mlx_array> res,
    mlx_array logits,
    int axis,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_categorical(
      res,
      logits,
      axis,
      key,
      s,
    );
  }

  late final _mlx_random_categoricalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_array, mlx_stream)>>('mlx_random_categorical');
  late final _mlx_random_categorical = _mlx_random_categoricalPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, mlx_array, mlx_stream)>();

  int mlx_random_gumbel(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_gumbel(
      res,
      shape,
      shape_num,
      dtype.value,
      key,
      s,
    );
  }

  late final _mlx_random_gumbelPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              mlx_array,
              mlx_stream)>>('mlx_random_gumbel');
  late final _mlx_random_gumbel = _mlx_random_gumbelPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int,
          mlx_array, mlx_stream)>();

  int mlx_random_key(
    ffi.Pointer<mlx_array> res,
    int seed,
  ) {
    return _mlx_random_key(
      res,
      seed,
    );
  }

  late final _mlx_random_keyPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>, ffi.Uint64)>>('mlx_random_key');
  late final _mlx_random_key = _mlx_random_keyPtr
      .asFunction<int Function(ffi.Pointer<mlx_array>, int)>();

  int mlx_random_laplace(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    double loc,
    double scale,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_laplace(
      res,
      shape,
      shape_num,
      dtype.value,
      loc,
      scale,
      key,
      s,
    );
  }

  late final _mlx_random_laplacePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              ffi.Float,
              ffi.Float,
              mlx_array,
              mlx_stream)>>('mlx_random_laplace');
  late final _mlx_random_laplace = _mlx_random_laplacePtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int,
          double, double, mlx_array, mlx_stream)>();

  int mlx_random_multivariate_normal(
    ffi.Pointer<mlx_array> res,
    mlx_array mean,
    mlx_array cov,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_multivariate_normal(
      res,
      mean,
      cov,
      shape,
      shape_num,
      dtype.value,
      key,
      s,
    );
  }

  late final _mlx_random_multivariate_normalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              mlx_array,
              mlx_stream)>>('mlx_random_multivariate_normal');
  late final _mlx_random_multivariate_normal =
      _mlx_random_multivariate_normalPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Pointer<ffi.Int>, int, int, mlx_array, mlx_stream)>();

  int mlx_random_normal_broadcast(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_array loc,
    mlx_array scale,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_normal_broadcast(
      res,
      shape,
      shape_num,
      dtype.value,
      loc,
      scale,
      key,
      s,
    );
  }

  late final _mlx_random_normal_broadcastPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              mlx_array,
              mlx_array,
              mlx_array,
              mlx_stream)>>('mlx_random_normal_broadcast');
  late final _mlx_random_normal_broadcast =
      _mlx_random_normal_broadcastPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int,
              mlx_array, mlx_array, mlx_array, mlx_stream)>();

  int mlx_random_normal(
    ffi.Pointer<mlx_array> res,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    double loc,
    double scale,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_normal(
      res,
      shape,
      shape_num,
      dtype.value,
      loc,
      scale,
      key,
      s,
    );
  }

  late final _mlx_random_normalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              ffi.Float,
              ffi.Float,
              mlx_array,
              mlx_stream)>>('mlx_random_normal');
  late final _mlx_random_normal = _mlx_random_normalPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<ffi.Int>, int, int,
          double, double, mlx_array, mlx_stream)>();

  int mlx_random_permutation(
    ffi.Pointer<mlx_array> res,
    mlx_array x,
    int axis,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_permutation(
      res,
      x,
      axis,
      key,
      s,
    );
  }

  late final _mlx_random_permutationPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_array, mlx_stream)>>('mlx_random_permutation');
  late final _mlx_random_permutation = _mlx_random_permutationPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_array>, mlx_array, int, mlx_array, mlx_stream)>();

  int mlx_random_permutation_arange(
    ffi.Pointer<mlx_array> res,
    int x,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_permutation_arange(
      res,
      x,
      key,
      s,
    );
  }

  late final _mlx_random_permutation_arangePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Int, mlx_array,
              mlx_stream)>>('mlx_random_permutation_arange');
  late final _mlx_random_permutation_arange =
      _mlx_random_permutation_arangePtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, int, mlx_array, mlx_stream)>();

  int mlx_random_randint(
    ffi.Pointer<mlx_array> res,
    mlx_array low,
    mlx_array high,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_randint(
      res,
      low,
      high,
      shape,
      shape_num,
      dtype.value,
      key,
      s,
    );
  }

  late final _mlx_random_randintPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              mlx_array,
              mlx_stream)>>('mlx_random_randint');
  late final _mlx_random_randint = _mlx_random_randintPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
          ffi.Pointer<ffi.Int>, int, int, mlx_array, mlx_stream)>();

  int mlx_random_seed(
    int seed,
  ) {
    return _mlx_random_seed(
      seed,
    );
  }

  late final _mlx_random_seedPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Uint64)>>(
          'mlx_random_seed');
  late final _mlx_random_seed =
      _mlx_random_seedPtr.asFunction<int Function(int)>();

  int mlx_random_split_num(
    ffi.Pointer<mlx_array> res,
    mlx_array key,
    int num,
    mlx_stream s,
  ) {
    return _mlx_random_split_num(
      res,
      key,
      num,
      s,
    );
  }

  late final _mlx_random_split_numPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, mlx_array, ffi.Int,
              mlx_stream)>>('mlx_random_split_num');
  late final _mlx_random_split_num = _mlx_random_split_numPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, int, mlx_stream)>();

  int mlx_random_split(
    ffi.Pointer<mlx_array> res_0,
    ffi.Pointer<mlx_array> res_1,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_split(
      res_0,
      res_1,
      key,
      s,
    );
  }

  late final _mlx_random_splitPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>,
              mlx_array, mlx_stream)>>('mlx_random_split');
  late final _mlx_random_split = _mlx_random_splitPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, ffi.Pointer<mlx_array>, mlx_array,
          mlx_stream)>();

  int mlx_random_truncated_normal(
    ffi.Pointer<mlx_array> res,
    mlx_array lower,
    mlx_array upper,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_truncated_normal(
      res,
      lower,
      upper,
      shape,
      shape_num,
      dtype.value,
      key,
      s,
    );
  }

  late final _mlx_random_truncated_normalPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              mlx_array,
              mlx_stream)>>('mlx_random_truncated_normal');
  late final _mlx_random_truncated_normal =
      _mlx_random_truncated_normalPtr.asFunction<
          int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
              ffi.Pointer<ffi.Int>, int, int, mlx_array, mlx_stream)>();

  int mlx_random_uniform(
    ffi.Pointer<mlx_array> res,
    mlx_array low,
    mlx_array high,
    ffi.Pointer<ffi.Int> shape,
    int shape_num,
    mlx_dtype_ dtype,
    mlx_array key,
    mlx_stream s,
  ) {
    return _mlx_random_uniform(
      res,
      low,
      high,
      shape,
      shape_num,
      dtype.value,
      key,
      s,
    );
  }

  late final _mlx_random_uniformPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_array>,
              mlx_array,
              mlx_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.UnsignedInt,
              mlx_array,
              mlx_stream)>>('mlx_random_uniform');
  late final _mlx_random_uniform = _mlx_random_uniformPtr.asFunction<
      int Function(ffi.Pointer<mlx_array>, mlx_array, mlx_array,
          ffi.Pointer<ffi.Int>, int, int, mlx_array, mlx_stream)>();

  /// \defgroup transforms Transform operations
  /// /
  /// /**@{
  int mlx_async_eval(
    mlx_vector_array outputs,
  ) {
    return _mlx_async_eval(
      outputs,
    );
  }

  late final _mlx_async_evalPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_vector_array)>>(
          'mlx_async_eval');
  late final _mlx_async_eval =
      _mlx_async_evalPtr.asFunction<int Function(mlx_vector_array)>();

  int mlx_checkpoint(
    ffi.Pointer<mlx_closure> res,
    mlx_closure fun,
  ) {
    return _mlx_checkpoint(
      res,
      fun,
    );
  }

  late final _mlx_checkpointPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_closure>, mlx_closure)>>('mlx_checkpoint');
  late final _mlx_checkpoint = _mlx_checkpointPtr
      .asFunction<int Function(ffi.Pointer<mlx_closure>, mlx_closure)>();

  int mlx_custom_function(
    ffi.Pointer<mlx_closure> res,
    mlx_closure fun,
    mlx_closure_custom fun_vjp,
    mlx_closure_custom_jvp fun_jvp,
    mlx_closure_custom_vmap fun_vmap,
  ) {
    return _mlx_custom_function(
      res,
      fun,
      fun_vjp,
      fun_jvp,
      fun_vmap,
    );
  }

  late final _mlx_custom_functionPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_closure>,
              mlx_closure,
              mlx_closure_custom,
              mlx_closure_custom_jvp,
              mlx_closure_custom_vmap)>>('mlx_custom_function');
  late final _mlx_custom_function = _mlx_custom_functionPtr.asFunction<
      int Function(ffi.Pointer<mlx_closure>, mlx_closure, mlx_closure_custom,
          mlx_closure_custom_jvp, mlx_closure_custom_vmap)>();

  int mlx_custom_vjp(
    ffi.Pointer<mlx_closure> res,
    mlx_closure fun,
    mlx_closure_custom fun_vjp,
  ) {
    return _mlx_custom_vjp(
      res,
      fun,
      fun_vjp,
    );
  }

  late final _mlx_custom_vjpPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_closure>, mlx_closure,
              mlx_closure_custom)>>('mlx_custom_vjp');
  late final _mlx_custom_vjp = _mlx_custom_vjpPtr.asFunction<
      int Function(
          ffi.Pointer<mlx_closure>, mlx_closure, mlx_closure_custom)>();

  int mlx_eval(
    mlx_vector_array outputs,
  ) {
    return _mlx_eval(
      outputs,
    );
  }

  late final _mlx_evalPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(mlx_vector_array)>>(
          'mlx_eval');
  late final _mlx_eval =
      _mlx_evalPtr.asFunction<int Function(mlx_vector_array)>();

  int mlx_jvp(
    ffi.Pointer<mlx_vector_array> res_0,
    ffi.Pointer<mlx_vector_array> res_1,
    mlx_closure fun,
    mlx_vector_array primals,
    mlx_vector_array tangents,
  ) {
    return _mlx_jvp(
      res_0,
      res_1,
      fun,
      primals,
      tangents,
    );
  }

  late final _mlx_jvpPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_vector_array>,
              mlx_closure,
              mlx_vector_array,
              mlx_vector_array)>>('mlx_jvp');
  late final _mlx_jvp = _mlx_jvpPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, ffi.Pointer<mlx_vector_array>,
          mlx_closure, mlx_vector_array, mlx_vector_array)>();

  int mlx_value_and_grad(
    ffi.Pointer<mlx_closure_value_and_grad> res,
    mlx_closure fun,
    ffi.Pointer<ffi.Int> argnums,
    int argnums_num,
  ) {
    return _mlx_value_and_grad(
      res,
      fun,
      argnums,
      argnums_num,
    );
  }

  late final _mlx_value_and_gradPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(ffi.Pointer<mlx_closure_value_and_grad>, mlx_closure,
              ffi.Pointer<ffi.Int>, ffi.Size)>>('mlx_value_and_grad');
  late final _mlx_value_and_grad = _mlx_value_and_gradPtr.asFunction<
      int Function(ffi.Pointer<mlx_closure_value_and_grad>, mlx_closure,
          ffi.Pointer<ffi.Int>, int)>();

  int mlx_vjp(
    ffi.Pointer<mlx_vector_array> res_0,
    ffi.Pointer<mlx_vector_array> res_1,
    mlx_closure fun,
    mlx_vector_array primals,
    mlx_vector_array cotangents,
  ) {
    return _mlx_vjp(
      res_0,
      res_1,
      fun,
      primals,
      cotangents,
    );
  }

  late final _mlx_vjpPtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_vector_array>,
              mlx_closure,
              mlx_vector_array,
              mlx_vector_array)>>('mlx_vjp');
  late final _mlx_vjp = _mlx_vjpPtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, ffi.Pointer<mlx_vector_array>,
          mlx_closure, mlx_vector_array, mlx_vector_array)>();

  /// \defgroup transforms_impl Implementation detail operations
  /// /
  /// /**@{
  int mlx_detail_vmap_replace(
    ffi.Pointer<mlx_vector_array> res,
    mlx_vector_array inputs,
    mlx_vector_array s_inputs,
    mlx_vector_array s_outputs,
    ffi.Pointer<ffi.Int> in_axes,
    int in_axes_num,
    ffi.Pointer<ffi.Int> out_axes,
    int out_axes_num,
  ) {
    return _mlx_detail_vmap_replace(
      res,
      inputs,
      s_inputs,
      s_outputs,
      in_axes,
      in_axes_num,
      out_axes,
      out_axes_num,
    );
  }

  late final _mlx_detail_vmap_replacePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              mlx_vector_array,
              mlx_vector_array,
              mlx_vector_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size,
              ffi.Pointer<ffi.Int>,
              ffi.Size)>>('mlx_detail_vmap_replace');
  late final _mlx_detail_vmap_replace = _mlx_detail_vmap_replacePtr.asFunction<
      int Function(
          ffi.Pointer<mlx_vector_array>,
          mlx_vector_array,
          mlx_vector_array,
          mlx_vector_array,
          ffi.Pointer<ffi.Int>,
          int,
          ffi.Pointer<ffi.Int>,
          int)>();

  int mlx_detail_vmap_trace(
    ffi.Pointer<mlx_vector_array> res_0,
    ffi.Pointer<mlx_vector_array> res_1,
    mlx_closure fun,
    mlx_vector_array inputs,
    ffi.Pointer<ffi.Int> in_axes,
    int in_axes_num,
  ) {
    return _mlx_detail_vmap_trace(
      res_0,
      res_1,
      fun,
      inputs,
      in_axes,
      in_axes_num,
    );
  }

  late final _mlx_detail_vmap_tracePtr = _lookup<
      ffi.NativeFunction<
          ffi.Int Function(
              ffi.Pointer<mlx_vector_array>,
              ffi.Pointer<mlx_vector_array>,
              mlx_closure,
              mlx_vector_array,
              ffi.Pointer<ffi.Int>,
              ffi.Size)>>('mlx_detail_vmap_trace');
  late final _mlx_detail_vmap_trace = _mlx_detail_vmap_tracePtr.asFunction<
      int Function(ffi.Pointer<mlx_vector_array>, ffi.Pointer<mlx_vector_array>,
          mlx_closure, mlx_vector_array, ffi.Pointer<ffi.Int>, int)>();

  int mlx_version(
    ffi.Pointer<mlx_string> str_,
  ) {
    return _mlx_version(
      str_,
    );
  }

  late final _mlx_versionPtr =
      _lookup<ffi.NativeFunction<ffi.Int Function(ffi.Pointer<mlx_string>)>>(
          'mlx_version');
  late final _mlx_version =
      _mlx_versionPtr.asFunction<int Function(ffi.Pointer<mlx_string>)>();
}

/// A MLX string object.
final class mlx_string_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_string = mlx_string_;

/// Complex number support
/// Parse-time alias for ffigen. C float complex is two float32 values.
final class mlx_complex64_t_ extends ffi.Struct {
  @ffi.Float()
  external double real;

  @ffi.Float()
  external double imag;
}

typedef mlx_complex64_t = mlx_complex64_t_;

/// A N-dimensional array object.
final class mlx_array_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_array = mlx_array_;

/// Array element type.
enum mlx_dtype_ {
  MLX_BOOL(0),
  MLX_UINT8(1),
  MLX_UINT16(2),
  MLX_UINT32(3),
  MLX_UINT64(4),
  MLX_INT8(5),
  MLX_INT16(6),
  MLX_INT32(7),
  MLX_INT64(8),
  MLX_FLOAT16(9),
  MLX_FLOAT32(10),
  MLX_FLOAT64(11),
  MLX_BFLOAT16(12),
  MLX_COMPLEX64(13);

  final int value;
  const mlx_dtype_(this.value);

  static mlx_dtype_ fromValue(int value) => switch (value) {
        0 => MLX_BOOL,
        1 => MLX_UINT8,
        2 => MLX_UINT16,
        3 => MLX_UINT32,
        4 => MLX_UINT64,
        5 => MLX_INT8,
        6 => MLX_INT16,
        7 => MLX_INT32,
        8 => MLX_INT64,
        9 => MLX_FLOAT16,
        10 => MLX_FLOAT32,
        11 => MLX_FLOAT64,
        12 => MLX_BFLOAT16,
        13 => MLX_COMPLEX64,
        _ => throw ArgumentError('Unknown value for mlx_dtype_: $value'),
      };
}

/// A string-to-array map
final class mlx_map_string_to_array_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_map_string_to_array = mlx_map_string_to_array_;

/// An iterator over a string-to-array map.
final class mlx_map_string_to_array_iterator_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;

  external ffi.Pointer<ffi.Void> map_ctx;
}

typedef mlx_map_string_to_array_iterator = mlx_map_string_to_array_iterator_;

/// A string-to-string map
final class mlx_map_string_to_string_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_map_string_to_string = mlx_map_string_to_string_;

/// An iterator over a string-to-string map.
final class mlx_map_string_to_string_iterator_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;

  external ffi.Pointer<ffi.Void> map_ctx;
}

typedef mlx_map_string_to_string_iterator = mlx_map_string_to_string_iterator_;

/// A int optional.
final class mlx_optional_int_ extends ffi.Struct {
  @ffi.Int()
  external int value;

  @ffi.Bool()
  external bool has_value;
}

typedef mlx_optional_int = mlx_optional_int_;

/// A float optional.
final class mlx_optional_float_ extends ffi.Struct {
  @ffi.Float()
  external double value;

  @ffi.Bool()
  external bool has_value;
}

typedef mlx_optional_float = mlx_optional_float_;

/// A dtype optional.
final class mlx_optional_dtype_ extends ffi.Struct {
  @ffi.UnsignedInt()
  external int valueAsInt;

  mlx_dtype_ get value => mlx_dtype_.fromValue(valueAsInt);

  @ffi.Bool()
  external bool has_value;
}

typedef mlx_optional_dtype = mlx_optional_dtype_;

/// A vector of array.
final class mlx_vector_array_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_vector_array = mlx_vector_array_;

/// A vector of vector_array.
final class mlx_vector_vector_array_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_vector_vector_array = mlx_vector_vector_array_;

/// A vector of int.
final class mlx_vector_int_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_vector_int = mlx_vector_int_;

/// A vector of string.
final class mlx_vector_string_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_vector_string = mlx_vector_string_;

/// A MLX device object.
final class mlx_device_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_device = mlx_device_;

/// Device type.
enum mlx_device_type_ {
  MLX_CPU(0),
  MLX_GPU(1);

  final int value;
  const mlx_device_type_(this.value);

  static mlx_device_type_ fromValue(int value) => switch (value) {
        0 => MLX_CPU,
        1 => MLX_GPU,
        _ => throw ArgumentError('Unknown value for mlx_device_type_: $value'),
      };
}

/// A MLX device info object.
/// Contains key-value pairs with device properties.
/// Keys vary by backend but common keys include:
/// - device_name (string): Device name
/// - architecture (string): Architecture identifier
/// Additional keys may be present depending on the backend.
final class mlx_device_info_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_device_info = mlx_device_info_;

/// A MLX stream object.
final class mlx_stream_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_stream = mlx_stream_;

/// \defgroup mlx_closure Closures
/// MLX closure objects.
/// /
/// /**@{
final class mlx_closure_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_closure = mlx_closure_;

final class mlx_closure_kwargs_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_closure_kwargs = mlx_closure_kwargs_;

final class mlx_closure_value_and_grad_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_closure_value_and_grad = mlx_closure_value_and_grad_;

final class mlx_closure_custom_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_closure_custom = mlx_closure_custom_;

final class mlx_closure_custom_jvp_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_closure_custom_jvp = mlx_closure_custom_jvp_;

final class mlx_closure_custom_vmap_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_closure_custom_vmap = mlx_closure_custom_vmap_;

/// A MLX distributed group object.
final class mlx_distributed_group_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_distributed_group = mlx_distributed_group_;

/// A MLX IO reader object.
final class mlx_io_reader_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_io_reader = mlx_io_reader_;

/// A MLX IO writer object.
final class mlx_io_writer_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_io_writer = mlx_io_writer_;

/// Virtual table for custom IO reader and writer objects.
final class mlx_io_vtable_ extends ffi.Struct {
  external ffi
      .Pointer<ffi.NativeFunction<ffi.Bool Function(ffi.Pointer<ffi.Void>)>>
      is_open;

  external ffi
      .Pointer<ffi.NativeFunction<ffi.Bool Function(ffi.Pointer<ffi.Void>)>>
      good;

  external ffi
      .Pointer<ffi.NativeFunction<ffi.Size Function(ffi.Pointer<ffi.Void>)>>
      tell;

  external ffi.Pointer<
      ffi.NativeFunction<
          ffi.Void Function(ffi.Pointer<ffi.Void>, ffi.Int64, ffi.Int)>> seek;

  external ffi.Pointer<
      ffi.NativeFunction<
          ffi.Void Function(
              ffi.Pointer<ffi.Void>, ffi.Pointer<ffi.Char>, ffi.Size)>> read;

  external ffi.Pointer<
      ffi.NativeFunction<
          ffi.Void Function(ffi.Pointer<ffi.Void>, ffi.Pointer<ffi.Char>,
              ffi.Size, ffi.Size)>> read_at_offset;

  external ffi.Pointer<
      ffi.NativeFunction<
          ffi.Void Function(
              ffi.Pointer<ffi.Void>, ffi.Pointer<ffi.Char>, ffi.Size)>> write;

  external ffi.Pointer<
      ffi.NativeFunction<
          ffi.Pointer<ffi.Char> Function(ffi.Pointer<ffi.Void>)>> label;

  external ffi
      .Pointer<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Void>)>>
      free;
}

typedef mlx_io_vtable = mlx_io_vtable_;

/// \defgroup compile Compilation operations
/// /
/// /**@{
enum mlx_compile_mode_ {
  MLX_COMPILE_MODE_DISABLED(0),
  MLX_COMPILE_MODE_NO_SIMPLIFY(1),
  MLX_COMPILE_MODE_NO_FUSE(2),
  MLX_COMPILE_MODE_ENABLED(3);

  final int value;
  const mlx_compile_mode_(this.value);

  static mlx_compile_mode_ fromValue(int value) => switch (value) {
        0 => MLX_COMPILE_MODE_DISABLED,
        1 => MLX_COMPILE_MODE_NO_SIMPLIFY,
        2 => MLX_COMPILE_MODE_NO_FUSE,
        3 => MLX_COMPILE_MODE_ENABLED,
        _ => throw ArgumentError('Unknown value for mlx_compile_mode_: $value'),
      };
}

typedef mlx_error_handler_funcFunction = ffi.Void Function(
    ffi.Pointer<ffi.Char> msg, ffi.Pointer<ffi.Void> data);
typedef Dartmlx_error_handler_funcFunction = void Function(
    ffi.Pointer<ffi.Char> msg, ffi.Pointer<ffi.Void> data);

/// \defgroup mlx_error Error management
/// /
/// /**@{
typedef mlx_error_handler_func
    = ffi.Pointer<ffi.NativeFunction<mlx_error_handler_funcFunction>>;

final class mlx_function_exporter_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_function_exporter = mlx_function_exporter_;

final class mlx_imported_function_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_imported_function = mlx_imported_function_;

/// \defgroup fast Fast custom operations
/// /
/// /**@{
final class mlx_fast_cuda_kernel_config_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_fast_cuda_kernel_config = mlx_fast_cuda_kernel_config_;

final class mlx_fast_cuda_kernel_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_fast_cuda_kernel = mlx_fast_cuda_kernel_;

final class mlx_fast_metal_kernel_config_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_fast_metal_kernel_config = mlx_fast_metal_kernel_config_;

final class mlx_fast_metal_kernel_ extends ffi.Struct {
  external ffi.Pointer<ffi.Void> ctx;
}

typedef mlx_fast_metal_kernel = mlx_fast_metal_kernel_;
